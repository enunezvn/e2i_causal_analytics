# Test Results - January 15, 2026

**Environment**: DigitalOcean Droplet (159.89.180.27)
**Commit**: `88a22ff` (fix(copilotkit): conditionally register hooks only when enabled)

---

## Frontend Tests (Vitest)

All frontend tests pass on the production droplet.

| Batch | Files | Tests | Status |
|-------|-------|-------|--------|
| API tests | 3 | 44 | Passed |
| Component tests | 16 | 728 | Passed |
| Hooks tests | 15 | 442 | Passed |
| Pages tests | 15 | 369 | Passed |
| Provider tests | 1 | 44 | Passed |
| **Total** | **50** | **1,627** | **All Passed** |

### Provider Fix Applied

The E2ICopilotProvider had 22 test failures that were fixed:

1. **Split `CopilotHooksConnector`** into two components:
   - `CopilotHooksConnector` - checks if CopilotKit is enabled
   - `CopilotHooksInner` - registers hooks only when rendered

2. **Expanded `AGENT_REGISTRY`** from 8 to 19 agents across 6 tiers:
   - Tier 0: 7 agents (ML Foundation)
   - Tier 1: 2 agents (Orchestration)
   - Tier 2: 3 agents (Causal Analytics)
   - Tier 3: 3 agents (Monitoring)
   - Tier 4: 2 agents (ML Predictions)
   - Tier 5: 2 agents (Self-Improvement)

3. **Changed default `enabled`** to `false` in `CopilotKitWrapper`

4. **Fixed parameter name typo** in `setDetailLevel` action (`path` -> `level`)

---

## Backend Tests (Pytest)

**Test Pass Rate: 97.6%** (7,604 passed / 7,792 non-error tests)

| Test Suite | Passed | Failed | Errors | Skipped | Duration |
|------------|--------|--------|--------|---------|----------|
| Unit tests | 6,720 | 113 | 18 | 11 | 8m 31s |
| Integration tests | 448 | 17 | 11 | 14 | 2m 9s |
| E2E tests | 71 | 0 | 1 | 6 | 41s |
| API + RAG tests | 365 | 10 | 18 | 2 | 40s |
| **Total** | **7,604** | **140** | **48** | **33** | ~12m |

### Key Failure Categories

1. **Tool Composer tests** (~50 failures)
   - Location: `tests/unit/test_agents/test_tool_composer/`
   - Issue: LLM interaction mocking issues
   - Files: `test_composer.py`, `test_decomposer.py`, `test_planner.py`, `test_synthesizer.py`

2. **Feature Store/Feast tests** (~5 failures)
   - Location: `tests/unit/test_feature_store/test_feast_entities.py`
   - Issue: Import/data source definition issues

3. **Observability integration tests** (~6 failures)
   - Location: `tests/integration/test_observability_integration.py`
   - Issue: Database connection/batch processing issues

4. **RAG reranker tests** (~10 failures)
   - Location: `tests/rag/test_integration.py`
   - Issue: Reranker integration pipeline issues

5. **Signal flow tests** (~6 failures)
   - Location: `tests/integration/test_signal_flow/`
   - Issue: Contract compliance issues

6. **LiNGAM causal discovery** (~6 failures)
   - Location: `tests/unit/test_causal_engine/test_discovery/test_lingam_wrapper.py`
   - Issue: Algorithm error handling

### Import Errors (48 total)

Most errors are import failures rather than actual test failures:

| Location | Count | Likely Cause |
|----------|-------|--------------|
| `tests/api/` endpoint tests | 12 | Missing FastAPI test dependencies |
| `tests/unit/test_agents/test_experiment_designer/` | 10 | Circular imports |
| `tests/unit/test_agents/test_ml_foundation/` | 7 | Missing module dependencies |
| `tests/rag/` tests | 5 | Missing RAG dependencies |
| Other | 14 | Various import issues |

---

## Recommendations for Follow-up

1. **Fix Tool Composer mocks**: The LLM mocking in tool_composer tests needs review
2. **Resolve import errors**: Check for missing dependencies in API endpoint tests
3. **Update Feast data sources**: Feature store tests may need configuration updates
4. **Review RAG reranker**: Integration tests failing may indicate API contract changes

---

## Commands Used

```bash
# Frontend tests (on droplet)
cd /root/Projects/e2i_causal_analytics/frontend
npx vitest run src/providers/ --reporter=verbose

# Backend tests (on droplet)
cd /root/Projects/e2i_causal_analytics
source .venv/bin/activate
pytest tests/unit/ -n 4 --dist=loadscope -q --tb=no
pytest tests/integration/ -n 4 --dist=loadscope -q --tb=no
pytest tests/e2e/ -n 4 --dist=loadscope -q --tb=no
pytest tests/api/ tests/rag/ -n 4 --dist=loadscope -q --tb=no
```

---

*Generated by Claude Code on 2026-01-15*
