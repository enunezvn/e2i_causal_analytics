/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pandera/_pandas_deprecated.py:157: FutureWarning: Importing pandas-specific classes and functions from the
top-level pandera module will be **removed in a future version of pandera**.
If you're using pandera to validate pandas objects, we highly recommend updating
your import:

```
# old import
import pandera as pa

# new import
import pandera.pandas as pa
```

If you're using pandera to validate objects from other compatible libraries
like pyspark or polars, see the supported libraries section of the documentation
for more information on how to import pandera:

https://pandera.readthedocs.io/en/stable/supported_libraries.html

To disable this warning, set the environment variable:

```
export DISABLE_PANDERA_IMPORT_WARNING=True
```

  warnings.warn(_future_warning, FutureWarning)
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/opik/error_tracking/shutdown_hooks.py:12: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
  client = sentry_sdk.Hub.current.client
OPIK: Configuration completed successfully. Traces will be logged to 'e2i-causal-analytics' project. To change the destination project, see: https://www.comet.com/docs/opik/tracing/log_traces#configuring-the-project-name
OPIK: Started logging traces to the "e2i-causal-analytics" project at http://localhost:5173/api/v1/session/redirect/projects/?trace_id=019c05ff-85ef-7523-be26-90422c250e9d&path=aHR0cDovL2xvY2FsaG9zdDo1MTczL2FwaS8=.
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/expressions/parser.py:72: DeprecationWarning: 'enablePackrat' deprecated - use 'enable_packrat'
  ParserElement.enablePackrat()
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/expressions/parser.py:85: DeprecationWarning: 'escChar' argument is deprecated, use 'esc_char'
  quoted_identifier = QuotedString('"', escChar="\\", unquoteResults=True)
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/expressions/parser.py:85: DeprecationWarning: 'unquoteResults' argument is deprecated, use 'unquote_results'
  quoted_identifier = QuotedString('"', escChar="\\", unquoteResults=True)
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/table/metadata.py:365: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
  @model_validator(mode="after")
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/table/metadata.py:494: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
  @model_validator(mode="after")
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/table/metadata.py:498: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
  @model_validator(mode="after")
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/table/metadata.py:502: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
  @model_validator(mode="after")
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/table/metadata.py:506: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
  @model_validator(mode="after")
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/table/metadata.py:538: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
  @model_validator(mode="after")
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/table/metadata.py:542: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
  @model_validator(mode="after")
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/table/metadata.py:546: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
  @model_validator(mode="after")
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pyiceberg/table/metadata.py:550: PydanticDeprecatedSince212: Using `@model_validator` with mode='after' on a classmethod is deprecated. Instead, use an instance method. See the documentation at https://docs.pydantic.dev/2.12/concepts/validators/#model-after-validator. Deprecated in Pydantic V2.12 to be removed in V3.0.
  @model_validator(mode="after")
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/supabase/_async/client.py:310: DeprecationWarning: The 'timeout' parameter is deprecated. Please configure it in the http client instead.
  return AsyncPostgrestClient(
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/supabase/_async/client.py:310: DeprecationWarning: The 'verify' parameter is deprecated. Please configure it in the http client instead.
  return AsyncPostgrestClient(

======================================================================
TIER 0 MLOPS WORKFLOW TEST
======================================================================
  Experiment ID: tier0_e2e_136a8a47
  Brand: Kisqali
  Target: discontinuation_flag
  Problem Type: binary_classification
  MLflow Enabled: True
  MLflow Tracking URI: http://localhost:5000
  BentoML Serving: Disabled
  Started: 2026-01-28T19:05:50.026144

  Generating sample patient data...
  Generated 600 patient records

======================================================================
STEP 1: SCOPE DEFINER
======================================================================

  ğŸ“¥ Input Summary:
    â€¢ problem_description: Predict patient discontinuation risk for Kisqali
    â€¢ business_objective: Identify high-risk patients early for intervention
    â€¢ target_outcome: discontinuation_flag
    â€¢ problem_type_hint: binary_classification
    â€¢ brand: Kisqali

  âš™ï¸  Processing:
    âœ… Creating ScopeDefinerAgent
    âœ… Agent initialized
    âœ… Scope definition executed

  ğŸ” Validation Checks:
    â€¢ Problem type defined: âœ… PASS
        Expected: problem_type present
        Actual:   binary_classification
    â€¢ Prediction target set: âœ… PASS
        Expected: prediction_target present
        Actual:   discontinuation_flag
    â€¢ Minimum samples specified: âœ… PASS
        Expected: minimum_samples > 0
        Actual:   500
    â€¢ Scope validation: âœ… PASS
        Expected: validation_passed = True
        Actual:   validation_passed = True

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    experiment_id             exp_kisq_al_20260128190558_b2e0bd -               -         
    problem_type              binary_classification -               -         
    prediction_target         discontinuation_flag -               -         
    minimum_samples           500             -               -         

  ğŸ’¡ Scope Analysis:
    â€¢ Binary classification scope defined for patient risk prediction
    â€¢ Target outcome: discontinuation_flag
    â€¢ Sample requirement (500) appropriate for ML

  ------------------------------------------------------------
  âœ… RESULT: PASS - Scope definition complete (3.5s)
  ------------------------------------------------------------

======================================================================
STEP 2: DATA PREPARER
======================================================================

  ğŸ“¥ Input Summary:
    â€¢ data_source: patient_journeys
    â€¢ brand: Kisqali
    â€¢ sample_size: 600
    â€¢ features: 11 available
Calculating Metrics:   0%|          | 0/40 [00:00<?, ?it/s]Calculating Metrics:   0%|          | 0/40 [00:00<?, ?it/s]Calculating Metrics:  10%|â–ˆ         | 4/40 [00:00<00:00, 7476.48it/s]Calculating Metrics:  10%|â–ˆ         | 4/40 [00:00<00:00, 5777.28it/s]Calculating Metrics:  15%|â–ˆâ–Œ        | 6/40 [00:00<00:00, 7580.07it/s]Calculating Metrics:  15%|â–ˆâ–Œ        | 6/40 [00:00<00:00, 6603.47it/s]Calculating Metrics:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 14/40 [00:00<00:00, 4738.94it/s]Calculating Metrics:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 14/40 [00:00<00:00, 4484.86it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 4772.90it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 4717.47it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 4691.09it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 4657.36it/s]
Calculating Metrics:   0%|          | 0/40 [00:00<?, ?it/s]Calculating Metrics:   0%|          | 0/40 [00:00<?, ?it/s]Calculating Metrics:  10%|â–ˆ         | 4/40 [00:00<00:00, 12409.18it/s]Calculating Metrics:  10%|â–ˆ         | 4/40 [00:00<00:00, 8477.62it/s] Calculating Metrics:  15%|â–ˆâ–Œ        | 6/40 [00:00<00:00, 11042.49it/s]Calculating Metrics:  15%|â–ˆâ–Œ        | 6/40 [00:00<00:00, 9088.42it/s] Calculating Metrics:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 14/40 [00:00<00:00, 5594.00it/s]Calculating Metrics:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 14/40 [00:00<00:00, 5281.07it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 5262.45it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 5194.99it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 5155.40it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 5115.94it/s]
Calculating Metrics:   0%|          | 0/40 [00:00<?, ?it/s]Calculating Metrics:   0%|          | 0/40 [00:00<?, ?it/s]Calculating Metrics:  10%|â–ˆ         | 4/40 [00:00<00:00, 10887.23it/s]Calculating Metrics:  10%|â–ˆ         | 4/40 [00:00<00:00, 7674.85it/s] Calculating Metrics:  15%|â–ˆâ–Œ        | 6/40 [00:00<00:00, 10127.09it/s]Calculating Metrics:  15%|â–ˆâ–Œ        | 6/40 [00:00<00:00, 8450.58it/s] Calculating Metrics:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 14/40 [00:00<00:00, 5518.82it/s]Calculating Metrics:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 14/40 [00:00<00:00, 5154.97it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 3873.48it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 3825.79it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 3780.78it/s]Calculating Metrics: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 40/40 [00:00<00:00, 3743.91it/s]
/opt/e2i_causal_analytics/src/agents/ml_foundation/data_preparer/nodes/data_transformer.py:348: DeprecationWarning: is_categorical_dtype is deprecated and will be removed in a future version. Use isinstance(dtype, pd.CategoricalDtype) instead
  elif pd.api.types.is_categorical_dtype(dtype) or dtype == object:
Column patient_journey_id has high cardinality (157 unique), skipping
Column patient_id has high cardinality (157 unique), skipping
Column journey_start_date has high cardinality (157 unique), skipping
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/supabase/_sync/client.py:309: DeprecationWarning: The 'timeout' parameter is deprecated. Please configure it in the http client instead.
  return SyncPostgrestClient(
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/supabase/_sync/client.py:309: DeprecationWarning: The 'verify' parameter is deprecated. Please configure it in the http client instead.
  return SyncPostgrestClient(
Feature registration failed
Traceback (most recent call last):
  File "/opt/e2i_causal_analytics/src/feature_store/feature_analyzer_adapter.py", line 150, in register_features_from_state
    X_selected = state.get("X_train_selected") or state.get("X_train")
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pandas/core/generic.py", line 1580, in __nonzero__
    raise ValueError(
ValueError: The truth value of a DataFrame is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
Feast not installed: No module named 'feast'
Failed to initialize Feast client: No module named 'feast'
No Supabase client, skipping DB store
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/supabase/_sync/client.py:309: DeprecationWarning: The 'timeout' parameter is deprecated. Please configure it in the http client instead.
  return SyncPostgrestClient(
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/supabase/_sync/client.py:309: DeprecationWarning: The 'verify' parameter is deprecated. Please configure it in the http client instead.
  return SyncPostgrestClient(
/opt/e2i_causal_analytics/src/mlops/optuna_optimizer.py:194: ExperimentalWarning: Argument ``multivariate`` is an experimental feature. The interface can change in the future.
  return TPESampler(
[I 2026-01-28 19:06:03,095] A new study created in RDB with name: e2i_tier0_e2e_136a8a47_LogisticRegression_hpo
[I 2026-01-28 19:06:03,203] Trial 0 finished with value: 0.7405754795663052 and parameters: {'C': 14.528246637516036, 'penalty': 'l1', 'solver': 'saga'}. Best is trial 0 with value: 0.7405754795663052.
Trial 1 failed: Solver lbfgs supports only 'l2' or None penalties, got l1 penalty.
[I 2026-01-28 19:06:03,253] Trial 1 finished with value: -inf and parameters: {'C': 0.0745934328572655, 'penalty': 'l1', 'solver': 'lbfgs'}. Best is trial 0 with value: 0.7405754795663052.
[I 2026-01-28 19:06:03,304] Trial 2 finished with value: 0.6499999999999999 and parameters: {'C': 0.0019517224641449498, 'penalty': 'l1', 'solver': 'saga'}. Best is trial 0 with value: 0.7405754795663052.
[I 2026-01-28 19:06:03,351] Trial 3 finished with value: 0.7405754795663052 and parameters: {'C': 14.528246637516036, 'penalty': 'l1', 'solver': 'saga'}. Best is trial 0 with value: 0.7405754795663052.
[I 2026-01-28 19:06:03,395] Trial 4 finished with value: 0.7405754795663052 and parameters: {'C': 0.14445251022763064, 'penalty': 'l2', 'solver': 'saga'}. Best is trial 0 with value: 0.7405754795663052.
Trial 5 failed: Solver lbfgs supports only 'l2' or None penalties, got l1 penalty.
[I 2026-01-28 19:06:03,434] Trial 5 finished with value: -inf and parameters: {'C': 0.19069966103000435, 'penalty': 'l1', 'solver': 'lbfgs'}. Best is trial 0 with value: 0.7405754795663052.
Trial 6 failed: Solver lbfgs supports only 'l2' or None penalties, got elasticnet penalty.
[I 2026-01-28 19:06:03,478] Trial 6 finished with value: -inf and parameters: {'C': 1.0907475835157696, 'penalty': 'elasticnet', 'solver': 'lbfgs'}. Best is trial 0 with value: 0.7405754795663052.
[I 2026-01-28 19:06:03,540] Trial 7 finished with value: 0.741743119266055 and parameters: {'C': 0.03334792728637585, 'penalty': 'l2', 'solver': 'saga'}. Best is trial 7 with value: 0.741743119266055.
[I 2026-01-28 19:06:03,595] Trial 8 finished with value: 0.6499999999999999 and parameters: {'C': 0.0014857392806279248, 'penalty': 'l1', 'solver': 'saga'}. Best is trial 7 with value: 0.741743119266055.
[I 2026-01-28 19:06:03,650] Trial 9 finished with value: 0.7405754795663052 and parameters: {'C': 0.5414413211338525, 'penalty': 'l2', 'solver': 'lbfgs'}. Best is trial 7 with value: 0.741743119266055.
2026/01/28 19:06:07 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/sklearn/utils/validation.py:2732: UserWarning: X has feature names, but LogisticRegression was fitted without feature names
  warnings.warn(

  âš™ï¸  Processing:
    âœ… Creating DataPreparerAgent
    âœ… Agent initialized
    âœ… Data preparation executed
    âœ… QC analysis complete (warning)

  ğŸ” Validation Checks:
    â€¢ QC Gate: âœ… PASS
        Expected: gate_passed = True
        Actual:   gate_passed = True
    â€¢ Overall QC Score: âœ… PASS
        Expected: >= 0.70
        Actual:   0.99
    â€¢ Training samples: âœ… PASS
        Expected: >= 100
        Actual:   157
    â€¢ Validation samples: âœ… PASS
        Expected: >= 30
        Actual:   156

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    overall_score             0.9867          >= 0.70         âœ…         
    completeness              0.9468          >= 0.90         âœ…         
    validity                  1.0000          >= 0.90         âœ…         
    consistency               1.0000          >= 0.90         âœ…         
    uniqueness                1.0000          >= 0.95         âœ…         
    timeliness                1.0000          >= 0.80         âœ…         
    train_samples             157             >= 100          âœ…         
    validation_samples        156             >= 30           âœ…         

  ğŸ’¡ Data Quality Analysis:
    â€¢ Data split: 157 train (50%), 156 validation
    â€¢ All QC dimensions meet quality thresholds

  ------------------------------------------------------------
  âœ… RESULT: PASS - QC Gate PASSED - Training can proceed (1.0s)
  ------------------------------------------------------------

======================================================================
STEP 3: COHORT CONSTRUCTOR
======================================================================

  ğŸ“¥ Input Summary:
    â€¢ input_patients: 600
    â€¢ brand: Kisqali
    â€¢ inclusion_criteria: data_quality_score >= 0.5
    â€¢ exclusion_criteria: None (maximize sample size)

  âš™ï¸  Processing:
    âœ… Creating CohortConstructorAgent
    âœ… Agent initialized
    âœ… Cohort config created (data_quality_score >= 0.5)
    âœ… Cohort construction executed (600 eligible)

  ğŸ” Validation Checks:
    â€¢ Minimum cohort size: âœ… PASS
        Expected: >= 30
        Actual:   600
    â€¢ Retention rate: âœ… PASS
        Expected: >= 50%
        Actual:   100.0%
    â€¢ Cohort status: âœ… PASS
        Expected: completed
        Actual:   completed

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    input_patients            600             -               -         
    eligible_patients         600             >= 30           âœ…         
    excluded_patients         0               -               -         
    retention_rate            1.0000          >= 0.50         âœ…         
    cohort_id                 cohort_kisqali_test_v100-test_20260128 -               -         

  ğŸ’¡ Cohort Analysis:
    â€¢ Patient flow: 600 â†’ 600 (100.0% retention)
    â€¢ Excluded 0 patients based on eligibility criteria
    â€¢ Cohort size (600) sufficient for ML training
    â€¢ Target class distribution: {0: np.int64(521), 1: np.int64(79)}
    â€¢ âš ï¸  Class imbalance detected (13.2% minority)

  ------------------------------------------------------------
  âœ… RESULT: PASS - Cohort constructed (600 patients, 0.1s)
  ------------------------------------------------------------

======================================================================
STEP 4: MODEL SELECTOR
======================================================================

  ğŸ“¥ Input Summary:
    â€¢ problem_type: binary_classification
    â€¢ qc_passed: True
    â€¢ skip_benchmarks: False
ğŸƒ View run model_selection_LogisticRegression at: http://localhost:5000/#/experiments/202/runs/7b7b9b4dca0349b4bc69e3297d96107d
ğŸ§ª View experiment at: http://localhost:5000/#/experiments/202

  âš™ï¸  Processing:
    âœ… Creating ModelSelectorAgent
    âœ… Agent initialized
    âœ… Model selection executed (LogisticRegression)
    âœ… Alternatives evaluated (3 candidates)

  ğŸ” Validation Checks:
    â€¢ Model candidate selected: âœ… PASS
        Expected: candidate present
        Actual:   LogisticRegression
    â€¢ Selection rationale provided: âœ… PASS
        Expected: rationale present
        Actual:   Highly interpretable baseline model for binary_cla
    â€¢ Alternatives evaluated: âœ… PASS
        Expected: > 0 alternatives
        Actual:   3 evaluated
    â€¢ No selection errors: âœ… PASS
        Expected: no errors
        Actual:   none

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    algorithm                 LogisticRegression -               -         
    selection_score           0.758           > 0.5           âœ…         
    interpretability_score    1.00            -               -         
    hyperparameters           4 default params -               -         
    alternatives_evaluated    3               > 0             âœ…         

  ğŸ“‹ Candidates Evaluated:
    ------------------------------------------------------------
    Rank  Algorithm                Score       Status         
    ------------------------------------------------------------
    1     LogisticRegression       0.758       âœ… SELECTED     
    2     LightGBM                 0.715       Not selected   
    3     XGBoost                  0.713       Not selected   
    4     RandomForest             0.655       Not selected   
    ------------------------------------------------------------

  ğŸ’¡ Model Selection Analysis:
    â€¢ Selected: LogisticRegression (score: 0.758)
    â€¢ Primary reason: Highly interpretable baseline model for binary_classification
    â€¢ Supporting factors: Fast training and inference, Well-established baseline approach, Numerically stable
    â€¢ HPO will tune: C, penalty, solver, max_iter
    â€¢ LogisticRegression: Interpretable, fast, good baseline

  ------------------------------------------------------------
  âœ… RESULT: PASS - Model selected: LogisticRegression (0.7s)
  ------------------------------------------------------------

======================================================================
STEP 5: MODEL TRAINER
======================================================================

  ğŸ“¥ Input Summary:
    â€¢ algorithm: LogisticRegression
    â€¢ total_samples: 600
    â€¢ train_samples: 360 (60%)
    â€¢ validation_samples: 120 (20%)
    â€¢ test_samples: 90 (15%)
    â€¢ holdout_samples: 30 (5%)
    â€¢ hpo_trials: 10
    â€¢ enable_mlflow: True
ğŸƒ View run LogisticRegression_20260128_190607 at: http://localhost:5000/#/experiments/203/runs/a9e3a2dae1524ff6a991f084e9ee47e0
ğŸ§ª View experiment at: http://localhost:5000/#/experiments/203

  âš™ï¸  Processing:
    âœ… Creating ModelTrainerAgent
    âœ… Agent initialized
    âœ… HPO optimization (10 trials)
    âœ… Class imbalance detected (severe)
    âœ… Remediation applied (smote)
    âœ… Model training complete (AUC=0.8012820512820512)
    âœ… MLflow artifact logged (model_uri available)

  ğŸ” Validation Checks:
    â€¢ Model trained successfully: âœ… PASS
        Expected: trained_model present
        Actual:   present
    â€¢ AUC-ROC threshold: âœ… PASS
        Expected: >= 0.55
        Actual:   0.801
    â€¢ Minority recall threshold: âœ… PASS
        Expected: >= 10%
        Actual:   63.64%
    â€¢ Minority precision threshold: âœ… PASS
        Expected: >= 5%
        Actual:   16.67%
    â€¢ Positive predictions made: âœ… PASS
        Expected: > 0
        Actual:   42

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    auc_roc                   0.8013          >= 0.55         âœ…         
    accuracy                  0.6750          -               -         
    precision                 0.1667          >= 5%           âœ…         
    recall                    0.6364          >= 10%          âœ…         
    f1_score                  0.2642          -               -         
    optimal_threshold         0.5063          -               -         
    positive_predictions      42              > 0             âœ…         
    hpo_trials_run            10              -               -         

  Validation Confusion Matrix:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚           Predicted                 â”‚
    â”‚         Neg        Pos              â”‚
    â”‚  Actual â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
    â”‚    Neg   TN=  74    FP=  35          â”‚
    â”‚    Pos   FN=   4    TP=   7          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Derived Metrics:
      â€¢ Accuracy:    0.6750 (81/120 correct)
      â€¢ Precision:   0.1667 (of predicted pos, 7/42 correct)
      â€¢ Recall/TPR:  0.6364 (of actual pos, 7/11 found)
      â€¢ Specificity: 0.6789 (of actual neg, 74/109 found)
      â€¢ F1 Score:    0.2642
      â€¢ NPV:         0.9487 (of predicted neg, 74/78 correct)
      â€¢ FPR:         0.3211 (false alarm rate)
      â€¢ FNR:         0.3636 (miss rate)

  Probability Distribution (class 1):
    Min: 0.1616, Max: 0.7948
    Mean: 0.4476, Median: 0.4550
    Percentiles: P10=0.217, P25=0.314, P50=0.455, P75=0.584, P90=0.666, P95=0.706, P99=0.774

  Threshold Analysis:
    Threshold    Precision    Recall       F1           Pred Pos    
    --------------------------------------------------------
    0.05         0.0917       1.0000       0.1679       120         
    0.10         0.0917       1.0000       0.1679       120         
    0.15         0.0917       1.0000       0.1679       120         
    0.20         0.0982       1.0000       0.1789       112         
    0.25         0.1100       1.0000       0.1982       100         
    0.30         0.1209       1.0000       0.2157       91          
    0.40         0.1429       1.0000       0.2500       77          
    0.50         0.1591       0.6364       0.2545       44           â—„â”€â”€ default
    0.60         0.2692       0.6364       0.3784       26          
    0.70         0.5714       0.3636       0.4444       7           

  ğŸ’¡ Model Training Analysis:
    â€¢ AUC-ROC (0.801) indicates good discrimination ability
    â€¢ Recall (63.64%) meets threshold (10%)
    â€¢ Precision (16.67%) acceptable
    â€¢ Class imbalance detected: 14.2% minority class
    â€¢ Severity: SEVERE
    â€¢ Applied remediation: smote
    â€¢ Overall accuracy: 67.5% (81/120 correct)
    â€¢ Minority class: 7/11 detected (63.6% recall)
    â€¢ Of 42 predicted positives, 7 correct (16.7% precision)

  ------------------------------------------------------------
  âœ… RESULT: PASS - Model trained successfully - usefulness validated (11.1s)
  ------------------------------------------------------------

======================================================================
STEP 6: FEATURE ANALYZER
======================================================================

  ğŸ“¥ Input Summary:
    â€¢ sample_size: 50
    â€¢ features: ['days_on_therapy', 'hcp_visits', 'prior_treatments']
    â€¢ max_samples: 50
    â€¢ model_uri: models:/m-a8f6a4c12bae4491ac64e2f92994623a
Downloading artifacts:   0%|          | 0/5 [00:00<?, ?it/s]Downloading artifacts:  20%|â–ˆâ–ˆ        | 1/5 [00:00<00:00, 67.71it/s]Downloading artifacts:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [00:00<00:00, 101.77it/s]Downloading artifacts:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [00:00<00:00, 145.52it/s]Downloading artifacts:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [00:00<00:00, 152.61it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00<00:00, 158.74it/s]Downloading artifacts: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [00:00<00:00, 157.74it/s]
Failed to store SHAP analysis: {'message': 'null value in column "model_registry_id" of relation "ml_shap_analyses" violates not-null constraint', 'code': '23502', 'hint': None, 'details': None}
Traceback (most recent call last):
  File "/opt/e2i_causal_analytics/src/repositories/shap_analysis.py", line 78, in store_analysis
    result = await self.client.table(self.table_name).insert(db_record).execute()
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/postgrest/_sync/request_builder.py", line 53, in execute
    raise APIError(dict(json_obj))
postgrest.exceptions.APIError: {'message': 'null value in column "model_registry_id" of relation "ml_shap_analyses" violates not-null constraint', 'code': '23502', 'hint': None, 'details': None}
Unexpected model_uri format: models:/m-a8f6a4c12bae4491ac64e2f92994623a
/opt/e2i_causal_analytics/src/mlops/mlflow_connector.py:1018: FutureWarning: ``mlflow.tracking.client.MlflowClient.transition_model_version_stage`` is deprecated since 2.9.0. Model registry stages will be removed in a future major release. To learn more about the deprecation of model registry stages, see our migration guide here: https://mlflow.org/docs/latest/model-registry.html#migrating-from-stages
  self._client.transition_model_version_stage(
Failed to transition model stage: RESOURCE_DOES_NOT_EXIST: Model Version (name=kisqali_discontinuation_tier0_e2, version=1) not found
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pathspec/pathspec.py:260: DeprecationWarning: GitWildMatchPattern ('gitwildmatch') is deprecated. Use 'gitignore' for GitIgnoreBasicPattern or GitIgnoreSpecPattern instead.
  patterns = [pattern_factory(line) for line in lines if line]
/opt/e2i_causal_analytics/.venv/lib/python3.12/site-packages/pathspec/pattern.py:125: DeprecationWarning: GitWildMatchPattern ('gitwildmatch') is deprecated. Use 'gitignore' for GitIgnoreBasicPattern or GitIgnoreSpecPattern instead.
  regex, include = self.pattern_to_regex(pattern)
Failed to deploy model: Model 'kisqali_discontinuation_tier0_e2:v1_20260128190631' is not found in BentoML store /home/enunez/bentoml/models, you may need to run `bentoml models pull` first
HTTP health check failed: Failed to connect to endpoint
Failed to initialize span repository: BaseRepository.__init__() got an unexpected keyword argument 'client'
Failed to initialize span repository: BaseRepository.__init__() got an unexpected keyword argument 'client'

  âš™ï¸  Processing:
    âœ… Creating FeatureAnalyzerAgent
    âœ… Agent initialized
    âœ… SHAP analysis executed

  ğŸ” Validation Checks:
    â€¢ Feature importance computed: âœ… PASS
        Expected: feature_importance present
        Actual:   present
    â€¢ Samples analyzed: âœ… PASS
        Expected: > 0
        Actual:   50

  ğŸ“Š Feature Importance (SHAP):
    Feature                   Importance      Rank      
    --------------------------------------------------
    days_on_therapy           38.7846         #1         
    hcp_visits                1.1235          #2         
    prior_treatments          0.5255          #3         

  ğŸ’¡ Feature Analysis:
    â€¢ Top predictive features: days_on_therapy, hcp_visits, prior_treatments
    â€¢   â€¢ Duration on therapy (38.785) is a strong predictor
    â€¢   â€¢ HCP engagement (1.123) influences discontinuation
    â€¢   â€¢ Treatment history (0.526) affects outcomes
    â€¢ Analysis based on 50 samples using SHAP explainer

  ------------------------------------------------------------
  âœ… RESULT: PASS - Feature importance computed (18.5s)
  ------------------------------------------------------------

======================================================================
STEP 7: MODEL DEPLOYER
======================================================================

  ğŸ“¥ Input Summary:
    â€¢ deployment_name: kisqali_discontinuation_tier0_e2
    â€¢ model_uri: models:/m-a8f6a4c12bae4491ac64e2f92994623a
    â€¢ success_criteria_met: True
    â€¢ deployment_action: register
    â€¢ include_bentoml: False

  âš™ï¸  Processing:
    âœ… Creating ModelDeployerAgent
    âœ… Agent initialized
    âœ… Model registration (completed)

  ğŸ” Validation Checks:
    â€¢ Deployment successful: âœ… PASS
        Expected: deployment_successful = True
        Actual:   completed
    â€¢ Deployment manifest: âœ… PASS
        Expected: manifest present
        Actual:   present
    â€¢ Success criteria met: âœ… PASS
        Expected: success_criteria_met = True
        Actual:   True

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    deployment_id             deploy_7d36cd49d3a4 -               -         
    environment               staging         -               -         
    status                    healthy         -               -         
    model_version             N/A             -               -         

  ğŸ’¡ Deployment Analysis:
    â€¢ Model registered with deployment ID: deploy_7d36cd49d3a4
    â€¢ Environment: staging

  ------------------------------------------------------------
  âœ… RESULT: PASS - Model deployed successfully (5.0s)
  ------------------------------------------------------------

======================================================================
STEP 8: OBSERVABILITY CONNECTOR
======================================================================

  ğŸ“¥ Input Summary:
    â€¢ events_to_log: 1
    â€¢ event_type: pipeline_completed
    â€¢ experiment_id: tier0_e2e_136a8a47
    â€¢ stages_completed: 8
    â€¢ time_window: 1h

  âš™ï¸  Processing:
    âœ… Creating ObservabilityConnectorAgent
    âœ… Agent initialized
    âœ… Event emission (1 events)

  ğŸ” Validation Checks:
    â€¢ Emission successful: âœ… PASS
        Expected: emission_successful = True
        Actual:   True
    â€¢ Events logged: âœ… PASS
        Expected: > 0
        Actual:   1

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    emission_successful       True            -               -         
    events_logged             1               > 0             âœ…         
    quality_score             0.6905          -               -         

  ğŸ’¡ Observability Analysis:
    â€¢ Pipeline completion event logged to observability system
    â€¢ Experiment tier0_e2e_136a8a47 with 8 stages recorded
    â€¢ Event quality score: 0.6905

  ------------------------------------------------------------
  âœ… RESULT: PASS - Observability logging complete (0.0s)
  ------------------------------------------------------------

======================================================================
DETAILED STEP RESULTS
======================================================================

----------------------------------------------------------------------
STEP 1: SCOPE DEFINER [âœ… SUCCESS]
----------------------------------------------------------------------
  Duration: 3.51s

  ğŸ“¥ Input Summary:
    â€¢ problem_description: Predict patient discontinuation risk
    â€¢ business_objective: Identify high-risk patients
    â€¢ target_outcome: discontinuation_flag
    â€¢ problem_type_hint: binary_classification
    â€¢ brand: Kisqali

  ğŸ” Validation Checks:
    â€¢ Problem type defined: âœ… PASS
        Expected: problem_type present
        Actual:   binary_classification
    â€¢ Prediction target set: âœ… PASS
        Expected: prediction_target present
        Actual:   discontinuation_flag
    â€¢ Minimum samples specified: âœ… PASS
        Expected: minimum_samples > 0
        Actual:   500
    â€¢ Scope validation: âœ… PASS
        Expected: validation_passed = True
        Actual:   validation_passed = True

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    experiment_id             exp_kisq_al_20260128190558_b2e0bd -               -         
    problem_type              binary_classification -               -         
    prediction_target         discontinuation_flag -               -         
    minimum_samples           500             -               -         

  ğŸ’¡ SCOPE DEFINER Analysis:
    â€¢ Binary classification scope defined for patient risk prediction
    â€¢ Target outcome: discontinuation_flag
    â€¢ Sample requirement (500) appropriate for ML

  ------------------------------------------------------------
  âœ… RESULT: PASS - Scope definition complete (3.5s)
  ------------------------------------------------------------

----------------------------------------------------------------------
STEP 2: DATA PREPARER [âœ… SUCCESS]
----------------------------------------------------------------------
  Duration: 0.97s

  ğŸ“¥ Input Summary:
    â€¢ experiment_id: tier0_e2e_136a8a47
    â€¢ scope_spec_problem_type: binary_classification
    â€¢ input_samples: 600

  ğŸ” Validation Checks:
    â€¢ QC gate passed: âœ… PASS
        Expected: gate_passed = True
        Actual:   gate_passed = True
    â€¢ Overall score acceptable: âœ… PASS
        Expected: â‰¥ 0.70
        Actual:   0.99
    â€¢ Training samples sufficient: âœ… PASS
        Expected: â‰¥ 50
        Actual:   157
    â€¢ Validation samples present: âœ… PASS
        Expected: > 0
        Actual:   156

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    overall_score             0.99            â‰¥ 0.70          âœ…         
    completeness_score        0.95            -               -         
    validity_score            1.00            -               -         
    consistency_score         1.00            -               -         
    train_samples             157             â‰¥ 50            âœ…         
    validation_samples        156             > 0             âœ…         

  ğŸ’¡ DATA PREPARER Analysis:
    â€¢ Data quality score: 0.99
    â€¢ Training set: 157 samples, validation set: 156 samples
    â€¢ QC gate PASSED - data ready for modeling

  ------------------------------------------------------------
  âœ… RESULT: PASS - Data preparation complete (1.0s)
  ------------------------------------------------------------

----------------------------------------------------------------------
STEP 3: COHORT CONSTRUCTOR [âœ… SUCCESS]
----------------------------------------------------------------------
  Duration: 0.06s

  ğŸ“¥ Input Summary:
    â€¢ input_patients: 600
    â€¢ brand: Kisqali
    â€¢ min_eligible_required: 30

  ğŸ” Validation Checks:
    â€¢ Sufficient eligible patients: âœ… PASS
        Expected: â‰¥ 30
        Actual:   600
    â€¢ Exclusion rate reasonable: âœ… PASS
        Expected: â‰¤ 50%
        Actual:   0.0%
    â€¢ Cohort ID generated: âœ… PASS
        Expected: cohort_id present
        Actual:   cohort_kisqali_test_v100-test_20260128
    â€¢ Cohort status valid: âœ… PASS
        Expected: completed/success
        Actual:   completed

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    input_patients            600             -               -         
    eligible_patients         600             â‰¥ 30            âœ…         
    excluded_patients         0               -               -         
    exclusion_rate            0.0%            â‰¤ 50%           âœ…         

  ğŸ’¡ COHORT CONSTRUCTOR Analysis:
    â€¢ Cohort constructed with 600 eligible patients from 600 total
    â€¢ Exclusion rate: 0.0% (0 patients excluded)
    â€¢ Cohort size meets minimum threshold of 30

  ------------------------------------------------------------
  âœ… RESULT: PASS - Cohort 'cohort_kisqali_test_v100-test_20260128' constructed with 600 patients (0.1s)
  ------------------------------------------------------------

----------------------------------------------------------------------
STEP 4: MODEL SELECTOR [âœ… SUCCESS]
----------------------------------------------------------------------
  Duration: 0.66s

  ğŸ“¥ Input Summary:
    â€¢ experiment_id: tier0_e2e_136a8a47
    â€¢ problem_type: binary_classification
    â€¢ qc_gate_passed: True

  ğŸ” Validation Checks:
    â€¢ Algorithm selected: âœ… PASS
        Expected: candidate present
        Actual:   LogisticRegression
    â€¢ Selection score computed: âœ… PASS
        Expected: > 0
        Actual:   0.758
    â€¢ Rationale provided: âœ… PASS
        Expected: reason present
        Actual:   Highly interpretable baseline 
    â€¢ Alternatives evaluated: âœ… PASS
        Expected: > 0
        Actual:   3 candidates

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    algorithm                 LogisticRegression -               -         
    selection_score           0.758           > 0.5           âœ…         
    interpretability          1.00            -               -         
    default_hyperparameters   4               -               -         
    alternatives_evaluated    3               > 0             âœ…         

  ğŸ’¡ MODEL SELECTOR Analysis:
    â€¢ Selected LogisticRegression (score: 0.758)
    â€¢ Reason: Highly interpretable baseline model for binary_classification
    â€¢ Evaluated 3 alternatives: {'family': 'gradient_boosting', 'framework': 'lightgbm', 'problem_types': ['binary_classification', 'multiclass_classification', 'regression'], 'strengths': ['speed', 'large_datasets', 'memory_efficient'], 'inference_latency_ms': 15, 'memory_gb': 1.5, 'interpretability_score': 0.6, 'scalability_score': 0.95, 'hyperparameter_space': {'n_estimators': {'type': 'int', 'low': 100, 'high': 500, 'step': 50}, 'max_depth': {'type': 'int', 'low': 3, 'high': 10}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'num_leaves': {'type': 'int', 'low': 20, 'high': 150}}, 'default_hyperparameters': {'n_estimators': 300, 'max_depth': 6, 'learning_rate': 0.1, 'num_leaves': 31}, 'name': 'LightGBM', 'selection_score': 0.7149375000000001}, {'family': 'gradient_boosting', 'framework': 'xgboost', 'problem_types': ['binary_classification', 'multiclass_classification', 'regression'], 'strengths': ['accuracy', 'feature_importance', 'robust'], 'inference_latency_ms': 20, 'memory_gb': 2.0, 'interpretability_score': 0.6, 'scalability_score': 0.8, 'hyperparameter_space': {'n_estimators': {'type': 'int', 'low': 100, 'high': 500, 'step': 50}, 'max_depth': {'type': 'int', 'low': 3, 'high': 10}, 'learning_rate': {'type': 'float', 'low': 0.01, 'high': 0.3, 'log': True}, 'subsample': {'type': 'float', 'low': 0.6, 'high': 1.0, 'step': 0.1}}, 'default_hyperparameters': {'n_estimators': 300, 'max_depth': 6, 'learning_rate': 0.1, 'subsample': 0.8}, 'name': 'XGBoost', 'selection_score': 0.71325}, {'family': 'ensemble', 'framework': 'sklearn', 'problem_types': ['binary_classification', 'multiclass_classification', 'regression'], 'strengths': ['robust', 'feature_importance', 'no_scaling_required'], 'inference_latency_ms': 30, 'memory_gb': 3.0, 'interpretability_score': 0.5, 'scalability_score': 0.7, 'hyperparameter_space': {'n_estimators': {'type': 'int', 'low': 100, 'high': 500, 'step': 50}, 'max_depth': {'type': 'int', 'low': 5, 'high': 20}, 'min_samples_split': {'type': 'int', 'low': 2, 'high': 20}, 'min_samples_leaf': {'type': 'int', 'low': 1, 'high': 10}}, 'default_hyperparameters': {'n_estimators': 200, 'max_depth': 10, 'min_samples_split': 5, 'min_samples_leaf': 2}, 'name': 'RandomForest', 'selection_score': 0.6548749999999999}
    â€¢ HPO will tune 4 hyperparameters in Step 5

  ------------------------------------------------------------
  âœ… RESULT: PASS - Model selection complete: LogisticRegression (score=0.758) (0.7s)
  ------------------------------------------------------------

----------------------------------------------------------------------
STEP 5: MODEL TRAINER [âœ… SUCCESS]
----------------------------------------------------------------------
  Duration: 11.09s

  ğŸ“¥ Input Summary:
    â€¢ experiment_id: tier0_e2e_136a8a47
    â€¢ algorithm: LogisticRegression
    â€¢ training_samples: 600
    â€¢ features: ['days_on_therapy', 'hcp_visits', 'prior_treatments']
    â€¢ target: discontinuation_flag

  ğŸ” Validation Checks:
    â€¢ AUC-ROC above threshold: âœ… PASS
        Expected: â‰¥ 0.60
        Actual:   0.801
    â€¢ Model not useless: âœ… PASS
        Expected: not useless
        Actual:   acceptable
    â€¢ Success criteria met: âœ… PASS
        Expected: True
        Actual:   True
    â€¢ Both classes predicted: âœ… PASS
        Expected: multi-class output
        Actual:   acceptable

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    auc_roc                   0.801           â‰¥ 0.60          âœ…         
    precision                 0.344           -               -         
    recall                    0.917           -               -         
    f1_score                  0.500           -               -         
    model_usefulness          acceptable      good/acceptable âœ…         
    imbalance_detected        True            -               -         
    resampling_applied        True            -               -         

  ğŸ’¡ MODEL TRAINER Analysis:
    â€¢ Model trained with AUC-ROC: 0.801
    â€¢ Model usefulness: acceptable
    â€¢ Class imbalance detected and remediated via smote
    â€¢ Success criteria MET

  ------------------------------------------------------------
  âœ… RESULT: PASS - Training complete: acceptable model with AUC=0.801 (11.1s)
  ------------------------------------------------------------

----------------------------------------------------------------------
STEP 6: FEATURE ANALYZER [âœ… SUCCESS]
----------------------------------------------------------------------
  Duration: 18.51s

  ğŸ“¥ Input Summary:
    â€¢ experiment_id: tier0_e2e_136a8a47
    â€¢ model_uri: models:/m-a8f6a4c12bae4491ac64e2f92994623a
    â€¢ samples_for_analysis: 50
    â€¢ features_analyzed: ['days_on_therapy', 'hcp_visits', 'prior_treatments']

  ğŸ” Validation Checks:
    â€¢ Feature importance computed: âœ… PASS
        Expected: importance present
        Actual:   Yes
    â€¢ Sufficient samples analyzed: âœ… PASS
        Expected: â‰¥ 10
        Actual:   50
    â€¢ Computation completed: âœ… PASS
        Expected: compute_time > 0
        Actual:   18.28s

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    samples_analyzed          50              â‰¥ 10            âœ…         
    computation_time          18.28s          -               -         
    explainer_type            LinearExplainer -               -         
    top_feature               days_on_therapy -               -         
    top_importance            38.785          -               -         

  ğŸ’¡ FEATURE ANALYZER Analysis:
    â€¢ SHAP analysis completed on 50 samples in 18.28s
    â€¢ Top driver: days_on_therapy (importance: 38.785)
    â€¢ Feature ranking: days_on_therapy, hcp_visits, prior_treatments

  ------------------------------------------------------------
  âœ… RESULT: PASS - Feature analysis complete: days_on_therapy is top predictor (18.5s)
  ------------------------------------------------------------

----------------------------------------------------------------------
STEP 7: MODEL DEPLOYER [âœ… SUCCESS]
----------------------------------------------------------------------
  Duration: 5.02s

  ğŸ“¥ Input Summary:
    â€¢ experiment_id: tier0_e2e_136a8a47
    â€¢ model_uri: models:/m-a8f6a4c12bae4491ac64e2f92994623a
    â€¢ validation_metrics: {13 keys}
    â€¢ success_criteria_met: True
    â€¢ include_bentoml: False

  ğŸ” Validation Checks:
    â€¢ Deployment successful: âœ… PASS
        Expected: True
        Actual:   True
    â€¢ Deployment ID assigned: âœ… PASS
        Expected: ID present
        Actual:   deploy_7d36cd49d3a4
    â€¢ Environment set: âœ… PASS
        Expected: env specified
        Actual:   staging
    â€¢ BentoML verified: âœ… PASS
        Expected: True
        Actual:   N/A (not enabled)

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    deployment_id             deploy_7d36cd49d3a4 -               -         
    environment               staging         -               -         
    status                    healthy         deployed        âŒ         
    bentoml_verified          N/A             -               -         
    latency_ms                N/A             -               -         

  ğŸ’¡ MODEL DEPLOYER Analysis:
    â€¢ Model deployed to staging environment
    â€¢ Deployment ID: deploy_7d36cd49d3a4
    â€¢ BentoML serving not enabled

  ------------------------------------------------------------
  âœ… RESULT: PASS - Deployment complete: deploy_7d36cd49d3a4 to staging (5.0s)
  ------------------------------------------------------------

----------------------------------------------------------------------
STEP 8: OBSERVABILITY CONNECTOR [âœ… SUCCESS]
----------------------------------------------------------------------
  Duration: 0.02s

  ğŸ“¥ Input Summary:
    â€¢ experiment_id: tier0_e2e_136a8a47
    â€¢ total_steps: 8
    â€¢ pipeline_complete: True

  ğŸ” Validation Checks:
    â€¢ Metrics emitted: âœ… PASS
        Expected: True
        Actual:   True
    â€¢ Events logged: âœ… PASS
        Expected: > 0
        Actual:   1
    â€¢ Quality score computed: âœ… PASS
        Expected: present
        Actual:   0.69

  ğŸ“Š Key Metrics:
    Metric                    Value           Threshold       Status    
    -----------------------------------------------------------------
    emission_successful       True            True            âœ…         
    events_logged             1               > 0             âœ…         
    quality_score             0.69            -               -         

  ğŸ’¡ OBSERVABILITY CONNECTOR Analysis:
    â€¢ Observability metrics successfully emitted to monitoring systems
    â€¢ 1 events logged for pipeline tracking
    â€¢ Overall pipeline quality score: 0.69

  ------------------------------------------------------------
  âœ… RESULT: PASS - Observability complete: 1 events logged (0.0s)
  ------------------------------------------------------------

======================================================================
COHORT CONSTRUCTION ANALYSIS
======================================================================

  ğŸ“Š Patient Flow:
    â€¢ Input Patients:    600
    â€¢ Eligible Patients: 600
    â€¢ Excluded Patients: 0
    â€¢ Retention Rate:    100.0%

  ğŸ“‹ Eligibility Statistics:
    â€¢ total_input_patients: 600
    â€¢ eligible_patient_count: 600
    â€¢ excluded_patient_count: 0
    â€¢ exclusion_rate: 0.0000
    â€¢ eligibility_log: [{'criterion_name': 'data_quality_score', 'criterion_type': 'inclusion', 'criterion_order': 1, 'operator': '>=', 'value': 0.5, 'removed_count': np.int64(0), 'remaining_count': np.int64(600), 'description': 'Minimum data quality score', 'clinical_rationale': 'Ensure data quality for reliable ML predictions', 'applied_at': '2026-01-28T19:05:59.587760'}]
    â€¢ temporal_validation: {'lookback_exclusions': 0, 'followup_exclusions': 0, 'total_temporal_exclusions': 0}

  ğŸ” Applied Criteria:
    â€¢ Cohort ID: cohort_kisqali_test_v100-test_20260128
    â€¢ Execution ID: exec_5fe307b64ec0
    â€¢ Status: completed

======================================================================
CLASS IMBALANCE REMEDIATION
======================================================================

  ğŸ“Š Imbalance Analysis:
    â€¢ Imbalance Detected: Yes
    â€¢ Severity: SEVERE
    â€¢ Minority Ratio: 14.17%
    â€¢ Imbalance Ratio: 6.1:1

  ğŸ“ˆ Class Distribution:
    â€¢ Class 0: 309 samples
    â€¢ Class 1: 51 samples

  ğŸ”§ Remediation Applied:
    â€¢ Strategy: smote
    â€¢ Rationale: With 51 minority samples (sufficient for SMOTE's k-neighbors requirement) and severe 6:1 imbalance, SMOTE will effectively generate synthetic minority samples to balance the dataset for the LogisticRegression model.

  ğŸ“Š Resampling Results:
    â€¢ Original Samples: 360
    â€¢ Resampled Samples: 618
    â€¢ New Minority Ratio: 50.00%

  ğŸ“ˆ Resampled Class Distribution:
    â€¢ Class 0: 309 samples
    â€¢ Class 1: 309 samples

======================================================================
FEATURE IMPORTANCE (SHAP)
======================================================================

  Top Features:
    1. days_on_therapy: 38.7846
    2. hcp_visits: 1.1235
    3. prior_treatments: 0.5255

======================================================================
FINAL MODEL PERFORMANCE
======================================================================

  Primary Metrics:
    â€¢ roc_auc: 0.7819
    â€¢ accuracy: 0.6583
    â€¢ precision: 0.1591
    â€¢ recall: 0.6364
    â€¢ f1_score: 0.2545
    â€¢ pr_auc: 0.3803
    â€¢ brier_score: 0.2071

  Per-Class Metrics:
    â€¢ precision_class_0: 0.9474
    â€¢ precision_class_1: 0.1591
    â€¢ recall_class_0: 0.6606
    â€¢ recall_class_1: 0.6364

======================================================================
ENHANCED ACCURACY ANALYSIS
======================================================================

  Validation Set Confusion Matrix:
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚           Predicted                 â”‚
    â”‚         Neg        Pos              â”‚
    â”‚  Actual â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
    â”‚    Neg   TN=  74    FP=  35          â”‚
    â”‚    Pos   FN=   4    TP=   7          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Derived Metrics:
      â€¢ Accuracy:    0.6750 (81/120 correct)
      â€¢ Precision:   0.1667 (of predicted pos, 7/42 correct)
      â€¢ Recall/TPR:  0.6364 (of actual pos, 7/11 found)
      â€¢ Specificity: 0.6789 (of actual neg, 74/109 found)
      â€¢ F1 Score:    0.2642
      â€¢ NPV:         0.9487 (of predicted neg, 74/78 correct)
      â€¢ FPR:         0.3211 (false alarm rate)
      â€¢ FNR:         0.3636 (miss rate)

  Classification Report (per-class):
                           precision    recall  f1-score   support
    
    Class 0 (No Discont.)       0.95      0.68      0.79       109
       Class 1 (Discont.)       0.17      0.64      0.26        11
    
                 accuracy                           0.68       120
                macro avg       0.56      0.66      0.53       120
             weighted avg       0.88      0.68      0.74       120
    

  Probability Distribution (class 1):
    Min: 0.1616, Max: 0.7948
    Mean: 0.4476, Median: 0.4550
    Percentiles: P10=0.217, P25=0.314, P50=0.455, P75=0.584, P90=0.666, P95=0.706, P99=0.774

  Threshold Analysis:
    Threshold    Precision    Recall       F1           Pred Pos    
    --------------------------------------------------------
    0.05         0.0917       1.0000       0.1679       120         
    0.10         0.0917       1.0000       0.1679       120         
    0.15         0.0917       1.0000       0.1679       120         
    0.20         0.0982       1.0000       0.1789       112         
    0.25         0.1100       1.0000       0.1982       100         
    0.30         0.1209       1.0000       0.2157       91          
    0.40         0.1429       1.0000       0.2500       77          
    0.50         0.1591       0.6364       0.2545       44           â—„â”€â”€ default
    0.60         0.2692       0.6364       0.3784       26          
    0.70         0.5714       0.3636       0.4444       7           

  Model Coefficients/Weights:
    Intercept: -0.2207
    Feature Coefficients:
      â†“ days_on_therapy: -0.4861
      â†‘ prior_treatments: +0.4639
      â†“ hcp_visits: -0.2348

  Data Distribution Analysis:

    Training Set (n=360):
      Class 0:  309 ( 85.8%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
      Class 1:   51 ( 14.2%) â–ˆâ–ˆ

    Validation Set (n=120):
      Class 0:  109 ( 90.8%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
      Class 1:   11 (  9.2%) â–ˆ

    Test Set (n=90):
      Class 0:   78 ( 86.7%) â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
      Class 1:   12 ( 13.3%) â–ˆâ–ˆ

  Overfitting Analysis (Train vs Validation):
    Metric          Train        Validation   Delta        Status         
    ------------------------------------------------------------
    accuracy        0.8583       0.6750       0.1833++++++ âš ï¸ Overfitting 
    precision       0.0000       0.1667       -0.1667+++++ â“ Unusual      
    recall          0.0000       0.6364       -0.6364+++++ â“ Unusual      
    f1              0.0000       0.2642       -0.2642+++++ â“ Unusual      
    roc_auc         0.6601       0.7819       -0.1218+++++ â“ Unusual      

======================================================================
âš ï¸  MODEL USEFULNESS VERDICT
======================================================================

======================================================================
DEPLOYMENT STATUS
======================================================================

  â€¢ Deployment ID: deploy_7d36cd49d3a4
  â€¢ Environment: staging
  â€¢ Status: healthy
  â€¢ Endpoint: https://api.e2i.com/v1/kisqali_discontinuation_tier0_e2-staging/predict

======================================================================

======================================================================
PIPELINE SUMMARY
======================================================================
  Experiment ID: tier0_e2e_136a8a47
  Steps Completed: 8
  Total Duration: 44.9s
  QC Gate: PASSED
  Cohort Size: 600
  Validation Metrics: {'accuracy': 0.6583333333333333, 'precision': 0.1590909090909091, 'recall': 0.6363636363636364, 'f1_score': 0.2545454545454545, 'f1_macro': 0.5164619164619164, 'f1_weighted': 0.7303603603603604, 'precision_class_0': 0.9473684210526315, 'precision_class_1': 0.1590909090909091, 'recall_class_0': 0.6605504587155964, 'recall_class_1': 0.6363636363636364, 'roc_auc': 0.7819015846538782, 'pr_auc': 0.38026013132495085, 'brier_score': 0.20713971223894884}
  Completed: 2026-01-28T19:06:34.943726

  Step Status: 8 success, 0 warnings, 0 failed

  âœ… Pipeline completed successfully!
