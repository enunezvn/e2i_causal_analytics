<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E2I Feedback Learner - DSPy Integration Architecture</title>
    <style>
        :root {
            --tier-0: #ec4899;
            --tier-1: #f97316;
            --tier-2: #eab308;
            --tier-3: #22c55e;
            --tier-4: #3b82f6;
            --tier-5: #6366f1;
            --dspy-color: #8b5cf6;
            --signal-color: #06b6d4;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-hover: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: #334155;
            --success: #22c55e;
            --warning: #f59e0b;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 40px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--dspy-color), var(--signal-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        /* Tab Navigation */
        .tab-nav {
            display: flex;
            gap: 4px;
            background: var(--bg-card);
            padding: 8px;
            border-radius: 16px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .tab-btn {
            padding: 12px 24px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tab-btn:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
        }

        .tab-btn.active {
            background: var(--dspy-color);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Section Titles */
        .section-title {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--text-secondary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before,
        .section-title::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--border);
        }

        /* ==================== TAB 1: OVERVIEW ==================== */
        .architecture {
            display: grid;
            grid-template-columns: 1fr 300px 1fr;
            gap: 30px;
            margin-bottom: 60px;
        }

        .column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .signal-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            position: relative;
        }

        .signal-card::after {
            content: '‚Üí';
            position: absolute;
            right: -25px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--signal-color);
            font-size: 1.5rem;
        }

        .tier-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .tier-0 { background: var(--tier-0); }
        .tier-1 { background: var(--tier-1); }
        .tier-2 { background: var(--tier-2); color: #000; }
        .tier-3 { background: var(--tier-3); color: #000; }
        .tier-4 { background: var(--tier-4); }
        .tier-5 { background: var(--tier-5); }

        .agent-name {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 4px;
        }

        .signal-type {
            font-size: 0.8rem;
            color: var(--signal-color);
        }

        .feedback-learner {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(139, 92, 246, 0.2));
            border: 2px solid var(--dspy-color);
            border-radius: 20px;
            padding: 24px;
            text-align: center;
        }

        .fl-header {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .fl-subheader {
            color: var(--dspy-color);
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        .workflow-steps {
            display: flex;
            flex-direction: column;
            gap: 12px;
            text-align: left;
        }

        .workflow-step {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 12px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .step-number {
            width: 28px;
            height: 28px;
            background: var(--dspy-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.85rem;
            flex-shrink: 0;
        }

        .step-content { flex: 1; }
        .step-name { font-weight: 600; font-size: 0.9rem; }
        .step-desc { font-size: 0.75rem; color: var(--text-secondary); }

        .output-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px;
            position: relative;
        }

        .output-card::before {
            content: '‚Üí';
            position: absolute;
            left: -25px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--dspy-color);
            font-size: 1.5rem;
        }

        .output-title {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 8px;
            color: var(--dspy-color);
        }

        .output-list {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .output-list li {
            margin-bottom: 4px;
            list-style: none;
            padding-left: 16px;
            position: relative;
        }

        .output-list li::before {
            content: '‚Ä¢';
            position: absolute;
            left: 0;
            color: var(--dspy-color);
        }

        /* ==================== TAB 2: 18-AGENT MATRIX ==================== */
        .agent-matrix {
            display: grid;
            gap: 24px;
        }

        .tier-section {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 24px;
            border-left: 4px solid;
        }

        .tier-section.tier-0-section { border-left-color: var(--tier-0); }
        .tier-section.tier-1-section { border-left-color: var(--tier-1); }
        .tier-section.tier-2-section { border-left-color: var(--tier-2); }
        .tier-section.tier-3-section { border-left-color: var(--tier-3); }
        .tier-section.tier-4-section { border-left-color: var(--tier-4); }
        .tier-section.tier-5-section { border-left-color: var(--tier-5); }

        .tier-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 20px;
        }

        .tier-number-large {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
        }

        .tier-0-section .tier-number-large { background: var(--tier-0); }
        .tier-1-section .tier-number-large { background: var(--tier-1); }
        .tier-2-section .tier-number-large { background: var(--tier-2); color: #000; }
        .tier-3-section .tier-number-large { background: var(--tier-3); color: #000; }
        .tier-4-section .tier-number-large { background: var(--tier-4); }
        .tier-5-section .tier-number-large { background: var(--tier-5); }

        .tier-info h3 {
            font-size: 1.2rem;
            margin-bottom: 4px;
        }

        .tier-info p {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 16px;
        }

        .agent-interaction-card {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 16px;
            border: 1px solid var(--border);
        }

        .agent-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .agent-card-name {
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .agent-type-badge {
            font-size: 0.65rem;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
        }

        .agent-type-badge.standard { background: rgba(34, 197, 94, 0.2); color: var(--success); }
        .agent-type-badge.hybrid { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .agent-type-badge.deep { background: rgba(139, 92, 246, 0.2); color: var(--dspy-color); }

        .interaction-indicators {
            display: flex;
            gap: 8px;
        }

        .indicator {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }

        .indicator.sends { background: rgba(6, 182, 212, 0.2); }
        .indicator.receives { background: rgba(139, 92, 246, 0.2); }
        .indicator.none { background: rgba(100, 116, 139, 0.2); opacity: 0.5; }

        .interaction-details {
            font-size: 0.8rem;
        }

        .detail-row {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 8px;
            padding: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
        }

        .detail-icon {
            flex-shrink: 0;
            font-size: 1rem;
        }

        .detail-content {
            flex: 1;
        }

        .detail-label {
            font-weight: 600;
            color: var(--text-secondary);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .detail-value {
            color: var(--text-primary);
            margin-top: 2px;
        }

        .no-interaction {
            color: var(--text-muted);
            font-style: italic;
            padding: 12px;
            text-align: center;
        }

        /* ==================== TAB 3: DATA HANDOFFS ==================== */
        .handoff-matrix {
            display: grid;
            gap: 24px;
        }

        .handoff-direction {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 24px;
        }

        .direction-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .direction-icon {
            width: 56px;
            height: 56px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
        }

        .direction-icon.inbound { background: linear-gradient(135deg, var(--signal-color), #0891b2); }
        .direction-icon.outbound { background: linear-gradient(135deg, var(--dspy-color), #7c3aed); }

        .direction-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .direction-subtitle {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .handoff-table {
            width: 100%;
            border-collapse: collapse;
        }

        .handoff-table th {
            text-align: left;
            padding: 12px 16px;
            background: rgba(0, 0, 0, 0.3);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border);
        }

        .handoff-table td {
            padding: 16px;
            border-bottom: 1px solid var(--border);
            vertical-align: top;
        }

        .handoff-table tr:hover td {
            background: rgba(255, 255, 255, 0.02);
        }

        .source-agent, .target-agent {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .agent-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }

        .data-artifacts {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .artifact-tag {
            background: rgba(139, 92, 246, 0.15);
            color: var(--dspy-color);
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .frequency-badge {
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 20px;
        }

        .frequency-badge.continuous { background: rgba(34, 197, 94, 0.2); color: var(--success); }
        .frequency-badge.batch { background: rgba(59, 130, 246, 0.2); color: #60a5fa; }
        .frequency-badge.weekly { background: rgba(245, 158, 11, 0.2); color: var(--warning); }

        .purpose-text {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        /* ==================== TAB 4: DSPY COMPONENTS ==================== */
        .dspy-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 24px;
            margin-bottom: 40px;
        }

        .dspy-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 24px;
        }

        .dspy-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .dspy-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--dspy-color), #a855f7);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .dspy-card-title {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .dspy-card-subtitle {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .code-block {
            background: #0d1117;
            border-radius: 8px;
            padding: 16px;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 0.75rem;
            overflow-x: auto;
            margin-top: 16px;
        }

        .code-keyword { color: #ff7b72; }
        .code-string { color: #a5d6ff; }
        .code-comment { color: #8b949e; }
        .code-type { color: #79c0ff; }

        /* Optimization Loop */
        .optimization-diagram {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 40px;
        }

        .loop-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .loop-step {
            text-align: center;
            width: 180px;
        }

        .loop-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 12px;
        }

        .loop-1 { background: linear-gradient(135deg, #06b6d4, #0891b2); }
        .loop-2 { background: linear-gradient(135deg, #8b5cf6, #7c3aed); }
        .loop-3 { background: linear-gradient(135deg, #f59e0b, #d97706); }
        .loop-4 { background: linear-gradient(135deg, #22c55e, #16a34a); }

        .loop-label { font-weight: 600; margin-bottom: 4px; }
        .loop-desc { font-size: 0.8rem; color: var(--text-secondary); }
        .loop-arrow { font-size: 2rem; color: var(--dspy-color); }

        /* Metrics */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 40px;
        }

        .metric-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--dspy-color), var(--signal-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .metric-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        /* Legend */
        .legend-bar {
            display: flex;
            justify-content: center;
            gap: 24px;
            padding: 16px;
            background: var(--bg-card);
            border-radius: 12px;
            margin-bottom: 24px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        /* Footer */
        footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid var(--border);
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .architecture { grid-template-columns: 1fr; }
            .signal-card::after, .output-card::before { display: none; }
            .dspy-grid { grid-template-columns: 1fr; }
            .metrics-grid { grid-template-columns: repeat(2, 1fr); }
            .loop-container { flex-wrap: wrap; gap: 20px; }
            .loop-arrow { display: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéì Feedback Learner √ó DSPy Integration</h1>
            <p class="subtitle">Self-Improving Prompt Optimization for the E2I 18-Agent System</p>
        </header>

        <!-- Tab Navigation -->
        <nav class="tab-nav">
            <button class="tab-btn active" data-tab="overview">üìä Overview</button>
            <button class="tab-btn" data-tab="agents">ü§ñ 18-Agent Interactions</button>
            <button class="tab-btn" data-tab="handoffs">üì¶ Data Handoffs</button>
            <button class="tab-btn" data-tab="dspy">‚ö° DSPy Components</button>
        </nav>

        <!-- ==================== TAB 1: OVERVIEW ==================== -->
        <div id="overview" class="tab-content active">
            <div class="legend-bar">
                <div class="legend-item"><div class="legend-dot" style="background: var(--signal-color);"></div> Sends Training Signals</div>
                <div class="legend-item"><div class="legend-dot" style="background: var(--dspy-color);"></div> Receives Optimized Prompts</div>
                <div class="legend-item"><div class="legend-dot" style="background: var(--success);"></div> Standard Agent</div>
                <div class="legend-item"><div class="legend-dot" style="background: var(--warning);"></div> Hybrid Agent</div>
                <div class="legend-item"><div class="legend-dot" style="background: #ec4899;"></div> Deep Agent</div>
            </div>

            <div class="architecture">
                <!-- Left: Signal Sources -->
                <div class="column">
                    <div class="section-title">Training Signals</div>
                    
                    <div class="signal-card">
                        <span class="tier-badge tier-0">TIER 0</span>
                        <div class="agent-name">model_trainer</div>
                        <div class="signal-type">‚Üí ValidationMetrics, Training traces</div>
                    </div>

                    <div class="signal-card">
                        <span class="tier-badge tier-0">TIER 0</span>
                        <div class="agent-name">observability_connector</div>
                        <div class="signal-type">‚Üí QualityMetrics, Latency spans</div>
                    </div>

                    <div class="signal-card">
                        <span class="tier-badge tier-2">TIER 2</span>
                        <div class="agent-name">causal_impact</div>
                        <div class="signal-type">‚Üí Refutation pass rates, CATE estimates</div>
                    </div>

                    <div class="signal-card">
                        <span class="tier-badge tier-3">TIER 3</span>
                        <div class="agent-name">experiment_designer</div>
                        <div class="signal-type">‚Üí Design quality scores, Power analysis</div>
                    </div>

                    <div class="signal-card">
                        <span class="tier-badge tier-5">TIER 5</span>
                        <div class="agent-name">explainer</div>
                        <div class="signal-type">‚Üí Clarity scores (1-5), User edits</div>
                    </div>

                    <div class="signal-card">
                        <span class="tier-badge" style="background: #64748b;">USER</span>
                        <div class="agent-name">Direct Feedback</div>
                        <div class="signal-type">‚Üí Ratings, Corrections, Preferences</div>
                    </div>
                </div>

                <!-- Center: Feedback Learner -->
                <div class="column">
                    <div class="section-title">Optimization Engine</div>
                    
                    <div class="feedback-learner">
                        <div class="fl-header">üéì feedback_learner</div>
                        <div class="fl-subheader">Deep Agent ‚Ä¢ DSPy MIPROv2</div>
                        
                        <div class="workflow-steps">
                            <div class="workflow-step">
                                <div class="step-number">1</div>
                                <div class="step-content">
                                    <div class="step-name">Collect</div>
                                    <div class="step-desc">Gather traces from Reflector Node</div>
                                </div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-number">2</div>
                                <div class="step-content">
                                    <div class="step-name">Bootstrap</div>
                                    <div class="step-desc">Run modules, filter by metric</div>
                                </div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-number">3</div>
                                <div class="step-content">
                                    <div class="step-name">Propose</div>
                                    <div class="step-desc">Generate candidate instructions</div>
                                </div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-number">4</div>
                                <div class="step-content">
                                    <div class="step-name">Search</div>
                                    <div class="step-desc">Bayesian optimization</div>
                                </div>
                            </div>
                            <div class="workflow-step">
                                <div class="step-number">5</div>
                                <div class="step-content">
                                    <div class="step-name">Deploy</div>
                                    <div class="step-desc">Promote to production</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right: Outputs -->
                <div class="column">
                    <div class="section-title">Optimized Outputs</div>

                    <div class="output-card">
                        <div class="output-title">üìù Optimized Instructions</div>
                        <ul class="output-list">
                            <li>Agent-specific system prompts</li>
                            <li>Task decomposition templates</li>
                            <li>Output format specifications</li>
                        </ul>
                    </div>

                    <div class="output-card">
                        <div class="output-title">üìö Few-Shot Demonstrations</div>
                        <ul class="output-list">
                            <li>Curated input/output examples</li>
                            <li>Edge case handling patterns</li>
                            <li>Domain-specific exemplars</li>
                        </ul>
                    </div>

                    <div class="output-card">
                        <div class="output-title">üóÑÔ∏è Prompt Registry</div>
                        <ul class="output-list">
                            <li>Versioned prompt storage</li>
                            <li>A/B test configurations</li>
                            <li>Rollback capabilities</li>
                        </ul>
                    </div>

                    <div class="output-card">
                        <div class="output-title">üìä Performance Metrics</div>
                        <ul class="output-list">
                            <li>Before/after comparisons</li>
                            <li>MLflow experiment tracking</li>
                            <li>Quarterly improvement reports</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Metrics -->
            <div class="section-title">Target Metrics</div>
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">+5%</div>
                    <div class="metric-label">Quarterly Improvement</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">>0.82</div>
                    <div class="metric-label">AUC Target</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">4+/5</div>
                    <div class="metric-label">Clarity Score</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">4x</div>
                    <div class="metric-label">ROI Target</div>
                </div>
            </div>
        </div>

        <!-- ==================== TAB 2: 18-AGENT INTERACTIONS ==================== -->
        <div id="agents" class="tab-content">
            <div class="legend-bar">
                <div class="legend-item"><span style="font-size: 1.2rem;">üì§</span> Sends Training Signals to Feedback Learner</div>
                <div class="legend-item"><span style="font-size: 1.2rem;">üì•</span> Receives Optimized Prompts from Feedback Learner</div>
                <div class="legend-item"><span style="font-size: 1.2rem;">‚ö™</span> No Direct Interaction</div>
            </div>

            <div class="agent-matrix">
                <!-- Tier 0: ML Foundation -->
                <div class="tier-section tier-0-section">
                    <div class="tier-header">
                        <div class="tier-number-large">0</div>
                        <div class="tier-info">
                            <h3>ML Foundation</h3>
                            <p>7 Agents ‚Ä¢ Complete ML lifecycle from scope to deployment</p>
                        </div>
                    </div>
                    <div class="agents-grid">
                        <!-- scope_definer -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üéØ scope_definer
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator none">‚ö™</div>
                                </div>
                            </div>
                            <div class="no-interaction">
                                No direct DSPy interaction. Defines ML experiment scope and success criteria. Outputs consumed by model_trainer.
                            </div>
                        </div>

                        <!-- data_preparer -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üßπ data_preparer
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator none">‚ö™</div>
                                </div>
                            </div>
                            <div class="no-interaction">
                                No direct DSPy interaction. Handles data quality and ML splits. QC reports gate model training.
                            </div>
                        </div>

                        <!-- model_selector -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üîç model_selector
                                    <span class="agent-type-badge hybrid">Hybrid</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator receives">üì•</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì•</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Receives</div>
                                        <div class="detail-value">Optimized algorithm selection prompts, model comparison reasoning templates</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- model_trainer -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üèãÔ∏è model_trainer
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator sends">üì§</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì§</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Sends</div>
                                        <div class="detail-value">ValidationMetrics, MLflow experiment IDs, hyperparameter histories, training duration patterns</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- feature_analyzer -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üìä feature_analyzer
                                    <span class="agent-type-badge hybrid">Hybrid</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator sends">üì§</div>
                                    <div class="indicator receives">üì•</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì§</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Sends</div>
                                        <div class="detail-value">SHAP analysis quality scores, feature interaction patterns</div>
                                    </div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-icon">üì•</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Receives</div>
                                        <div class="detail-value">Optimized SHAP interpretation prompts, feature importance reasoning templates</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- model_deployer -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üöÄ model_deployer
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator none">‚ö™</div>
                                </div>
                            </div>
                            <div class="no-interaction">
                                No direct DSPy interaction. Handles deployment manifests and endpoint creation. Purely operational.
                            </div>
                        </div>

                        <!-- observability_connector -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üì° observability_connector
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator sends">üì§</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì§</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Sends</div>
                                        <div class="detail-value">QualityMetrics, latency spans (p50/p95/p99), error rates, token usage, fallback chain invocations</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tier 1: Coordination -->
                <div class="tier-section tier-1-section">
                    <div class="tier-header">
                        <div class="tier-number-large">1</div>
                        <div class="tier-info">
                            <h3>Coordination</h3>
                            <p>1 Agent ‚Ä¢ Routes requests across the 18-agent system</p>
                        </div>
                    </div>
                    <div class="agents-grid">
                        <!-- orchestrator -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üé≠ orchestrator
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator sends">üì§</div>
                                    <div class="indicator receives">üì•</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì§</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Sends</div>
                                        <div class="detail-value">Routing decision traces, agent selection patterns, query classification accuracy</div>
                                    </div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-icon">üì•</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Receives</div>
                                        <div class="detail-value">Optimized routing prompts, agent selection heuristics, intent classification templates</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tier 2: Causal Analytics -->
                <div class="tier-section tier-2-section">
                    <div class="tier-header">
                        <div class="tier-number-large">2</div>
                        <div class="tier-info">
                            <h3>Causal Analytics</h3>
                            <p>3 Agents ‚Ä¢ DoWhy/EconML causal inference and treatment effects</p>
                        </div>
                    </div>
                    <div class="agents-grid">
                        <!-- causal_impact -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üî¨ causal_impact
                                    <span class="agent-type-badge hybrid">Hybrid</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator sends">üì§</div>
                                    <div class="indicator receives">üì•</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì§</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Sends</div>
                                        <div class="detail-value">Refutation test pass rates, CATE estimates, confidence intervals, interpretation quality scores</div>
                                    </div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-icon">üì•</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Receives</div>
                                        <div class="detail-value">Optimized causal reasoning prompts, confounder identification templates, interpretation guidelines</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- gap_analyzer -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üéØ gap_analyzer
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator sends">üì§</div>
                                    <div class="indicator receives">üì•</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì§</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Sends</div>
                                        <div class="detail-value">ROI calculation accuracy, opportunity identification patterns</div>
                                    </div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-icon">üì•</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Receives</div>
                                        <div class="detail-value">Optimized gap detection prompts, ROI reasoning templates</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- heterogeneous_optimizer -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    ‚öñÔ∏è heterogeneous_optimizer
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator receives">üì•</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì•</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Receives</div>
                                        <div class="detail-value">Optimized CATE interpretation prompts, treatment effect explanation templates</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tier 3: Monitoring -->
                <div class="tier-section tier-3-section">
                    <div class="tier-header">
                        <div class="tier-number-large">3</div>
                        <div class="tier-info">
                            <h3>Monitoring & Experimentation</h3>
                            <p>3 Agents ‚Ä¢ Drift detection, A/B testing, system health</p>
                        </div>
                    </div>
                    <div class="agents-grid">
                        <!-- drift_monitor -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üìâ drift_monitor
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator sends">üì§</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì§</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Sends</div>
                                        <div class="detail-value">Drift detection accuracy, alert precision, false positive rates</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- experiment_designer -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üß™ experiment_designer
                                    <span class="agent-type-badge hybrid">Hybrid</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator sends">üì§</div>
                                    <div class="indicator receives">üì•</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì§</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Sends</div>
                                        <div class="detail-value">Design quality scores, power analysis accuracy, validity assessments</div>
                                    </div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-icon">üì•</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Receives</div>
                                        <div class="detail-value">Optimized experiment design prompts, sample size reasoning templates</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- health_score -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üíö health_score
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator none">‚ö™</div>
                                </div>
                            </div>
                            <div class="no-interaction">
                                No direct DSPy interaction. Aggregates system health metrics. Consumes observability data to produce health scores.
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tier 4: ML Predictions -->
                <div class="tier-section tier-4-section">
                    <div class="tier-header">
                        <div class="tier-number-large">4</div>
                        <div class="tier-info">
                            <h3>ML Predictions & Optimization</h3>
                            <p>2 Agents ‚Ä¢ Ensemble predictions and resource allocation</p>
                        </div>
                    </div>
                    <div class="agents-grid">
                        <!-- prediction_synthesizer -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üîÆ prediction_synthesizer
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator sends">üì§</div>
                                    <div class="indicator receives">üì•</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì§</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Sends</div>
                                        <div class="detail-value">Prediction accuracy, calibration scores, ensemble weight effectiveness</div>
                                    </div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-icon">üì•</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Receives</div>
                                        <div class="detail-value">Optimized ensemble reasoning prompts, confidence calibration templates</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- resource_optimizer -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üí∞ resource_optimizer
                                    <span class="agent-type-badge standard">Standard</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator sends">üì§</div>
                                    <div class="indicator receives">üì•</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì§</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Sends</div>
                                        <div class="detail-value">ROI achievement rates, allocation effectiveness scores</div>
                                    </div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-icon">üì•</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Receives</div>
                                        <div class="detail-value">Optimized allocation reasoning prompts, constraint handling templates</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tier 5: Self-Improvement -->
                <div class="tier-section tier-5-section">
                    <div class="tier-header">
                        <div class="tier-number-large">5</div>
                        <div class="tier-info">
                            <h3>Self-Improvement</h3>
                            <p>2 Agents ‚Ä¢ Natural language generation and continuous learning</p>
                        </div>
                    </div>
                    <div class="agents-grid">
                        <!-- explainer -->
                        <div class="agent-interaction-card">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üìù explainer
                                    <span class="agent-type-badge deep">Deep</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator sends">üì§</div>
                                    <div class="indicator receives">üì•</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row">
                                    <div class="detail-icon">üì§</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Sends</div>
                                        <div class="detail-value">Clarity scores (1-5), user edit patterns, narrative effectiveness ratings</div>
                                    </div>
                                </div>
                                <div class="detail-row">
                                    <div class="detail-icon">üì•</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Receives</div>
                                        <div class="detail-value">Optimized narrative generation prompts, audience-adaptive explanation templates</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- feedback_learner -->
                        <div class="agent-interaction-card" style="border: 2px solid var(--dspy-color); background: rgba(99, 102, 241, 0.1);">
                            <div class="agent-card-header">
                                <div class="agent-card-name">
                                    üéì feedback_learner
                                    <span class="agent-type-badge deep">Deep</span>
                                </div>
                                <div class="interaction-indicators">
                                    <div class="indicator" style="background: linear-gradient(135deg, var(--signal-color), var(--dspy-color));">üîÑ</div>
                                </div>
                            </div>
                            <div class="interaction-details">
                                <div class="detail-row" style="background: rgba(139, 92, 246, 0.1);">
                                    <div class="detail-icon">üîÑ</div>
                                    <div class="detail-content">
                                        <div class="detail-label">Core Function</div>
                                        <div class="detail-value">Receives training signals from 12 agents, optimizes prompts via DSPy MIPROv2, deploys improvements to 10 agents</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ==================== TAB 3: DATA HANDOFFS ==================== -->
        <div id="handoffs" class="tab-content">
            <div class="handoff-matrix">
                <!-- Inbound Data -->
                <div class="handoff-direction">
                    <div class="direction-header">
                        <div class="direction-icon inbound">üì•</div>
                        <div>
                            <div class="direction-title">Inbound: Training Signals ‚Üí Feedback Learner</div>
                            <div class="direction-subtitle">Data collected by Reflector Node for DSPy optimization</div>
                        </div>
                    </div>
                    <table class="handoff-table">
                        <thead>
                            <tr>
                                <th>Source Agent</th>
                                <th>Data Artifacts</th>
                                <th>Frequency</th>
                                <th>Purpose</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: var(--tier-0);"></div>
                                        model_trainer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">ValidationMetrics</span>
                                        <span class="artifact-tag">MLflow IDs</span>
                                        <span class="artifact-tag">Hyperparameters</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge batch">Per Training Run</span></td>
                                <td class="purpose-text">Establish performance baselines, correlate prompt changes with model improvements</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: var(--tier-0);"></div>
                                        observability_connector
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">QualityMetrics</span>
                                        <span class="artifact-tag">Latency Spans</span>
                                        <span class="artifact-tag">Error Rates</span>
                                        <span class="artifact-tag">Token Usage</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge continuous">Continuous</span></td>
                                <td class="purpose-text">Monitor agent performance degradation, trigger optimization cycles</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: var(--tier-0);"></div>
                                        feature_analyzer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">SHAP Quality</span>
                                        <span class="artifact-tag">Interaction Patterns</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge batch">Per Analysis</span></td>
                                <td class="purpose-text">Improve feature interpretation reasoning quality</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: var(--tier-1);"></div>
                                        orchestrator
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Routing Traces</span>
                                        <span class="artifact-tag">Classification Accuracy</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge continuous">Continuous</span></td>
                                <td class="purpose-text">Optimize intent classification and agent routing decisions</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: var(--tier-2);"></div>
                                        causal_impact
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Refutation Pass Rates</span>
                                        <span class="artifact-tag">CATE Estimates</span>
                                        <span class="artifact-tag">Confidence Intervals</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge batch">Per Analysis</span></td>
                                <td class="purpose-text">Train causal reasoning and interpretation prompts</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: var(--tier-2);"></div>
                                        gap_analyzer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">ROI Accuracy</span>
                                        <span class="artifact-tag">Opportunity Patterns</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge batch">Per Analysis</span></td>
                                <td class="purpose-text">Improve ROI calculation and opportunity identification</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: var(--tier-3);"></div>
                                        experiment_designer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Design Quality</span>
                                        <span class="artifact-tag">Power Analysis</span>
                                        <span class="artifact-tag">Validity Scores</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge batch">Per Design</span></td>
                                <td class="purpose-text">Optimize experiment design reasoning and statistical calculations</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: var(--tier-3);"></div>
                                        drift_monitor
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Detection Accuracy</span>
                                        <span class="artifact-tag">False Positive Rates</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge continuous">Continuous</span></td>
                                <td class="purpose-text">Calibrate drift detection sensitivity thresholds</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: var(--tier-4);"></div>
                                        prediction_synthesizer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Prediction Accuracy</span>
                                        <span class="artifact-tag">Calibration Scores</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge batch">Per Prediction</span></td>
                                <td class="purpose-text">Improve ensemble weighting and confidence calibration</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: var(--tier-4);"></div>
                                        resource_optimizer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">ROI Achievement</span>
                                        <span class="artifact-tag">Allocation Effectiveness</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge batch">Per Allocation</span></td>
                                <td class="purpose-text">Optimize constraint handling and ROI reasoning</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: var(--tier-5);"></div>
                                        explainer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Clarity Scores</span>
                                        <span class="artifact-tag">User Edits</span>
                                        <span class="artifact-tag">Narrative Effectiveness</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge continuous">Continuous</span></td>
                                <td class="purpose-text">Primary training signal for narrative generation optimization</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="source-agent">
                                        <div class="agent-dot" style="background: #64748b;"></div>
                                        User Interface
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Thumbs Up/Down</span>
                                        <span class="artifact-tag">Corrections</span>
                                        <span class="artifact-tag">Preferences</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge continuous">Continuous</span></td>
                                <td class="purpose-text">Ground truth signal for human preference alignment</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Outbound Data -->
                <div class="handoff-direction">
                    <div class="direction-header">
                        <div class="direction-icon outbound">üì§</div>
                        <div>
                            <div class="direction-title">Outbound: Feedback Learner ‚Üí Optimized Prompts</div>
                            <div class="direction-subtitle">Deployed via Prompt Registry after MIPROv2 optimization</div>
                        </div>
                    </div>
                    <table class="handoff-table">
                        <thead>
                            <tr>
                                <th>Target Agent</th>
                                <th>Optimized Artifacts</th>
                                <th>Deployment</th>
                                <th>Expected Improvement</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div class="target-agent">
                                        <div class="agent-dot" style="background: var(--tier-0);"></div>
                                        model_selector
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Algorithm Selection Prompts</span>
                                        <span class="artifact-tag">Comparison Templates</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge weekly">Weekly</span></td>
                                <td class="purpose-text">Better algorithm-task matching, faster convergence</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="target-agent">
                                        <div class="agent-dot" style="background: var(--tier-0);"></div>
                                        feature_analyzer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">SHAP Interpretation Prompts</span>
                                        <span class="artifact-tag">Feature Reasoning Templates</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge weekly">Weekly</span></td>
                                <td class="purpose-text">Clearer feature importance explanations</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="target-agent">
                                        <div class="agent-dot" style="background: var(--tier-1);"></div>
                                        orchestrator
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Routing Prompts</span>
                                        <span class="artifact-tag">Intent Classification</span>
                                        <span class="artifact-tag">Agent Selection Heuristics</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge weekly">Weekly</span></td>
                                <td class="purpose-text">More accurate query routing, reduced fallbacks</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="target-agent">
                                        <div class="agent-dot" style="background: var(--tier-2);"></div>
                                        causal_impact
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Causal Reasoning Prompts</span>
                                        <span class="artifact-tag">Confounder Templates</span>
                                        <span class="artifact-tag">Interpretation Guidelines</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge weekly">Weekly</span></td>
                                <td class="purpose-text">Higher refutation pass rates, better causal interpretations</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="target-agent">
                                        <div class="agent-dot" style="background: var(--tier-2);"></div>
                                        gap_analyzer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Gap Detection Prompts</span>
                                        <span class="artifact-tag">ROI Reasoning</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge weekly">Weekly</span></td>
                                <td class="purpose-text">More accurate opportunity identification</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="target-agent">
                                        <div class="agent-dot" style="background: var(--tier-2);"></div>
                                        heterogeneous_optimizer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">CATE Interpretation</span>
                                        <span class="artifact-tag">Treatment Effect Templates</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge weekly">Weekly</span></td>
                                <td class="purpose-text">Clearer heterogeneous treatment effect explanations</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="target-agent">
                                        <div class="agent-dot" style="background: var(--tier-3);"></div>
                                        experiment_designer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Design Prompts</span>
                                        <span class="artifact-tag">Sample Size Reasoning</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge weekly">Weekly</span></td>
                                <td class="purpose-text">Better experiment designs, accurate power analysis</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="target-agent">
                                        <div class="agent-dot" style="background: var(--tier-4);"></div>
                                        prediction_synthesizer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Ensemble Reasoning</span>
                                        <span class="artifact-tag">Confidence Calibration</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge weekly">Weekly</span></td>
                                <td class="purpose-text">Better calibrated predictions, smarter ensemble weighting</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="target-agent">
                                        <div class="agent-dot" style="background: var(--tier-4);"></div>
                                        resource_optimizer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Allocation Reasoning</span>
                                        <span class="artifact-tag">Constraint Handling</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge weekly">Weekly</span></td>
                                <td class="purpose-text">Better ROI optimization, constraint satisfaction</td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="target-agent">
                                        <div class="agent-dot" style="background: var(--tier-5);"></div>
                                        explainer
                                    </div>
                                </td>
                                <td>
                                    <div class="data-artifacts">
                                        <span class="artifact-tag">Narrative Generation</span>
                                        <span class="artifact-tag">Audience Adaptation</span>
                                        <span class="artifact-tag">Clarity Templates</span>
                                    </div>
                                </td>
                                <td><span class="frequency-badge weekly">Weekly</span></td>
                                <td class="purpose-text">Higher clarity scores, better audience adaptation</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ==================== TAB 4: DSPY COMPONENTS ==================== -->
        <div id="dspy" class="tab-content">
            <div class="section-title">Core DSPy Components</div>
            
            <div class="dspy-grid">
                <div class="dspy-card">
                    <div class="dspy-card-header">
                        <div class="dspy-icon">üìã</div>
                        <div>
                            <div class="dspy-card-title">Signatures</div>
                            <div class="dspy-card-subtitle">Define WHAT agents do</div>
                        </div>
                    </div>
                    <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 12px;">
                        Declarative specifications of inputs and outputs. DSPy figures out HOW to prompt.
                    </p>
                    <div class="code-block">
<span class="code-keyword">class</span> <span class="code-type">CausalImpactSignature</span>(dspy.Signature):
    <span class="code-string">"""Analyze intervention for causal effects."""</span>
    intervention: <span class="code-type">str</span> = dspy.InputField()
    confounders: <span class="code-type">list</span> = dspy.InputField()
    
    causal_estimate: <span class="code-type">str</span> = dspy.OutputField()
    interpretation: <span class="code-type">str</span> = dspy.OutputField()
                    </div>
                </div>

                <div class="dspy-card">
                    <div class="dspy-card-header">
                        <div class="dspy-icon">üß©</div>
                        <div>
                            <div class="dspy-card-title">Modules</div>
                            <div class="dspy-card-subtitle">Implement HOW agents reason</div>
                        </div>
                    </div>
                    <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 12px;">
                        Composable reasoning strategies (ChainOfThought, ReAct, etc.) that can be optimized.
                    </p>
                    <div class="code-block">
<span class="code-keyword">class</span> <span class="code-type">CausalImpactModule</span>(dspy.Module):
    <span class="code-keyword">def</span> __init__(<span class="code-keyword">self</span>):
        <span class="code-keyword">self</span>.analyze = dspy.ChainOfThought(
            CausalImpactSignature
        )
        <span class="code-keyword">self</span>.validate = dspy.Predict(
            <span class="code-string">"estimate -> is_valid"</span>
        )
                    </div>
                </div>

                <div class="dspy-card">
                    <div class="dspy-card-header">
                        <div class="dspy-icon">‚ö°</div>
                        <div>
                            <div class="dspy-card-title">Optimizers</div>
                            <div class="dspy-card-subtitle">Automatically IMPROVE prompts</div>
                        </div>
                    </div>
                    <p style="color: var(--text-secondary); font-size: 0.85rem; margin-bottom: 12px;">
                        MIPROv2 uses Bayesian search to find optimal instructions and demonstrations.
                    </p>
                    <div class="code-block">
optimizer = MIPROv2(
    metric=causal_metric,
    num_candidates=<span class="code-string">10</span>,
    max_bootstrapped_demos=<span class="code-string">4</span>
)

optimized = optimizer.compile(
    module,
    trainset=signals,
    num_trials=<span class="code-string">100</span>
)
                    </div>
                </div>
            </div>

            <div class="section-title" style="margin-top: 40px;">MIPROv2 Optimization Loop</div>
            
            <div class="optimization-diagram">
                <div class="loop-container">
                    <div class="loop-step">
                        <div class="loop-circle loop-1">üìä</div>
                        <div class="loop-label">Bootstrap</div>
                        <div class="loop-desc">Run module on training data, collect successful traces</div>
                    </div>
                    <div class="loop-arrow">‚Üí</div>
                    <div class="loop-step">
                        <div class="loop-circle loop-2">üí°</div>
                        <div class="loop-label">Propose</div>
                        <div class="loop-desc">LLM analyzes traces, drafts candidate instructions</div>
                    </div>
                    <div class="loop-arrow">‚Üí</div>
                    <div class="loop-step">
                        <div class="loop-circle loop-3">üîç</div>
                        <div class="loop-label">Search</div>
                        <div class="loop-desc">Bayesian optimization finds best instruction/demo combo</div>
                    </div>
                    <div class="loop-arrow">‚Üí</div>
                    <div class="loop-step">
                        <div class="loop-circle loop-4">üöÄ</div>
                        <div class="loop-label">Deploy</div>
                        <div class="loop-desc">Winning prompts promoted via Prompt Registry</div>
                    </div>
                </div>
            </div>

            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-value">+5%</div>
                    <div class="metric-label">Quarterly Improvement</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">12</div>
                    <div class="metric-label">Signal Sources</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">10</div>
                    <div class="metric-label">Optimized Agents</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">100</div>
                    <div class="metric-label">Trials per Cycle</div>
                </div>
            </div>
        </div>

        <footer>
            <p>E2I Causal Analytics V4.1 ‚Ä¢ Feedback Learner DSPy Integration ‚Ä¢ 18 Agents ‚Ä¢ 6 Tiers</p>
        </footer>
    </div>

    <script>
        // Tab functionality
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // Remove active class from all buttons and content
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked button and corresponding content
                btn.classList.add('active');
                document.getElementById(btn.dataset.tab).classList.add('active');
            });
        });
    </script>
</body>
</html>
