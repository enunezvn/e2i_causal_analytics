<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E2I Semantic Graph Ontology - Complete Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --bg-light: #ecf0f1;
            --bg-white: #ffffff;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --border-color: #bdc3c7;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background-color: var(--bg-light);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 60px 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        nav {
            background: var(--bg-white);
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            sticky: top;
            top: 0;
            z-index: 100;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        nav a {
            color: var(--secondary-color);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s;
        }

        nav a:hover {
            color: var(--accent-color);
        }

        section {
            background: var(--bg-white);
            margin: 30px 0;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        h2 {
            color: var(--primary-color);
            font-size: 2em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--secondary-color);
        }

        h3 {
            color: var(--secondary-color);
            font-size: 1.5em;
            margin: 30px 0 15px 0;
        }

        h4 {
            color: var(--text-dark);
            font-size: 1.2em;
            margin: 20px 0 10px 0;
        }

        p {
            margin-bottom: 15px;
            line-height: 1.8;
        }

        .highlight-box {
            background: #e8f4f8;
            border-left: 4px solid var(--secondary-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid var(--warning-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid var(--success-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .card {
            background: var(--bg-light);
            padding: 25px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .card h4 {
            color: var(--secondary-color);
            margin-bottom: 15px;
        }

        .node-card {
            border-left: 4px solid var(--success-color);
        }

        .edge-card {
            border-left: 4px solid var(--accent-color);
        }

        .agent-card {
            border-left: 4px solid var(--warning-color);
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        .diagram {
            background: var(--bg-white);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
        }

        .flow-diagram {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 30px 0;
        }

        .flow-step {
            background: var(--secondary-color);
            color: white;
            padding: 20px 30px;
            border-radius: 8px;
            min-width: 150px;
            text-align: center;
            font-weight: 600;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .flow-arrow {
            font-size: 2em;
            color: var(--secondary-color);
            font-weight: bold;
        }

        .lifecycle-stage {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .lifecycle-stage h4 {
            color: white;
            margin-bottom: 15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: var(--bg-light);
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin: 2px;
        }

        .badge-node { background: #d4edda; color: #155724; }
        .badge-edge { background: #f8d7da; color: #721c24; }
        .badge-tier1 { background: #cce5ff; color: #004085; }
        .badge-tier2 { background: #d1ecf1; color: #0c5460; }
        .badge-tier3 { background: #d4edda; color: #155724; }
        .badge-tier4 { background: #fff3cd; color: #856404; }
        .badge-tier5 { background: #f8d7da; color: #721c24; }
        .badge-tier6 { background: #e2e3e5; color: #383d41; }

        .property-list {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }

        .property-list li {
            margin: 5px 0;
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        .timeline {
            position: relative;
            padding: 20px 0;
            margin: 30px 0;
        }

        .timeline-item {
            position: relative;
            padding-left: 40px;
            margin-bottom: 30px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--secondary-color);
            border: 3px solid white;
            box-shadow: 0 0 0 3px var(--secondary-color);
        }

        .timeline-item::after {
            content: '';
            position: absolute;
            left: 19px;
            top: 20px;
            width: 2px;
            height: calc(100% + 10px);
            background: var(--border-color);
        }

        .timeline-item:last-child::after {
            display: none;
        }

        footer {
            background: var(--primary-color);
            color: white;
            text-align: center;
            padding: 30px 20px;
            margin-top: 40px;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            nav ul {
                flex-direction: column;
                align-items: center;
            }

            section {
                padding: 20px;
            }

            .grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>üîó E2I Semantic Graph Ontology</h1>
            <p>A Comprehensive Guide to the Evidence-to-Impact Platform's Knowledge Graph</p>
        </div>
    </header>

    <div class="container">
        <nav>
            <ul>
                <li><a href="#overview">Overview</a></li>
                <li><a href="#structure">Structure</a></li>
                <li><a href="#lifecycle">Lifecycle</a></li>
                <li><a href="#integration">E2I Integration</a></li>
                <li><a href="#examples">Examples</a></li>
                <li><a href="#maintenance">Maintenance</a></li>
            </ul>
        </nav>

        <!-- SECTION 1: OVERVIEW -->
        <section id="overview">
            <h2>üìñ What is the E2I Semantic Graph Ontology?</h2>
            
            <p>The <strong>E2I Semantic Graph Ontology</strong> is a structured knowledge representation system that powers Novartis's Evidence-to-Impact (E2I) platform for precision medicine and causal analytics in pharmaceutical commercial operations.</p>

            <div class="highlight-box">
                <h4>üéØ Purpose</h4>
                <p>The ontology serves as the <strong>single source of truth</strong> for how we model, validate, and reason about:</p>
                <ul>
                    <li><strong>Entities</strong>: Patients, HCPs, Brands, Regions, KPIs</li>
                    <li><strong>Relationships</strong>: Who treats whom, who prescribes what, how entities influence each other</li>
                    <li><strong>Causal Knowledge</strong>: What interventions cause what outcomes</li>
                    <li><strong>Operational Metadata</strong>: Triggers, agents, validation states</li>
                </ul>
            </div>

            <h3>Why Use a Semantic Graph?</h3>
            
            <div class="grid">
                <div class="card">
                    <h4>üîç Rich Context</h4>
                    <p>Traditional databases store isolated records. Graphs capture <strong>relationships and context</strong>, enabling questions like "Which HCPs influence prescribers of Brand X?"</p>
                </div>
                
                <div class="card">
                    <h4>üß† Reasoning & Inference</h4>
                    <p>The ontology includes <strong>inference rules</strong> that automatically discover new relationships from existing data (e.g., transitive influence chains).</p>
                </div>
                
                <div class="card">
                    <h4>‚úÖ Quality & Validation</h4>
                    <p>Built-in <strong>validation rules</strong> ensure data integrity (e.g., patients can't skip journey stages, causal graphs must be acyclic).</p>
                </div>
                
                <div class="card">
                    <h4>üîÑ Explainability</h4>
                    <p>Every insight traces back through the graph, providing full <strong>provenance</strong> (which agent discovered what, from which data).</p>
                </div>
            </div>

            <h3>Technology Stack</h3>
            <ul>
                <li><strong>Graph Database</strong>: FalkorDB (RedisGraph-compatible, in-memory, Cypher queries)</li>
                <li><strong>Knowledge Layer</strong>: Grafiti (Python library for semantic graph operations)</li>
                <li><strong>Vocabulary Management</strong>: 19 YAML modules (modular, version-controlled)</li>
                <li><strong>Agent Framework</strong>: 18 agents across 6 tiers for causal discovery and validation</li>
            </ul>
        </section>

        <!-- SECTION 2: STRUCTURE -->
        <section id="structure">
            <h2>üèóÔ∏è Ontology Structure</h2>

            <h3>8 Core Node Types</h3>
            
            <div class="grid">
                <div class="card node-card">
                    <h4><span class="badge badge-node">Patient</span></h4>
                    <div class="property-list">
                        <strong>Key Properties:</strong>
                        <ul>
                            <li><code>patient_id</code>: PAT12345678</li>
                            <li><code>journey_stage</code>: 7 stages (aware ‚Üí maintained)</li>
                            <li><code>region</code>: northeast/south/midwest/west</li>
                            <li><code>risk_score</code>: [0.0, 1.0]</li>
                        </ul>
                    </div>
                </div>

                <div class="card node-card">
                    <h4><span class="badge badge-node">HCP</span></h4>
                    <div class="property-list">
                        <strong>Key Properties:</strong>
                        <ul>
                            <li><code>hcp_id</code>: HCP87654321</li>
                            <li><code>npi</code>: 10-digit unique identifier</li>
                            <li><code>specialty</code>: 13 specialty types</li>
                            <li><code>priority_tier</code>: tier_1/tier_2/tier_3</li>
                        </ul>
                    </div>
                </div>

                <div class="card node-card">
                    <h4><span class="badge badge-node">Brand</span></h4>
                    <div class="property-list">
                        <strong>Key Properties:</strong>
                        <ul>
                            <li><code>brand_name</code>: remibrutinib/fabhalta/kisqali</li>
                            <li><code>therapeutic_area</code>: immunology/hematology/oncology</li>
                            <li><code>indication</code>: Primary indication text</li>
                        </ul>
                    </div>
                </div>

                <div class="card node-card">
                    <h4><span class="badge badge-node">Region</span></h4>
                    <div class="property-list">
                        <strong>Key Properties:</strong>
                        <ul>
                            <li><code>region_name</code>: northeast/south/midwest/west</li>
                            <li><code>state_count</code>: Number of states</li>
                        </ul>
                    </div>
                </div>

                <div class="card node-card">
                    <h4><span class="badge badge-node">KPI</span></h4>
                    <div class="property-list">
                        <strong>Key Properties:</strong>
                        <ul>
                            <li><code>kpi_id</code>: KPI000001</li>
                            <li><code>category</code>: 6 workstream categories</li>
                            <li><code>target_value</code>: Goal value</li>
                            <li><code>current_value</code>: Measured value</li>
                        </ul>
                    </div>
                </div>

                <div class="card node-card">
                    <h4><span class="badge badge-node">CausalPath</span></h4>
                    <div class="property-list">
                        <strong>Key Properties:</strong>
                        <ul>
                            <li><code>path_id</code>: CP12345678</li>
                            <li><code>source_variable</code>: Independent variable</li>
                            <li><code>target_variable</code>: Dependent variable</li>
                            <li><code>effect_size</code>: Quantified effect</li>
                            <li><code>confidence</code>: [0.0, 1.0]</li>
                            <li><code>method_used</code>: DoWhy/EconML method</li>
                        </ul>
                    </div>
                </div>

                <div class="card node-card">
                    <h4><span class="badge badge-node">Trigger</span></h4>
                    <div class="property-list">
                        <strong>Key Properties:</strong>
                        <ul>
                            <li><code>trigger_id</code>: TRG87654321</li>
                            <li><code>trigger_type</code>: alert/recommendation/insight/nba</li>
                            <li><code>priority</code>: critical/high/medium/low</li>
                            <li><code>status</code>: pending/delivered/completed/expired</li>
                        </ul>
                    </div>
                </div>

                <div class="card node-card">
                    <h4><span class="badge badge-node">Agent</span></h4>
                    <div class="property-list">
                        <strong>Key Properties:</strong>
                        <ul>
                            <li><code>agent_name</code>: One of 18 agents</li>
                            <li><code>tier</code>: 1-6 (agent tier)</li>
                            <li><code>version</code>: Agent version string</li>
                        </ul>
                    </div>
                </div>
            </div>

            <h3>15 Relationship Types (Edges)</h3>

            <table>
                <thead>
                    <tr>
                        <th>Edge Type</th>
                        <th>Source ‚Üí Target</th>
                        <th>Cardinality</th>
                        <th>Purpose</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>TREATED_BY</strong></td>
                        <td>Patient ‚Üí HCP</td>
                        <td>N:M</td>
                        <td>Patient-provider relationships</td>
                    </tr>
                    <tr>
                        <td><strong>PRESCRIBED</strong></td>
                        <td>Patient ‚Üí Brand</td>
                        <td>N:M</td>
                        <td>Prescription history</td>
                    </tr>
                    <tr>
                        <td><strong>PRESCRIBES</strong></td>
                        <td>HCP ‚Üí Brand</td>
                        <td>N:M</td>
                        <td>Prescribing behavior</td>
                    </tr>
                    <tr>
                        <td><strong>PRACTICES_IN</strong></td>
                        <td>HCP ‚Üí Region</td>
                        <td>N:1</td>
                        <td>Geographic location</td>
                    </tr>
                    <tr>
                        <td><strong>LOCATED_IN</strong></td>
                        <td>Patient ‚Üí Region</td>
                        <td>N:1</td>
                        <td>Patient residence</td>
                    </tr>
                    <tr>
                        <td><strong>INFLUENCES</strong></td>
                        <td>HCP ‚Üí HCP</td>
                        <td>N:M</td>
                        <td>Peer influence networks</td>
                    </tr>
                    <tr>
                        <td><strong>RECEIVED</strong></td>
                        <td>HCP ‚Üí Trigger</td>
                        <td>N:M</td>
                        <td>Trigger delivery tracking</td>
                    </tr>
                    <tr>
                        <td><strong>CAUSES</strong></td>
                        <td>Any ‚Üí Any</td>
                        <td>N:M</td>
                        <td>Causal relationships</td>
                    </tr>
                    <tr>
                        <td><strong>IMPACTS</strong></td>
                        <td>CausalPath ‚Üí KPI</td>
                        <td>N:M</td>
                        <td>Path effect on KPIs</td>
                    </tr>
                    <tr>
                        <td><strong>ANALYZES</strong></td>
                        <td>Agent ‚Üí Any</td>
                        <td>N:M</td>
                        <td>Agent activity tracking</td>
                    </tr>
                    <tr>
                        <td><strong>DISCOVERED</strong></td>
                        <td>Agent ‚Üí CausalPath</td>
                        <td>N:M</td>
                        <td>Provenance of insights</td>
                    </tr>
                    <tr>
                        <td><strong>GENERATED</strong></td>
                        <td>Agent ‚Üí Trigger</td>
                        <td>N:M</td>
                        <td>Trigger source tracking</td>
                    </tr>
                    <tr>
                        <td><strong>TRANSITIONED_TO</strong></td>
                        <td>Patient ‚Üí Patient</td>
                        <td>N:N (self)</td>
                        <td>Journey stage transitions</td>
                    </tr>
                    <tr>
                        <td><strong>INDIRECTLY_INFLUENCES</strong></td>
                        <td>Any ‚Üí Any</td>
                        <td>N:M</td>
                        <td>Inferred transitive influence</td>
                    </tr>
                    <tr>
                        <td><strong>HIGH_POTENTIAL_PRESCRIBER</strong></td>
                        <td>HCP ‚Üí Brand</td>
                        <td>N:M</td>
                        <td>Inferred high-potential HCPs</td>
                    </tr>
                </tbody>
            </table>

            <div class="diagram">
                <h3>Example Graph Structure</h3>
                <pre><code>
    (Patient:PAT123)
          ‚Üì TREATED_BY (is_primary_hcp: true)
    (HCP:12345 {specialty: "oncology"})
          ‚Üì PRESCRIBES (volume_monthly: 15)
    (Brand:kisqali {therapeutic_area: "oncology"})
          ‚Üë PRESCRIBED (prescription_date: "2026-01-13")
    (Patient:PAT123)

    (Agent:CausalImpactAgent)
          ‚Üì DISCOVERED (discovery_date: "2026-01-12")
    (CausalPath:CP789 {confidence: 0.82})
          ‚Üì IMPACTS (impact_magnitude: 0.15)
    (KPI:KPI001 {category: "ws3_business"})
                </code></pre>
            </div>

            <h3>5 Inference Rules (Automated Discovery)</h3>

            <div class="success-box">
                <h4>Inference rules automatically discover new relationships from existing data:</h4>
                <ol>
                    <li><strong>indirect_treatment</strong> (Daily): Infer HCP‚ÜíBrand from Patient‚ÜíHCP + Patient‚ÜíBrand</li>
                    <li><strong>causal_chain</strong> (Weekly): Transitive closure A‚ÜíB + B‚ÜíC ‚áí A‚á¢C</li>
                    <li><strong>hcp_influence_propagation</strong> (Weekly): High-influence HCP networks predict prescribing</li>
                    <li><strong>patient_journey_progression</strong> (Monthly): Calculate stage transition probabilities</li>
                    <li><strong>roi_opportunity_flagging</strong> (Weekly): Flag high-confidence paths with KPI gaps</li>
                </ol>
            </div>

            <h3>6 Validation Rules (Quality Assurance)</h3>

            <div class="warning-box">
                <h4>Validation rules enforce data integrity at runtime:</h4>
                <ol>
                    <li><strong>journey_stage_progression</strong> (Warning): Logical stage transitions only</li>
                    <li><strong>specialty_brand_alignment</strong> (Warning): Match HCP specialty to therapeutic area</li>
                    <li><strong>confidence_threshold</strong> (Strict): Minimum 0.50 for causal paths, ‚â•0.75 to proceed</li>
                    <li><strong>no_causal_cycles</strong> (Strict): Causal graph must be acyclic (DAG)</li>
                    <li><strong>trigger_expiration</strong> (Strict): Cannot act on expired triggers</li>
                    <li><strong>one_primary_hcp</strong> (Strict): Patient has max 1 primary provider</li>
                </ol>
            </div>
        </section>

        <!-- SECTION 3: LIFECYCLE -->
        <section id="lifecycle">
            <h2>‚ôªÔ∏è Ontology Lifecycle</h2>

            <p>The ontology evolves through four major phases:</p>

            <div class="timeline">
                <div class="timeline-item">
                    <div class="lifecycle-stage">
                        <h4>1Ô∏è‚É£ Design & Definition</h4>
                        <p><strong>Who</strong>: Data architects, domain experts, data scientists</p>
                        <p><strong>What</strong>: Define node types, edge types, properties, validation rules</p>
                        <p><strong>Output</strong>: YAML vocabulary modules (19 files)</p>
                        <p><strong>Timeline</strong>: 2-4 weeks for initial design; quarterly reviews</p>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="lifecycle-stage">
                        <h4>2Ô∏è‚É£ Implementation & Compilation</h4>
                        <p><strong>Who</strong>: Data engineers, infrastructure team</p>
                        <p><strong>What</strong>: Compile vocabulary to FalkorDB schema (constraints + indexes)</p>
                        <p><strong>Output</strong>: Schema DDL, validation config, inference scheduler</p>
                        <p><strong>Timeline</strong>: 1-2 days for compilation; 1 week for testing</p>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="lifecycle-stage">
                        <h4>3Ô∏è‚É£ Usage & Population</h4>
                        <p><strong>Who</strong>: Data ingestion pipelines, 18 E2I agents</p>
                        <p><strong>What</strong>: Create nodes/edges, validate data, run inference rules</p>
                        <p><strong>Output</strong>: Populated graph with millions of nodes/edges</p>
                        <p><strong>Timeline</strong>: Continuous (daily data ingestion)</p>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="lifecycle-stage">
                        <h4>4Ô∏è‚É£ Evolution & Maintenance</h4>
                        <p><strong>Who</strong>: Module maintainers, architecture board</p>
                        <p><strong>What</strong>: Add new entity types, update validation rules, version control</p>
                        <p><strong>Output</strong>: Updated vocabulary (minor/major versions)</p>
                        <p><strong>Timeline</strong>: Monthly for minor changes; quarterly for major changes</p>
                    </div>
                </div>
            </div>

            <h3>Instance vs. Schema Updates</h3>

            <div class="grid">
                <div class="card">
                    <h4>üîÑ Instance-Level (Automatic)</h4>
                    <p><strong>Frequency</strong>: Continuous (daily data loads)</p>
                    <p><strong>Examples</strong>:</p>
                    <ul>
                        <li>New patient enrolls</li>
                        <li>HCP prescribes brand</li>
                        <li>Inference rule discovers relationship</li>
                        <li>Agent generates trigger</li>
                    </ul>
                    <p><strong>Impact</strong>: Low (adds data, no schema change)</p>
                    <p><strong>Approval</strong>: None (automated)</p>
                </div>

                <div class="card">
                    <h4>üîß Schema-Level (Manual)</h4>
                    <p><strong>Frequency</strong>: Monthly/quarterly</p>
                    <p><strong>Examples</strong>:</p>
                    <ul>
                        <li>New brand launches</li>
                        <li>New node type added</li>
                        <li>New validation rule</li>
                        <li>New inference rule</li>
                    </ul>
                    <p><strong>Impact</strong>: High (changes structure)</p>
                    <p><strong>Approval</strong>: Architecture board (1-2 weeks)</p>
                </div>
            </div>

            <h3>Version Control</h3>

            <pre><code>_metadata:
  version: "6.0.0"  # MAJOR.MINOR.PATCH
  
  # MAJOR: Breaking changes (new node types, removed properties)
  # MINOR: New features (new properties, new enum values)
  # PATCH: Bug fixes (typos, documentation updates)
  
  changelog:
    - version: "6.0.0"
      date: "2026-01-12"
      changes:
        - "Initial modular release"
        - "18 YAML modules across 6 categories"
    
    - version: "6.1.0"
      date: "2026-01-15"
      changes:
        - "Added new brand: cosentyx"
        - "Updated Brand.brand_name enum"</code></pre>
        </section>

        <!-- SECTION 4: E2I INTEGRATION -->
        <section id="integration">
            <h2>ü§ñ Integration with E2I Causal Analytics</h2>

            <h3>18-Agent Architecture</h3>

            <p>The ontology is the <strong>central nervous system</strong> of E2I's 18-agent platform. Every agent reads from and writes to the semantic graph.</p>

            <div class="flow-diagram">
                <div class="flow-step">Data Sources<br>(IQVIA, Veeva)</div>
                <div class="flow-arrow">‚Üí</div>
                <div class="flow-step">Validate<br>(Vocabulary)</div>
                <div class="flow-arrow">‚Üí</div>
                <div class="flow-step">Create Nodes<br>(Patient, HCP)</div>
                <div class="flow-arrow">‚Üí</div>
                <div class="flow-step">Agents Analyze<br>(18 agents)</div>
                <div class="flow-arrow">‚Üí</div>
                <div class="flow-step">Generate<br>Insights</div>
            </div>

            <h3>Agent Tiers</h3>

            <div class="grid">
                <div class="card agent-card">
                    <h4><span class="badge badge-tier1">Tier 1</span> Causal Discovery (5 agents)</h4>
                    <ul>
                        <li>CausalImpactAgent</li>
                        <li>HeterogeneousOptimizerAgent</li>
                        <li>ExperimentDesigner</li>
                        <li>GapAnalyzer</li>
                        <li>StakeQualAgent</li>
                    </ul>
                    <p><strong>Ontology Use</strong>: Create CausalPath nodes, analyze Patient/HCP relationships</p>
                </div>

                <div class="card agent-card">
                    <h4><span class="badge badge-tier2">Tier 2</span> Validation (4 agents)</h4>
                    <ul>
                        <li>RefutationAgent</li>
                        <li>RegulatoryComplianceAgent</li>
                        <li>UnintendedConsequenceAgent</li>
                        <li>DataQualityAgent</li>
                    </ul>
                    <p><strong>Ontology Use</strong>: Update CausalPath.validation_status, enforce validation rules</p>
                </div>

                <div class="card agent-card">
                    <h4><span class="badge badge-tier3">Tier 3</span> Business Translation (4 agents)</h4>
                    <ul>
                        <li>ROICalculatorAgent</li>
                        <li>InsightTranslatorAgent</li>
                        <li>ActionGeneratorAgent</li>
                        <li>StakeholderCommunicatorAgent</li>
                    </ul>
                    <p><strong>Ontology Use</strong>: Create Trigger nodes, link CausalPath‚ÜíKPI</p>
                </div>

                <div class="card agent-card">
                    <h4><span class="badge badge-tier4">Tier 4</span> Digital Twin (2 agents)</h4>
                    <ul>
                        <li>DigitalTwinAgent</li>
                        <li>OutcomePredictorAgent</li>
                    </ul>
                    <p><strong>Ontology Use</strong>: Simulate Patient journey transitions, predict HCP behavior</p>
                </div>

                <div class="card agent-card">
                    <h4><span class="badge badge-tier5">Tier 5</span> Feedback Loop (2 agents)</h4>
                    <ul>
                        <li>OutcomeTruthLabelerAgent</li>
                        <li>ModelDriftDetectorAgent</li>
                    </ul>
                    <p><strong>Ontology Use</strong>: Label outcomes, detect drift in Patient/HCP populations</p>
                </div>

                <div class="card agent-card">
                    <h4><span class="badge badge-tier6">Tier 6</span> Self-Improvement (1 agent)</h4>
                    <ul>
                        <li>SelfCriticAgent</li>
                    </ul>
                    <p><strong>Ontology Use</strong>: Evaluate Agent performance, optimize based on graph metrics</p>
                </div>
            </div>

            <h3>Agent Workflow Example</h3>

            <div class="diagram">
                <h4>Causal Discovery ‚Üí Validation ‚Üí Action Generation</h4>
                <pre><code>1. CausalImpactAgent (Tier 1) discovers:
   "Increasing rep visit frequency ‚Üí 15% increase in HCP prescription volume"
   
   CREATE (cp:CausalPath {
       path_id: 'CP12345678',
       source_variable: 'rep_visit_frequency',
       target_variable: 'hcp_prescription_volume',
       effect_size: 0.15,
       confidence: 0.82,
       method_used: 'econml_dml',
       validation_status: 'pending'
   })
   
   CREATE (agent:CausalImpactAgent)-[:DISCOVERED]->(cp)

2. RefutationAgent (Tier 2) validates:
   Runs sensitivity tests (placebo treatment, random common cause)
   
   MATCH (cp:CausalPath {path_id: 'CP12345678'})
   SET cp.validation_status = 'validated',
       cp.gate_decision = 'proceed'  // confidence >= 0.75

3. ActionGeneratorAgent (Tier 3) generates trigger:
   
   CREATE (t:Trigger {
       trigger_id: 'TRG87654321',
       trigger_type: 'recommendation',
       priority: 'high',
       message: 'Increase rep visit frequency to HCP with ID 12345',
       status: 'pending'
   })
   
   MATCH (cp:CausalPath {path_id: 'CP12345678'}),
         (h:HCP {hcp_id: 'HCP12345'}),
         (t:Trigger {trigger_id: 'TRG87654321'})
   CREATE (cp)-[:IMPACTS]->(t)
   CREATE (h)-[:RECEIVED]->(t)

4. Rep receives trigger in mobile app ‚úÖ</code></pre>
            </div>

            <h3>Key Integration Points</h3>

            <table>
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>Ontology Role</th>
                        <th>Frequency</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Data Ingestion</strong></td>
                        <td>Validate all incoming data against node/edge schemas</td>
                        <td>Continuous (daily batches)</td>
                    </tr>
                    <tr>
                        <td><strong>Causal Discovery</strong></td>
                        <td>Create CausalPath nodes with confidence scores</td>
                        <td>Weekly (Tier 1 agents)</td>
                    </tr>
                    <tr>
                        <td><strong>Validation</strong></td>
                        <td>Update validation_status, enforce validation rules</td>
                        <td>Real-time (Tier 2 agents)</td>
                    </tr>
                    <tr>
                        <td><strong>Trigger Generation</strong></td>
                        <td>Create Trigger nodes linked to HCPs</td>
                        <td>Real-time (Tier 3 agents)</td>
                    </tr>
                    <tr>
                        <td><strong>Inference Rules</strong></td>
                        <td>Discover new relationships automatically</td>
                        <td>Daily/weekly/monthly (cron)</td>
                    </tr>
                    <tr>
                        <td><strong>Drift Detection</strong></td>
                        <td>Monitor Patient/HCP population shifts</td>
                        <td>Weekly (Tier 5 agents)</td>
                    </tr>
                    <tr>
                        <td><strong>Reporting</strong></td>
                        <td>Query graph for executive dashboards</td>
                        <td>Daily (scheduled reports)</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <!-- SECTION 5: EXAMPLES -->
        <section id="examples">
            <h2>üí° Real-World Examples</h2>

            <h3>Example 1: Patient Journey Tracking</h3>

            <div class="highlight-box">
                <h4>Scenario</h4>
                <p>Track a patient's journey from awareness to adherence for Remibrutinib (CSU treatment)</p>
            </div>

            <pre><code>// 1. Patient becomes aware (from marketing campaign)
CREATE (p:Patient {
    patient_id: 'PAT12345678',
    journey_stage: 'aware',
    region: 'northeast',
    age_group: 'adult',
    insurance_type: 'commercial',
    created_at: datetime()
})

// 2. Patient sees dermatologist
MATCH (p:Patient {patient_id: 'PAT12345678'}),
      (h:HCP {npi: '1234567890', specialty: 'dermatology'})
CREATE (p)-[:TREATED_BY {
    is_primary_hcp: true,
    visit_count: 1,
    relationship_status: 'active',
    first_visit_date: datetime()
}]->(h)

// Update journey stage
SET p.journey_stage = 'considering'

// 3. HCP prescribes Remibrutinib
MATCH (p:Patient {patient_id: 'PAT12345678'}),
      (b:Brand {brand_name: 'remibrutinib'})
CREATE (p)-[:PRESCRIBED {
    prescription_date: datetime(),
    is_first_line: true,
    line_of_therapy: 1,
    status: 'active'
}]->(b)

// Update journey stage
SET p.journey_stage = 'prescribed'

// 4. Patient fills prescription
SET p.journey_stage = 'first_fill'

// 5. Patient adheres for 90+ days
SET p.journey_stage = 'adherent'

// 6. Query patient journey
MATCH path = (p:Patient {patient_id: 'PAT12345678'})-[*]-(connected)
RETURN path</code></pre>

            <h3>Example 2: HCP Influence Network</h3>

            <div class="highlight-box">
                <h4>Scenario</h4>
                <p>Identify opinion leaders who influence other HCPs' prescribing behavior</p>
            </div>

            <pre><code>// 1. Model influence network
CREATE (h1:HCP {hcp_id: 'HCP11111111', npi: '1111111111', specialty: 'oncology'}),
       (h2:HCP {hcp_id: 'HCP22222222', npi: '2222222222', specialty: 'oncology'}),
       (h3:HCP {hcp_id: 'HCP33333333', npi: '3333333333', specialty: 'oncology'}),
       (h4:HCP {hcp_id: 'HCP44444444', npi: '4444444444', specialty: 'oncology'})

CREATE (h1)-[:INFLUENCES {influence_strength: 0.85, network_type: 'mentor'}]->(h2),
       (h1)-[:INFLUENCES {influence_strength: 0.78, network_type: 'peer'}]->(h3),
       (h2)-[:INFLUENCES {influence_strength: 0.72, network_type: 'colleague'}]->(h4)

// 2. h2 prescribes Kisqali
MATCH (h:HCP {hcp_id: 'HCP22222222'}),
      (b:Brand {brand_name: 'kisqali'})
CREATE (h)-[:PRESCRIBES {volume_monthly: 12, market_share: 0.35}]->(b)

// 3. Inference rule identifies h1 as high-potential
// (triggered automatically weekly)
MATCH (h1:HCP {hcp_id: 'HCP11111111'})-[i:INFLUENCES]->(h2:HCP)-[:PRESCRIBES]->(b:Brand)
WHERE i.influence_strength >= 0.70
  AND NOT EXISTS((h1)-[:PRESCRIBES]->(b))
CREATE (h1)-[:HIGH_POTENTIAL_PRESCRIBER {
    potential_score: 0.85,
    evidence: 'Influenced by 1 active prescriber',
    inferred: true,
    inference_date: datetime()
}]->(b)

// 4. ActionGeneratorAgent creates trigger for rep
MATCH (h1:HCP {hcp_id: 'HCP11111111'}),
      (b:Brand {brand_name: 'kisqali'})
CREATE (t:Trigger {
    trigger_id: 'TRG99887766',
    trigger_type: 'recommendation',
    priority: 'high',
    message: 'Target HCP11111111 (opinion leader) for Kisqali education',
    status: 'pending',
    expiration_date: datetime() + duration({days: 30})
})
CREATE (h1)-[:RECEIVED {delivery_date: datetime()}]->(t)</code></pre>

            <h3>Example 3: Causal Path to Action</h3>

            <div class="highlight-box">
                <h4>Scenario</h4>
                <p>Discover that sample provision increases script conversion by 23%</p>
            </div>

            <pre><code>// 1. CausalImpactAgent discovers relationship
CREATE (cp:CausalPath {
    path_id: 'CP88776655',
    source_variable: 'sample_provision',
    target_variable: 'script_conversion_rate',
    effect_size: 0.23,  // 23% increase
    confidence: 0.87,
    method_used: 'econml_dml',
    validation_status: 'validated',
    gate_decision: 'proceed',
    created_at: datetime()
})

// 2. Link to KPI
MATCH (cp:CausalPath {path_id: 'CP88776655'}),
      (kpi:KPI {kpi_id: 'KPI000042', category: 'ws3_business'})
CREATE (cp)-[:IMPACTS {
    impact_magnitude: 0.23,
    direction: 'positive'
}]->(kpi)

// 3. Provenance: Which agent discovered this?
MATCH (agent:Agent {agent_name: 'CausalImpactAgent'}),
      (cp:CausalPath {path_id: 'CP88776655'})
CREATE (agent)-[:DISCOVERED {discovery_date: datetime()}]->(cp)

// 4. ROICalculatorAgent calculates financial impact
// (Assuming 1000 HCPs, avg script value $5000)
// ROI = 1000 HCPs √ó 23% increase √ó $5000 = $1,150,000

// 5. ActionGeneratorAgent creates triggers for all HCPs
MATCH (h:HCP)-[:PRESCRIBES]->(b:Brand {brand_name: 'remibrutinib'})
WHERE NOT EXISTS((h)-[:RECEIVED]->(:Trigger {message: 'Provide samples...'}))
CREATE (t:Trigger {
    trigger_id: 'TRG_' + h.hcp_id,
    trigger_type: 'nba',
    priority: 'high',
    message: 'Provide samples to increase script conversion by 23%',
    status: 'pending',
    expiration_date: datetime() + duration({days: 14})
})
CREATE (h)-[:RECEIVED {delivery_date: datetime()}]->(t)
CREATE (agent:Agent {agent_name: 'ActionGeneratorAgent'})-[:GENERATED]->(t)</code></pre>

            <h3>Example 4: Drift Detection & Model Retraining</h3>

            <div class="highlight-box">
                <h4>Scenario</h4>
                <p>Detect that patient population has shifted significantly (data drift)</p>
            </div>

            <pre><code>// 1. ModelDriftDetectorAgent compares current vs. historical data
// PSI (Population Stability Index) calculation:
// Current: 60% young_adult, 30% adult, 10% senior
// Historical: 40% young_adult, 45% adult, 15% senior
// PSI = 0.28 (> 0.25 = significant shift)

// 2. Create drift alert
CREATE (alert:DriftAlert {
    alert_id: 'DRIFT_20260113',
    model_id: 'script_conversion_v2',
    drift_type: 'data_drift',
    detection_method: 'psi',
    drift_score: 0.28,
    severity: 'warning',  // > 0.25 threshold
    created_at: datetime()
})

// 3. Flag model for retraining
MATCH (model:Model {model_id: 'script_conversion_v2'})
SET model.status = 'needs_retraining',
    model.last_drift_check = datetime()

// 4. Link to affected patients
MATCH (p:Patient)
WHERE p.age_group = 'young_adult'
  AND p.created_at >= datetime() - duration({days: 30})
WITH count(p) AS recent_young_adults
CREATE (stat:DriftStatistic {
    metric: 'recent_young_adults',
    value: recent_young_adults,
    threshold: 'Expected < 50%, actual 60%'
})</code></pre>
        </section>

        <!-- SECTION 6: MAINTENANCE -->
        <section id="maintenance">
            <h2>üîß Maintenance & Best Practices</h2>

            <h3>Daily Operations</h3>
            <ul>
                <li>‚úÖ Monitor validation failure rates (should be < 0.1%)</li>
                <li>‚úÖ Check inference rule execution logs</li>
                <li>‚úÖ Review new Trigger generation (quality check)</li>
                <li>‚úÖ Track graph size and query performance</li>
            </ul>

            <h3>Weekly Tasks</h3>
            <ul>
                <li>‚úÖ Run all weekly inference rules</li>
                <li>‚úÖ Review drift detection alerts</li>
                <li>‚úÖ Audit new CausalPath nodes (confidence distribution)</li>
                <li>‚úÖ Check for orphaned nodes (no edges)</li>
            </ul>

            <h3>Monthly Tasks</h3>
            <ul>
                <li>‚úÖ Review vocabulary change requests</li>
                <li>‚úÖ Update validation rules based on data quality issues</li>
                <li>‚úÖ Run monthly inference rules (journey progression)</li>
                <li>‚úÖ Generate ontology health report</li>
            </ul>

            <h3>Quarterly Tasks</h3>
            <ul>
                <li>‚úÖ Architecture review for new entity types</li>
                <li>‚úÖ Update documentation</li>
                <li>‚úÖ Review and archive deprecated node types</li>
                <li>‚úÖ Performance optimization (indexes, query patterns)</li>
            </ul>

            <h3>Performance Monitoring</h3>

            <table>
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>Healthy Range</th>
                        <th>Alert Threshold</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Validation Failure Rate</td>
                        <td>&lt; 0.1%</td>
                        <td>&gt; 0.5%</td>
                    </tr>
                    <tr>
                        <td>Inference Rule Runtime</td>
                        <td>&lt; 5 minutes</td>
                        <td>&gt; 15 minutes</td>
                    </tr>
                    <tr>
                        <td>Query Response Time (p95)</td>
                        <td>&lt; 500ms</td>
                        <td>&gt; 2 seconds</td>
                    </tr>
                    <tr>
                        <td>Graph Size Growth</td>
                        <td>~2% per week</td>
                        <td>&gt; 10% per week</td>
                    </tr>
                    <tr>
                        <td>Orphaned Nodes</td>
                        <td>&lt; 1%</td>
                        <td>&gt; 5%</td>
                    </tr>
                </tbody>
            </table>

            <h3>Common Issues & Solutions</h3>

            <div class="grid">
                <div class="card">
                    <h4>‚ùå Issue: High Validation Failure Rate</h4>
                    <p><strong>Cause</strong>: Vocabulary out of sync with data sources</p>
                    <p><strong>Solution</strong>:</p>
                    <ol>
                        <li>Review top validation errors</li>
                        <li>Update vocabulary enums if needed</li>
                        <li>Add data quality checks upstream</li>
                    </ol>
                </div>

                <div class="card">
                    <h4>‚ùå Issue: Slow Inference Rules</h4>
                    <p><strong>Cause</strong>: Missing indexes or large transitive closures</p>
                    <p><strong>Solution</strong>:</p>
                    <ol>
                        <li>Profile Cypher query execution</li>
                        <li>Add indexes on frequently queried properties</li>
                        <li>Batch large inference operations</li>
                    </ol>
                </div>

                <div class="card">
                    <h4>‚ùå Issue: Orphaned Nodes</h4>
                    <p><strong>Cause</strong>: Incomplete data ingestion or edge creation failures</p>
                    <p><strong>Solution</strong>:</p>
                    <ol>
                        <li>Query for nodes with no edges</li>
                        <li>Investigate source data quality</li>
                        <li>Re-run relationship creation</li>
                    </ol>
                </div>

                <div class="card">
                    <h4>‚ùå Issue: Schema Version Mismatch</h4>
                    <p><strong>Cause</strong>: Agents using outdated vocabulary</p>
                    <p><strong>Solution</strong>:</p>
                    <ol>
                        <li>Check SchemaVersion node in graph</li>
                        <li>Update all agents to latest vocabulary</li>
                        <li>Run migration script if needed</li>
                    </ol>
                </div>
            </div>

            <h3>Best Practices Summary</h3>

            <div class="success-box">
                <h4>‚úÖ Do's</h4>
                <ul>
                    <li>Always validate data against vocabulary before creating nodes</li>
                    <li>Use inference rules for relationship discovery (don't hard-code)</li>
                    <li>Track provenance (which agent created what)</li>
                    <li>Version control all vocabulary changes</li>
                    <li>Test schema changes in staging first</li>
                    <li>Document all custom Cypher queries</li>
                    <li>Monitor graph health metrics continuously</li>
                </ul>
            </div>

            <div class="warning-box">
                <h4>‚ö†Ô∏è Don'ts</h4>
                <ul>
                    <li>Don't bypass validation (data quality will degrade)</li>
                    <li>Don't create nodes without setting required properties</li>
                    <li>Don't hardcode entity IDs in queries (use vocabulary)</li>
                    <li>Don't deploy schema changes without approval</li>
                    <li>Don't delete nodes without checking edge dependencies</li>
                    <li>Don't ignore validation warnings (they become errors later)</li>
                    <li>Don't let inference rules create cycles (breaks DAG property)</li>
                </ul>
            </div>
        </section>

        <!-- CONCLUSION -->
        <section>
            <h2>üéØ Key Takeaways</h2>

            <div class="grid">
                <div class="card">
                    <h4>1Ô∏è‚É£ Single Source of Truth</h4>
                    <p>The ontology defines how <strong>all</strong> E2I components model, validate, and reason about pharmaceutical data.</p>
                </div>

                <div class="card">
                    <h4>2Ô∏è‚É£ Self-Maintaining</h4>
                    <p>Daily operations are <strong>fully automated</strong> - data validated, relationships discovered, triggers generated.</p>
                </div>

                <div class="card">
                    <h4>3Ô∏è‚É£ Evolves with Business</h4>
                    <p>Schema changes follow <strong>governance</strong> process - new brands, entity types, rules added as needed.</p>
                </div>

                <div class="card">
                    <h4>4Ô∏è‚É£ Explainable AI</h4>
                    <p>Full <strong>provenance</strong> tracking - every insight traces back to source data and discovering agent.</p>
                </div>
            </div>

            <div class="highlight-box" style="margin-top: 30px;">
                <h3>üìö Additional Resources</h3>
                <ul>
                    <li><strong>Modular Implementation Guide</strong>: MODULAR_IMPLEMENTATION_GUIDE.md</li>
                    <li><strong>Ontology Update Guide</strong>: ONTOLOGY_UPDATE_GUIDE.md</li>
                    <li><strong>Module Index</strong>: domain_vocabulary_modular/index.yaml</li>
                    <li><strong>Python Loader</strong>: domain_vocabulary_modular/__init__.py</li>
                    <li><strong>Application Script</strong>: domain_vocabulary_modular/apply_vocabulary_to_ontology.py</li>
                </ul>
            </div>
        </section>
    </div>

    <footer>
        <div class="container">
            <p><strong>E2I Semantic Graph Ontology v6.0.0</strong></p>
            <p>Novartis Evidence-to-Impact Platform | Last Updated: January 12, 2026</p>
            <p>Maintainer: E2I Platform Team</p>
        </div>
    </footer>
</body>
</html>
