# =============================================================================
# E2I Supabase Self-Hosted Environment Configuration
# =============================================================================
# Copy this file to /opt/supabase/docker/.env and update with your values
#
# SECURITY: Never commit this file with real secrets to version control!
#
# Generate API keys at: https://supabase.com/docs/guides/self-hosting/docker#generate-api-keys
# =============================================================================

############
# SECRETS - CHANGE ALL OF THESE!
############

# PostgreSQL password (minimum 24 characters recommended)
POSTGRES_PASSWORD=your-super-secure-password-here-change-me

# JWT Secret for token signing (minimum 32 characters)
# Generate with: openssl rand -base64 48
JWT_SECRET=your-super-secret-jwt-token-with-at-least-32-characters-long

# API Keys - Generate at https://supabase.com/docs/guides/self-hosting/docker#generate-api-keys
# Use the JWT_SECRET above when generating these
ANON_KEY=your-anon-key-from-supabase-generator
SERVICE_ROLE_KEY=your-service-role-key-from-supabase-generator

# Dashboard credentials
DASHBOARD_USERNAME=supabase
DASHBOARD_PASSWORD=your-dashboard-password-here

############
# DATABASE
############

POSTGRES_HOST=db
POSTGRES_DB=postgres
POSTGRES_PORT=5432

# Connection pooling
POSTGRES_POOL_SIZE=20

############
# API PROXY (Kong)
############

KONG_HTTP_PORT=8000
KONG_HTTPS_PORT=8443

############
# POSTGREST
############

PGRST_DB_SCHEMAS=public,storage,graphql_public
PGRST_DB_EXTRA_SEARCH_PATH=public,extensions

############
# AUTH (GoTrue)
############

# Site configuration
SITE_URL=http://138.197.4.36
ADDITIONAL_REDIRECT_URLS=http://localhost:5174,http://localhost:3000

# API URL (external)
API_EXTERNAL_URL=http://138.197.4.36:8000

# JWT settings
JWT_EXPIRY=3600
JWT_DEFAULT_GROUP_NAME=authenticated

# Signup settings
DISABLE_SIGNUP=false
ENABLE_EMAIL_SIGNUP=true
ENABLE_EMAIL_AUTOCONFIRM=true

# Password requirements
PASSWORD_MIN_LENGTH=8

# Rate limiting
RATE_LIMIT_EMAIL_SENT=100
RATE_LIMIT_TOKEN_REFRESH=360

# SMTP Configuration (optional - for email auth)
GOTRUE_SMTP_HOST=
GOTRUE_SMTP_PORT=587
GOTRUE_SMTP_USER=
GOTRUE_SMTP_PASS=
GOTRUE_SMTP_SENDER_NAME=E2I Analytics
GOTRUE_SMTP_ADMIN_EMAIL=admin@example.com

# OAuth Providers (optional)
# GOTRUE_EXTERNAL_GOOGLE_ENABLED=false
# GOTRUE_EXTERNAL_GOOGLE_CLIENT_ID=
# GOTRUE_EXTERNAL_GOOGLE_SECRET=

############
# STUDIO
############

STUDIO_DEFAULT_ORGANIZATION=E2I Causal Analytics
STUDIO_DEFAULT_PROJECT=E2I Production
STUDIO_PORT=3000
SUPABASE_PUBLIC_URL=http://138.197.4.36:8000

############
# STORAGE
############

STORAGE_BACKEND=file

# S3-compatible storage (optional - for DigitalOcean Spaces)
# STORAGE_BACKEND=s3
# STORAGE_S3_BUCKET=
# STORAGE_S3_ENDPOINT=
# STORAGE_S3_REGION=nyc3
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=

# File upload limits
FILE_SIZE_LIMIT=52428800  # 50MB
FILE_STORAGE_BACKEND_PATH=/var/lib/storage

############
# REALTIME
############

REALTIME_IP_VERSION=IPv4
ENABLE_REALTIME_BROADCAST=true
ENABLE_REALTIME_PRESENCE=true

############
# ANALYTICS (optional - disable to save resources)
############

ENABLE_ANALYTICS=false
LOGFLARE_LOGGER_BACKEND_API_KEY=
LOGFLARE_API_KEY=

############
# FUNCTIONS (Edge Functions - optional)
############

FUNCTIONS_VERIFY_JWT=false

############
# IMGPROXY (optional - for image transformations)
############

IMGPROXY_ENABLE_WEBP_DETECTION=true

############
# FEATURE FLAGS
############

ENABLE_PHONE_SIGNUP=false
ENABLE_PHONE_AUTOCONFIRM=false

############
# LOGGING
############

LOG_LEVEL=info
# Set to debug for troubleshooting
# LOG_LEVEL=debug

############
# E2I INTEGRATION
############

# These values should match your E2I .env file
E2I_API_URL=http://fastapi:8000
E2I_FRONTEND_URL=http://frontend:5174

# Network configuration
DOCKER_SOCKET_LOCATION=/var/run/docker.sock
