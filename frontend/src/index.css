@import "tailwindcss";

/* ============================================
   E2I Causal Analytics - Base Styles
   ============================================ */

/* CSS Custom Properties for theming */
:root {
  /* Typography */
  --font-sans: Inter, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont,
    "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  --font-mono: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas,
    "Liberation Mono", monospace;

  /* Spacing scale */
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
  --spacing-lg: 1.5rem;
  --spacing-xl: 2rem;
  --spacing-2xl: 3rem;

  /* Border radius */
  --radius-sm: 0.25rem;
  --radius-md: 0.375rem;
  --radius-lg: 0.5rem;
  --radius-xl: 0.75rem;
  --radius-full: 9999px;

  /* Transitions */
  --transition-fast: 150ms ease-in-out;
  --transition-normal: 200ms ease-in-out;
  --transition-slow: 300ms ease-in-out;

  /* Light theme colors */
  --color-background: #ffffff;
  --color-foreground: #0f172a;
  --color-muted: #64748b;
  --color-muted-foreground: #94a3b8;
  --color-border: #e2e8f0;
  --color-input: #e2e8f0;
  --color-ring: #3b82f6;

  /* Primary colors */
  --color-primary: #3b82f6;
  --color-primary-foreground: #ffffff;
  --color-primary-hover: #2563eb;

  /* Secondary colors */
  --color-secondary: #f1f5f9;
  --color-secondary-foreground: #0f172a;
  --color-secondary-hover: #e2e8f0;

  /* Accent colors */
  --color-accent: #f1f5f9;
  --color-accent-foreground: #0f172a;

  /* Destructive colors */
  --color-destructive: #ef4444;
  --color-destructive-foreground: #ffffff;

  /* Success colors */
  --color-success: #22c55e;
  --color-success-foreground: #ffffff;

  /* Warning colors */
  --color-warning: #f59e0b;
  --color-warning-foreground: #ffffff;

  /* Card styles */
  --color-card: #ffffff;
  --color-card-foreground: #0f172a;

  /* Popover styles */
  --color-popover: #ffffff;
  --color-popover-foreground: #0f172a;

  /* Sidebar colors */
  --color-sidebar: #f8fafc;
  --color-sidebar-foreground: #334155;
  --color-sidebar-hover: #f1f5f9;

  /* Chart colors for data visualization */
  --color-chart-1: #3b82f6;
  --color-chart-2: #22c55e;
  --color-chart-3: #f59e0b;
  --color-chart-4: #ef4444;
  --color-chart-5: #8b5cf6;
  --color-chart-6: #06b6d4;

  /* Shadow values */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);

  /* Base styling */
  color-scheme: light;
  font-family: var(--font-sans);
  line-height: 1.5;
  font-weight: 400;
  color: var(--color-foreground);
  background-color: var(--color-background);

  /* Font rendering */
  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Dark theme */
@media (prefers-color-scheme: dark) {
  :root {
    color-scheme: dark;

    /* Dark theme colors */
    --color-background: #0f172a;
    --color-foreground: #f8fafc;
    --color-muted: #475569;
    --color-muted-foreground: #94a3b8;
    --color-border: #334155;
    --color-input: #334155;
    --color-ring: #3b82f6;

    /* Primary colors (adjusted for dark) */
    --color-primary: #60a5fa;
    --color-primary-foreground: #0f172a;
    --color-primary-hover: #3b82f6;

    /* Secondary colors */
    --color-secondary: #1e293b;
    --color-secondary-foreground: #f8fafc;
    --color-secondary-hover: #334155;

    /* Accent colors */
    --color-accent: #1e293b;
    --color-accent-foreground: #f8fafc;

    /* Card styles */
    --color-card: #1e293b;
    --color-card-foreground: #f8fafc;

    /* Popover styles */
    --color-popover: #1e293b;
    --color-popover-foreground: #f8fafc;

    /* Sidebar colors */
    --color-sidebar: #1e293b;
    --color-sidebar-foreground: #cbd5e1;
    --color-sidebar-hover: #334155;

    /* Shadow values (darker for dark mode) */
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.4), 0 2px 4px -2px rgb(0 0 0 / 0.3);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.4), 0 4px 6px -4px rgb(0 0 0 / 0.3);
  }
}

/* ============================================
   Base Element Styles
   ============================================ */

html {
  scroll-behavior: smooth;
}

body {
  margin: 0;
  min-height: 100vh;
  min-width: 320px;
  background-color: var(--color-background);
  color: var(--color-foreground);
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
  font-weight: 600;
  line-height: 1.25;
  color: var(--color-foreground);
}

h1 { font-size: 2.25rem; }
h2 { font-size: 1.875rem; }
h3 { font-size: 1.5rem; }
h4 { font-size: 1.25rem; }
h5 { font-size: 1.125rem; }
h6 { font-size: 1rem; }

p {
  line-height: 1.625;
  color: var(--color-foreground);
}

/* Links */
a {
  color: var(--color-primary);
  text-decoration: none;
  transition: color var(--transition-fast);
}

a:hover {
  color: var(--color-primary-hover);
}

a:focus-visible {
  outline: 2px solid var(--color-ring);
  outline-offset: 2px;
  border-radius: var(--radius-sm);
}

/* ============================================
   Form Elements
   ============================================ */

button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-sm);
  border-radius: var(--radius-md);
  border: 1px solid transparent;
  padding: var(--spacing-sm) var(--spacing-md);
  font-size: 0.875rem;
  font-weight: 500;
  font-family: inherit;
  background-color: var(--color-primary);
  color: var(--color-primary-foreground);
  cursor: pointer;
  transition: background-color var(--transition-fast),
              border-color var(--transition-fast),
              box-shadow var(--transition-fast);
}

button:hover:not(:disabled) {
  background-color: var(--color-primary-hover);
}

button:focus-visible {
  outline: 2px solid var(--color-ring);
  outline-offset: 2px;
}

button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

input, textarea, select {
  display: block;
  width: 100%;
  border-radius: var(--radius-md);
  border: 1px solid var(--color-border);
  padding: var(--spacing-sm) var(--spacing-md);
  font-size: 0.875rem;
  font-family: inherit;
  background-color: var(--color-background);
  color: var(--color-foreground);
  transition: border-color var(--transition-fast),
              box-shadow var(--transition-fast);
}

input:focus, textarea:focus, select:focus {
  outline: none;
  border-color: var(--color-ring);
  box-shadow: 0 0 0 3px rgb(59 130 246 / 0.1);
}

input::placeholder, textarea::placeholder {
  color: var(--color-muted-foreground);
}

/* ============================================
   Utility Classes
   ============================================ */

/* Scrollbar styling */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--color-secondary);
  border-radius: var(--radius-full);
}

::-webkit-scrollbar-thumb {
  background: var(--color-muted);
  border-radius: var(--radius-full);
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-muted-foreground);
}

/* Selection styling */
::selection {
  background-color: var(--color-primary);
  color: var(--color-primary-foreground);
}

/* Focus ring for accessibility */
.focus-ring:focus-visible {
  outline: 2px solid var(--color-ring);
  outline-offset: 2px;
}

/* Screen reader only */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* ============================================
   App Container Styles
   ============================================ */

#root {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

/* ============================================
   CopilotKit Streaming Fixes
   ============================================ */

/* FIX: Hide action bars on all but the last message during streaming
   This prevents multiple action button bars from appearing during streaming.
   The root cause is in backend streaming state management, but this CSS
   provides immediate visual relief while streaming is in progress. */
.copilotKitChat .copilotKitAssistantMessage:not(:last-of-type) .copilotKitMessageControls {
  display: none !important;
}

/* Also hide any duplicate toolbar containers that may appear */
.copilotKitChat .copilotKitAssistantMessage:not(:last-of-type) [class*="ActionToolbar"] {
  display: none !important;
}

/* ============================================
   CopilotKit Scroll Container Fixes
   ============================================ */

/* FIX: Enable proper scrolling within CopilotChat component
   The CopilotChat component uses flexbox internally, so we need to ensure
   the messages container can scroll independently. min-height: 0 is critical
   for flex children that need to scroll. */
.copilotKitChat {
  height: 100%;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

/* Target the messages container inside CopilotKit */
.copilotKitChat > div {
  flex: 1;
  overflow-y: auto;
  min-height: 0;
}

/* Ensure message list scrolls properly */
.copilotKitChat [class*="Messages"],
.copilotKitChat [class*="messages"] {
  flex: 1;
  overflow-y: auto;
  min-height: 0;
}

/* Ensure visible scrollbar in the chat area */
.copilotKitChat::-webkit-scrollbar,
.copilotKitChat > div::-webkit-scrollbar {
  width: 8px;
}

.copilotKitChat::-webkit-scrollbar-track,
.copilotKitChat > div::-webkit-scrollbar-track {
  background: var(--color-secondary);
  border-radius: var(--radius-full);
}

.copilotKitChat::-webkit-scrollbar-thumb,
.copilotKitChat > div::-webkit-scrollbar-thumb {
  background: var(--color-muted);
  border-radius: var(--radius-full);
}

.copilotKitChat::-webkit-scrollbar-thumb:hover,
.copilotKitChat > div::-webkit-scrollbar-thumb:hover {
  background: var(--color-muted-foreground);
}
