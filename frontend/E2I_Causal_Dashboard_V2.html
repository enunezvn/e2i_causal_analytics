<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E2I Causal Analytics Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .dashboard-container {
            max-width: 1800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        
        h1 {
            color: #2d3748;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #718096;
            font-size: 1.2em;
        }
        
        .workstream-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .tab-button {
            padding: 12px 24px;
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1em;
            font-weight: 600;
            color: #4a5568;
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .tab-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .workstream-content {
            display: none;
        }
        
        .workstream-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: all 0.3s;
        }
        
        .metric-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .metric-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #2d3748;
        }
        
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .metric-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }
        
        .status-green { background: #c6f6d5; color: #22543d; }
        .status-yellow { background: #feebc8; color: #7c2d12; }
        .status-red { background: #fed7d7; color: #742a2a; }
        
        .metric-chart {
            margin-top: 15px;
            height: 200px;
        }
        
        .causal-insight {
            background: linear-gradient(135deg, #f6f9fc 0%, #e9f3ff 100%);
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-top: 15px;
            border-radius: 8px;
        }
        
        .causal-insight-title {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .causal-insight-title::before {
            content: "‚ö°";
            font-size: 1.2em;
        }
        
        .causal-insight-text {
            color: #2d3748;
            line-height: 1.6;
        }
        
        .causal-effect {
            font-weight: bold;
            color: #667eea;
        }
        
        .visualization-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .viz-title {
            font-size: 1.4em;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .causal-dag {
            height: 400px;
            background: #f7fafc;
            border-radius: 10px;
            padding: 20px;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-radius: 15px;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #718096;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .filter-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            padding: 15px;
            background: #f7fafc;
            border-radius: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .filter-label {
            font-weight: 600;
            color: #4a5568;
            font-size: 0.95em;
        }
        
        select, input[type="date"] {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            background: white;
            color: #2d3748;
            font-size: 0.95em;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        select:hover, input[type="date"]:hover {
            border-color: #667eea;
        }
        
        select:focus, input[type="date"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .refresh-button {
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            margin-left: auto;
        }
        
        .refresh-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .alert-banner {
            background: linear-gradient(135deg, #feb2b2 0%, #fc8181 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
            animation: slideDown 0.5s;
        }
        
        .alert-banner.show {
            display: block;
        }
        
        @keyframes slideDown {
            from { transform: translateY(-20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }


        /* Agent Insights Specific Styles */
        .agent-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            border-left: 5px solid #667eea;
        }
        
        .agent-card.critical {
            border-left-color: #fc8181;
            background: linear-gradient(135deg, #fff 0%, #fff5f5 100%);
        }
        
        .agent-card.opportunity {
            border-left-color: #48bb78;
            background: linear-gradient(135deg, #fff 0%, #f0fff4 100%);
        }
        
        .agent-card.predictive {
            border-left-color: #f6ad55;
            background: linear-gradient(135deg, #fff 0%, #fffdf7 100%);
        }
        
        .agent-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .agent-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
        }
        
        .agent-icon.impact { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .agent-icon.gap { background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); }
        .agent-icon.drift { background: linear-gradient(135deg, #f6ad55 0%, #ed8936 100%); }
        .agent-icon.experiment { background: linear-gradient(135deg, #4ecdc4 0%, #44a8a0 100%); }
        
        .agent-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #2d3748;
        }
        
        .agent-subtitle {
            font-size: 0.9em;
            color: #718096;
        }
        
        .insight-content {
            margin-top: 15px;
            line-height: 1.6;
            color: #4a5568;
        }
        
        .action-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 12px;
            background: #f7fafc;
            border-radius: 8px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }
        
        .action-item:hover {
            background: #edf2f7;
            transform: translateX(5px);
        }
        
        .action-priority {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .priority-high { background: #fed7d7; color: #742a2a; }
        .priority-medium { background: #feebc8; color: #7c2d12; }
        .priority-low { background: #c6f6d5; color: #22543d; }
        
        .roi-badge {
            display: inline-block;
            padding: 4px 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .prediction-timeline {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .timeline-item {
            flex: 1;
            text-align: center;
        }
        
        .timeline-date {
            font-size: 0.9em;
            color: #718096;
            margin-bottom: 5px;
        }
        
        .timeline-value {
            font-size: 1.2em;
            font-weight: bold;
            color: #2d3748;
        }
        
        .confidence-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 10px;
            background: #f7fafc;
            border-radius: 6px;
            font-size: 0.85em;
        }
        
        .confidence-high { color: #22543d; }
        .confidence-medium { color: #7c2d12; }
        .confidence-low { color: #718096; }
        
        .experiment-card {
            background: linear-gradient(135deg, #f6f9fc 0%, #e9f3ff 100%);
            border: 2px solid #667eea;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }
        
        .experiment-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .experiment-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
            background: white;
        }
        
        .status-proposed { color: #667eea; }
        .status-active { color: #48bb78; }
        .status-completed { color: #718096; }
        
        .causal-chain {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: white;
            border-radius: 10px;
            margin-bottom: 15px;
            overflow-x: auto;
        }
        
        .chain-node {
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            white-space: nowrap;
        }
        
        .chain-arrow {
            color: #cbd5e0;
            font-size: 1.5em;
        }
        
        .chain-effect {
            color: #48bb78;
            font-weight: bold;
            font-size: 0.85em;
        }
        
        /* Legend styles */
        .legend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-top: 20px;
        }
        
        .legend-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .legend-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px;
            background: #f7fafc;
            border-radius: 8px;
        }
        
        .legend-color {
            width: 40px;
            height: 30px;
            border-radius: 6px;
            margin-right: 15px;
        }
        
        .legend-description {
            flex: 1;
        }
        
        .legend-label {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 4px;
        }
        
        .legend-criteria {
            font-size: 0.9em;
            color: #718096;
        }
        
        /* KPI Dictionary styles */
        .kpi-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }
        
        .kpi-section-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .kpi-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .kpi-table th {
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #2d3748;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .kpi-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #e2e8f0;
            color: #4a5568;
        }
        
        .kpi-table tr:hover {
            background: #f7fafc;
        }
        
        .formula-text {
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            background: #f7fafc;
            padding: 2px 6px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="header">
            <h1>E2I Causal Analytics Dashboard</h1>
            <div class="subtitle">AI Agent Insights - Real-time Intelligence</div>
        </div>
        
        <div class="alert-banner" id="alertBanner">
            ‚ö†Ô∏è Critical Alert: Feature Drift PSI exceeds threshold (0.28 > 0.25) - Causal analysis indicates data source changes as primary driver
        </div>
        
        <div class="filter-controls">
            <div class="filter-group">
                <label class="filter-label">Date Range:</label>
                <input type="date" id="startDate" value="2025-09-01">
                <span>to</span>
                <input type="date" id="endDate" value="2025-09-28">
            </div>
            <div class="filter-group">
                <label class="filter-label">Brand:</label>
                <select id="brandFilter">
                    <option value="all">All Brands</option>
                    <option value="remi">Remibrutinib</option>
                    <option value="fabhalta">Fabhalta</option>
                    <option value="kisqali">Kisqali</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="filter-label">Region:</label>
                <select id="regionFilter">
                    <option value="all">All Regions</option>
                    <option value="northeast">Northeast</option>
                    <option value="south">South</option>
                    <option value="midwest">Midwest</option>
                    <option value="west">West</option>
                </select>
            </div>
            <button class="refresh-button" onclick="refreshDashboard()">üîÑ Refresh</button>
        </div>
        
        <div class="workstream-tabs">
            <button class="tab-button active" onclick="switchTab('agent-insights')">ü§ñ AI Agent Insights</button>
            <button class="tab-button active" onclick="switchTab('overview')">üìä Overview</button>
            <button class="tab-button" onclick="switchTab('ws1-data')">üóÉÔ∏è WS1: Data Quality</button>
            <button class="tab-button" onclick="switchTab('ws1-ml')">ü§ñ WS1: ML & Model</button>
            <button class="tab-button" onclick="switchTab('ws2')">üéØ WS2: Triggers</button>
            <button class="tab-button" onclick="switchTab('ws3')">üìà WS3: Impact</button>
            <button class="tab-button" onclick="switchTab('causal')">‚ö° Causal Analysis</button>
            <button class="tab-button" onclick="switchTab('kpi-dictionary')">üìñ KPI Dictionary</button>
            <button class="tab-button" onclick="switchTab('legend')">üè∑Ô∏è Status Legend</button>
            <button class="tab-button" onclick="switchTab('methodology')">üìö Agentic Methodology</button>
        </div>

        <!-- AI Agent Insights Tab -->
        <div id="agent-insights" class="workstream-content active">
            <!-- Executive AI Brief -->
            <div class="agent-card">
                <div class="agent-header">
                    <div class="agent-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">üéØ</div>
                    <div>
                        <div class="agent-title">Executive AI Brief</div>
                        <div class="agent-subtitle">Orchestrator Agent ‚Ä¢ Real-time synthesis at 09:47 AM</div>
                    </div>
                </div>
                <div class="insight-content">
                    <p><strong>Executive Summary:</strong> The multi-agent system has completed 47 analysis cycles in the last 24 hours, identifying three convergent opportunities with exceptional ROI profiles.</p>
                    <br>
                    <p>1. <strong>System Intelligence Status:</strong> 8/8 agents active, 142 causal paths analyzed, $23.7M value identified, 91% confidence level.</p>
                    <br>
                    <p>2. <strong>Critical Finding:</strong> User experience interventions offer 3x higher returns than data acquisition, contrary to initial hypotheses.</p>
                    <br>
                    <p>3. <strong>Automated Actions:</strong> System has initiated 4 corrective actions and queued 3 high-confidence experiments for validation.</p>
                </div>
            </div>
            
            <!-- Priority Actions with ROI -->
            <div class="agent-card opportunity">
                <div class="agent-header">
                    <div class="agent-icon gap">üìà</div>
                    <div>
                        <div class="agent-title">Priority Actions by ROI</div>
                        <div class="agent-subtitle">Gap Analyzer Agent ‚Ä¢ Impact-weighted recommendations</div>
                    </div>
                </div>
                <div class="insight-content">
                    <div class="action-item">
                        <span class="action-priority priority-high">HIGH</span>
                        <div style="flex: 1;">
                            <strong>Deploy Enhanced SHAP Explanations</strong>
                            <span class="roi-badge">ROI: 8.2x</span>
                            <br>
                            <span style="color: #718096; font-size: 0.9em;">
                                Implement top-5 feature visualization in trigger UI. Expected: +25% acceptance rate ‚Üí +14.5pp action rate ‚Üí $10.5M annual value. Implementation: 2 weeks.
                            </span>
                        </div>
                    </div>
                    
                    <div class="action-item">
                        <span class="action-priority priority-high">HIGH</span>
                        <div style="flex: 1;">
                            <strong>South Region Data Acquisition</strong>
                            <span class="roi-badge">ROI: 6.4x</span>
                            <br>
                            <span style="color: #718096; font-size: 0.9em;">
                                Partner with 3 regional health systems. Expected: +18% coverage ‚Üí -8pp fairness gap ‚Üí $8M captured value. Timeline: 4-6 weeks.
                            </span>
                        </div>
                    </div>
                    
                    <div class="action-item">
                        <span class="action-priority priority-medium">MEDIUM</span>
                        <div style="flex: 1;">
                            <strong>Implement Monthly Model Retraining</strong>
                            <span class="roi-badge">ROI: 4.1x</span>
                            <br>
                            <span style="color: #718096; font-size: 0.9em;">
                                PSI trending toward threshold (0.18‚Üí0.25). Automated monthly retraining prevents -0.05 AUC degradation worth $5M. Cost: $1.2M annually.
                            </span>
                        </div>
                    </div>
                    
                    <div class="action-item">
                        <span class="action-priority priority-low">LOW</span>
                        <div style="flex: 1;">
                            <strong>Optimize 4th Data Source Integration</strong>
                            <span class="roi-badge">ROI: 1.3x</span>
                            <br>
                            <span style="color: #718096; font-size: 0.9em;">
                                Current 3% marginal gain below cost threshold. Recommend redirecting resources to cross-source matching improvement instead.
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Causal Chain Analysis -->
            <div class="agent-card">
                <div class="agent-header">
                    <div class="agent-icon impact">‚ö°</div>
                    <div>
                        <div class="agent-title">Active Causal Chains</div>
                        <div class="agent-subtitle">Causal Impact Agent ‚Ä¢ Live propagation tracking</div>
                    </div>
                </div>
                <div class="insight-content">
                    <div class="causal-chain">
                        <div class="chain-node">Data Lag 12d</div>
                        <div class="chain-arrow">‚Üí</div>
                        <div class="chain-effect">+0.04 AUC</div>
                        <div class="chain-arrow">‚Üí</div>
                        <div class="chain-node">Model: 0.82</div>
                        <div class="chain-arrow">‚Üí</div>
                        <div class="chain-effect">+20pp</div>
                        <div class="chain-arrow">‚Üí</div>
                        <div class="chain-node">Precision: 42%</div>
                        <div class="chain-arrow">‚Üí</div>
                        <div class="chain-effect">+12pp</div>
                        <div class="chain-arrow">‚Üí</div>
                        <div class="chain-node">Action Rate ‚Üë</div>
                    </div>
                    
                    <div class="causal-chain">
                        <div class="chain-node">South Gap 18pp</div>
                        <div class="chain-arrow">‚Üí</div>
                        <div class="chain-effect">-8pp fairness</div>
                        <div class="chain-arrow">‚Üí</div>
                        <div class="chain-node">Trust ‚Üì15%</div>
                        <div class="chain-arrow">‚Üí</div>
                        <div class="chain-effect">-6pp accept</div>
                        <div class="chain-arrow">‚Üí</div>
                        <div class="chain-node">Impact -$8M</div>
                    </div>
                    
                    <p style="margin-top: 15px; padding: 10px; background: #f7fafc; border-radius: 8px;">
                        <strong>Multiplier Discovery:</strong> Cross-source match rate has hidden leverage‚Äîeach 1% improvement causes 1.8% journey tracking improvement via completeness mediation. Currently underexploited.
                    </p>
                </div>
            </div>
            
            <!-- Predictive Alerts -->
            <div class="agent-card predictive">
                <div class="agent-header">
                    <div class="agent-icon drift">‚ö†Ô∏è</div>
                    <div>
                        <div class="agent-title">Predictive Alerts</div>
                        <div class="agent-subtitle">Drift Monitor Agent ‚Ä¢ 7-day forecast</div>
                    </div>
                </div>
                <div class="insight-content">
                    <div style="background: #fff5f5; padding: 15px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #fc8181;">
                        <strong style="color: #742a2a;">üî¥ Critical: Feature Drift Acceleration Detected</strong><br>
                        <span style="color: #4a5568;">PSI will exceed threshold (0.25) in 9 days at current rate. Root cause: Seasonal pattern (0.15 baseline) + data source format change (+0.10). Action: Schedule emergency retraining for Oct 17.</span>
                        <div class="confidence-indicator confidence-high" style="margin-top: 10px;">
                            Confidence: 92% (based on 6-week trend)
                        </div>
                    </div>
                    
                    <div style="background: #fffdf7; padding: 15px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #f6ad55;">
                        <strong style="color: #7c2d12;">üü° Warning: Trigger Precision Decline Projected</strong><br>
                        <span style="color: #4a5568;">Expect 3pp precision drop (42%‚Üí39%) by end of month due to label quality degradation (Œ∫: 0.72‚Üí0.68). Preventive action: Label quality workshop scheduled Oct 12.</span>
                        <div class="confidence-indicator confidence-medium" style="margin-top: 10px;">
                            Confidence: 78% (heterogeneous effects detected)
                        </div>
                    </div>
                    
                    <div class="prediction-timeline">
                        <div class="timeline-item">
                            <div class="timeline-date">Today</div>
                            <div class="timeline-value">PSI: 0.18</div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-date">Oct 15</div>
                            <div class="timeline-value" style="color: #f6ad55;">PSI: 0.22</div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-date">Oct 17</div>
                            <div class="timeline-value" style="color: #fc8181;">PSI: 0.26 ‚ö†Ô∏è</div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-date">Post-Retrain</div>
                            <div class="timeline-value" style="color: #48bb78;">PSI: 0.08 ‚úì</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Experiment Recommendations -->
            <div class="agent-card">
                <div class="agent-header">
                    <div class="agent-icon experiment">üß™</div>
                    <div>
                        <div class="agent-title">Causal Experiment Queue</div>
                        <div class="agent-subtitle">Experiment Designer Agent ‚Ä¢ A/B test recommendations</div>
                    </div>
                </div>
                <div class="insight-content">
                    <div class="experiment-card">
                        <div class="experiment-header">
                            <strong>Contextual Explanation Depth</strong>
                            <span class="experiment-status status-proposed">PROPOSED</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <strong style="color: #667eea;">Treatment:</strong><br>
                                Show top-5 SHAP features with patient context<br>
                                <strong style="color: #667eea;">Control:</strong><br>
                                Current confidence scores only
                            </div>
                            <div>
                                <strong style="color: #667eea;">Expected Lift:</strong> +25% acceptance<br>
                                <strong style="color: #667eea;">Sample Size:</strong> 500 HCPs<br>
                                <strong style="color: #667eea;">Duration:</strong> 2 weeks<br>
                                <strong style="color: #667eea;">Power:</strong> 85% to detect 5pp difference
                            </div>
                        </div>
                    </div>
                    
                    <div class="experiment-card">
                        <div class="experiment-header">
                            <strong>Proactive vs Reactive Alerts</strong>
                            <span class="experiment-status status-active">ACTIVE - Day 4/14</span>
                        </div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <strong style="color: #667eea;">Treatment:</strong><br>
                                Predictive alerts 14 days before event<br>
                                <strong style="color: #667eea;">Control:</strong><br>
                                Standard reactive triggers
                            </div>
                            <div>
                                <strong style="color: #48bb78;">Interim Results:</strong><br>
                                Treatment: 61% action rate (+9pp)<br>
                                Control: 52% action rate<br>
                                <strong style="color: #48bb78;">Significance:</strong> p=0.03
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Segment-Specific Optimizations -->
            <div class="agent-card">
                <div class="agent-header">
                    <div class="agent-icon" style="background: linear-gradient(135deg, #9F7AEA 0%, #667eea 100%);">üé®</div>
                    <div>
                        <div class="agent-title">Heterogeneous Treatment Effects</div>
                        <div class="agent-subtitle">Heterogeneous Optimizer Agent ‚Ä¢ Personalization insights</div>
                    </div>
                </div>
                <div class="insight-content">
                    <div id="heterogeneousHeatmap"></div>
                    
                    <div style="margin-top: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                        <div style="padding: 15px; background: #f7fafc; border-radius: 10px;">
                            <strong>üè• Specialists Segment</strong><br>
                            <span style="color: #667eea; font-size: 1.2em; font-weight: bold;">+22pp avg uplift</span><br>
                            <span style="color: #718096; font-size: 0.9em;">High variance (15-28pp). Recommend personalized thresholds. Oncologists respond 2x better to genomic insights.</span>
                        </div>
                        
                        <div style="padding: 15px; background: #f7fafc; border-radius: 10px;">
                            <strong>üë®‚Äç‚öïÔ∏è PCPs Segment</strong><br>
                            <span style="color: #667eea; font-size: 1.2em; font-weight: bold;">+7pp avg uplift</span><br>
                            <span style="color: #718096; font-size: 0.9em;">Consistent but lower response. Need simplified explanations. Focus on time-saving aspects.</span>
                        </div>
                        
                        <div style="padding: 15px; background: #f7fafc; border-radius: 10px;">
                            <strong>üìä High Volume HCPs</strong><br>
                            <span style="color: #667eea; font-size: 1.2em; font-weight: bold;">+28pp avg uplift</span><br>
                            <span style="color: #718096; font-size: 0.9em;">Best ROI segment. Prioritize resource allocation here. Enable batch processing features.</span>
                        </div>
                        
                        <div style="padding: 15px; background: #fff5f5; border-radius: 10px;">
                            <strong>üåç Rural Practitioners</strong><br>
                            <span style="color: #fc8181; font-size: 1.2em; font-weight: bold;">+3pp avg uplift</span><br>
                            <span style="color: #718096; font-size: 0.9em;">Underperforming due to data gaps. Fix South region coverage to unlock +15pp potential.</span>
                        </div>
                    </div>
                    
                    <p style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #f6f9fc 0%, #e9f3ff 100%); border-radius: 10px;">
                        <strong>üéØ Optimal Resource Allocation:</strong> Shift 30% of effort from PCPs to High Volume segment. Expected gain: +7pp overall performance, worth $5.1M annually. Implementation: Adjust trigger thresholds and rep routing by Oct 15.
                    </p>
                </div>
            </div>
            
            <!-- Resource Reallocation Matrix -->
            <div class="agent-card">
                <div class="agent-header">
                    <div class="agent-icon" style="background: linear-gradient(135deg, #4ecdc4 0%, #44a8a0 100%);">üí∞</div>
                    <div>
                        <div class="agent-title">Resource Optimization Matrix</div>
                        <div class="agent-subtitle">Resource Optimizer Agent ‚Ä¢ ROI-driven reallocation</div>
                    </div>
                </div>
                <div class="insight-content">
                    <div id="resourceAllocationSankey"></div>
                    
                    <div style="margin-top: 20px;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #f7fafc;">
                                    <th style="padding: 10px; text-align: left; border-bottom: 2px solid #e2e8f0;">Resource</th>
                                    <th style="padding: 10px; text-align: left; border-bottom: 2px solid #e2e8f0;">Current</th>
                                    <th style="padding: 10px; text-align: left; border-bottom: 2px solid #e2e8f0;">Optimal</th>
                                    <th style="padding: 10px; text-align: left; border-bottom: 2px solid #e2e8f0;">‚àÜ Value</th>
                                    <th style="padding: 10px; text-align: left; border-bottom: 2px solid #e2e8f0;">Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;"><strong>Data Sources</strong></td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">4 sources</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">3 sources</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0; color: #48bb78;">+$1.2M</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">Drop 4th, improve matching</td>
                                </tr>
                                <tr>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;"><strong>Model Complexity</strong></td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">Deep ensemble</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">Maintain</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">-</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">Worth the complexity</td>
                                </tr>
                                <tr>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;"><strong>Field Capacity</strong></td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">Top 5%</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">Top 5%</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">-</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">Optimal (K>10% causes fatigue)</td>
                                </tr>
                                <tr>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;"><strong>UI Investment</strong></td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">Basic</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">Enhanced</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0; color: #48bb78;">+$10.5M</td>
                                    <td style="padding: 10px; border-bottom: 1px solid #e2e8f0;">Add SHAP viz ASAP</td>
                                </tr>
                                <tr style="background: #f7fafc;">
                                    <td style="padding: 10px; font-weight: bold;">Total Impact</td>
                                    <td style="padding: 10px;">-</td>
                                    <td style="padding: 10px;">-</td>
                                    <td style="padding: 10px; color: #667eea; font-weight: bold;">+$11.7M</td>
                                    <td style="padding: 10px;">Execute by Nov 1</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- System Health Score -->
            <div class="agent-card">
                <div class="agent-header">
                    <div class="agent-icon" style="background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);">üìä</div>
                    <div>
                        <div class="agent-title">E2I System Health Score</div>
                        <div class="agent-subtitle">Health Score Agent ‚Ä¢ Composite assessment</div>
                    </div>
                </div>
                <div class="insight-content">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <div style="font-size: 3em; font-weight: bold; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                            84/100
                        </div>
                        <div style="color: #718096;">Overall System Health</div>
                    </div>
                    
                    <div id="healthRadarChart"></div>
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px;">
                        <div style="padding: 15px; background: #f7fafc; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <strong>Data Quality</strong>
                                <span style="color: #48bb78; font-weight: bold;">88/100 ‚úì</span>
                            </div>
                            <div style="height: 4px; background: #e2e8f0; border-radius: 2px; margin-top: 8px;">
                                <div style="width: 88%; height: 100%; background: #48bb78; border-radius: 2px;"></div>
                            </div>
                        </div>
                        
                        <div style="padding: 15px; background: #f7fafc; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <strong>Model Performance</strong>
                                <span style="color: #48bb78; font-weight: bold;">82/100 ‚úì</span>
                            </div>
                            <div style="height: 4px; background: #e2e8f0; border-radius: 2px; margin-top: 8px;">
                                <div style="width: 82%; height: 100%; background: #48bb78; border-radius: 2px;"></div>
                            </div>
                        </div>
                        
                        <div style="padding: 15px; background: #f7fafc; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <strong>Trigger Effectiveness</strong>
                                <span style="color: #f6ad55; font-weight: bold;">78/100 ‚ö†</span>
                            </div>
                            <div style="height: 4px; background: #e2e8f0; border-radius: 2px; margin-top: 8px;">
                                <div style="width: 78%; height: 100%; background: #f6ad55; border-radius: 2px;"></div>
                            </div>
                        </div>
                        
                        <div style="padding: 15px; background: #f7fafc; border-radius: 10px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <strong>Business Impact</strong>
                                <span style="color: #48bb78; font-weight: bold;">86/100 ‚úì</span>
                            </div>
                            <div style="height: 4px; background: #e2e8f0; border-radius: 2px; margin-top: 8px;">
                                <div style="width: 86%; height: 100%; background: #48bb78; border-radius: 2px;"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #fff5f5 0%, #fffdf7 100%); border-radius: 10px;">
                        <strong>üéØ Key Improvement Vector:</strong> Trigger Effectiveness is the weakest link. Focus on acceptance rate (58%‚Üí75%) and false alert reduction (58%‚Üí40%) for +8 point health score improvement.
                    </div>
                </div>
            </div>
            
            <!-- Automated Decision Log -->
            <div class="agent-card">
                <div class="agent-header">
                    <div class="agent-icon" style="background: linear-gradient(135deg, #805ad5 0%, #667eea 100%);">üìù</div>
                    <div>
                        <div class="agent-title">Automated Agent Actions</div>
                        <div class="agent-subtitle">Orchestrator ‚Ä¢ Last 24 hours</div>
                    </div>
                </div>
                <div class="insight-content">
                    <div style="max-height: 300px; overflow-y: auto;">
                        <div style="padding: 10px; background: #f7fafc; border-radius: 8px; margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between;">
                                <strong>üîÑ Model Retrain Triggered</strong>
                                <span style="color: #718096; font-size: 0.85em;">Oct 8, 03:00 AM</span>
                            </div>
                            <div style="color: #4a5568; font-size: 0.9em; margin-top: 5px;">
                                PSI reached 0.20 threshold. Automated retraining initiated. New model deployed with AUC 0.82 (maintained).
                            </div>
                        </div>
                        
                        <div style="padding: 10px; background: #f7fafc; border-radius: 8px; margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between;">
                                <strong>üìß Alert Sent: South Region Gap</strong>
                                <span style="color: #718096; font-size: 0.85em;">Oct 7, 06:00 PM</span>
                            </div>
                            <div style="color: #4a5568; font-size: 0.9em; margin-top: 5px;">
                                Fairness gap exceeded 5pp threshold. Escalation to Regional Director. Meeting scheduled Oct 10.
                            </div>
                        </div>
                        
                        <div style="padding: 10px; background: #f7fafc; border-radius: 8px; margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between;">
                                <strong>‚ö° Trigger Threshold Adjusted</strong>
                                <span style="color: #718096; font-size: 0.85em;">Oct 7, 11:30 AM</span>
                            </div>
                            <div style="color: #4a5568; font-size: 0.9em; margin-top: 5px;">
                                High Volume HCP segment threshold lowered 0.65‚Üí0.60 based on heterogeneous effect analysis. Expected +3pp precision.
                            </div>
                        </div>
                        
                        <div style="padding: 10px; background: #f7fafc; border-radius: 8px; margin-bottom: 10px;">
                            <div style="display: flex; justify-content: space-between;">
                                <strong>üß™ A/B Test Launched</strong>
                                <span style="color: #718096; font-size: 0.85em;">Oct 6, 09:00 AM</span>
                            </div>
                            <div style="color: #4a5568; font-size: 0.9em; margin-top: 5px;">
                                Proactive alerts experiment started. 250 HCPs in treatment, 250 in control. Duration: 14 days.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Overview Tab -->
        <div id="overview" class="workstream-content active">
            <div class="summary-stats">
                <div class="stat-item">
                    <div class="stat-label">System Health</div>
                    <div class="stat-value">84%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Total Patients Covered</div>
                    <div class="stat-value">1.2M</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">HCP Engagement Rate</div>
                    <div class="stat-value">87%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Model Performance</div>
                    <div class="stat-value">0.82</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Trigger Precision</div>
                    <div class="stat-value">42%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Action Rate</div>
                    <div class="stat-value">52%</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Active Users</div>
                    <div class="stat-value">2,341</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Active Agents</div>
                    <div class="stat-value">8/8</div>
                </div>
            </div>

            <!-- Core Capabilities -->
            <div class="visualization-container">
                <div class="viz-title">üíé Core System Capabilities</div>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">üî¨ Causal Inference Engine</span>
                            <span class="metric-status status-green">Active</span>
                        </div>
                        <div class="metric-value">47 Chains</div>
                        <div class="causal-insight">
                            <div class="causal-insight-title">Core Capability</div>
                            <div class="causal-insight-text">
                                Moves beyond correlation to identify <span class="causal-effect">true cause-effect relationships</span> using DoWhy, EconML, CausalML, and NetworkX frameworks.
                            </div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">üìà Multiplier Discovery</span>
                            <span class="metric-status status-green">1.8x</span>
                        </div>
                        <div class="metric-value">Hidden Leverage</div>
                        <div class="causal-insight">
                            <div class="causal-insight-title">Core Capability</div>
                            <div class="causal-insight-text">
                                Identifies leverage points where <span class="causal-effect">1% improvements cascade to 1.8x impact</span> through the system.
                            </div>
                        </div>
                    </div>

                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">üîÆ Predictive Prevention</span>
                            <span class="metric-status status-green">92%</span>
                        </div>
                        <div class="metric-value">7-14 Days</div>
                        <div class="causal-insight">
                            <div class="causal-insight-title">Core Capability</div>
                            <div class="causal-insight-text">
                                Forecasts degradation with <span class="causal-effect">92% confidence</span>, saving $5M annually in prevented losses.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Workstream Integration -->
            <div class="visualization-container">
                <div class="viz-title">üîÑ Three-Workstream Integration</div>
                <div class="metrics-grid">
                    <div class="agent-card" style="border-left-color: #667eea;">
                        <div class="agent-header">
                            <div class="agent-icon impact">üìä</div>
                            <div>
                                <div class="agent-title">WS1: Data &amp; Model</div>
                                <div class="agent-subtitle">Foundation Layer</div>
                            </div>
                        </div>
                        <div class="insight-content">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div><strong>Coverage:</strong> 88%</div>
                                <div><strong>Quality:</strong> 98.5%</div>
                                <div><strong>Model AUC:</strong> 0.82</div>
                                <div><strong>Drift PSI:</strong> 0.18</div>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card opportunity">
                        <div class="agent-header">
                            <div class="agent-icon gap">üéØ</div>
                            <div>
                                <div class="agent-title">WS2: HCP Triggers</div>
                                <div class="agent-subtitle">Engagement Layer</div>
                            </div>
                        </div>
                        <div class="insight-content">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div><strong>Precision:</strong> 42%</div>
                                <div><strong>Accept Rate:</strong> 58%</div>
                                <div><strong>Action Rate:</strong> 52%</div>
                                <div><strong>Journey Track:</strong> 67%</div>
                            </div>
                        </div>
                    </div>

                    <div class="agent-card predictive">
                        <div class="agent-header">
                            <div class="agent-icon drift">üí∞</div>
                            <div>
                                <div class="agent-title">WS3: Impact &amp; Platform</div>
                                <div class="agent-subtitle">Value Layer</div>
                            </div>
                        </div>
                        <div class="insight-content">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div><strong>Avg ROI:</strong> 4.3x</div>
                                <div><strong>Annual Value:</strong> $42M</div>
                                <div><strong>User Adoption:</strong> 84%</div>
                                <div><strong>System Health:</strong> 84%</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="causal-insight" style="margin-top: 20px;">
                    <div class="causal-insight-title">Causal Discovery</div>
                    <div class="causal-insight-text" style="text-align: center;">
                        Each <span class="causal-effect">10% improvement in WS1 data quality</span> causes 
                        <span class="causal-effect">6% lift in WS2 acceptance</span>, resulting in 
                        <span class="causal-effect">14% increase in WS3 value capture</span>. 
                        This multiplicative effect drives our focus on foundational improvements.
                    </div>
                </div>
            </div>

            
            <div class="visualization-container">
                <div class="viz-title">Executive Intelligence Summary - Real-time Causal Impact Analysis</div>
                <div class="causal-insight">
                    <div class="causal-insight-title">Current System Status</div>
                    <div class="causal-insight-text">
                        The E2I Causal Analytics platform is operating at <span class="causal-effect">84% health with 8 active AI agents</span> processing 1.47M patient journeys across 2,341 active users. 
                        Real-time causal analysis has identified <span class="causal-effect">3 high-impact optimization vectors worth $23.7M in annual value</span>. 
                        The system's causal inference engine has traced 142 significant pathways, with the strongest chain showing: 
                        <span class="causal-effect">Data Quality (88%) ‚Üí Model Performance (0.82 AUC) ‚Üí Trigger Precision (42%) ‚Üí Action Rate (+12pp) ‚Üí Business Impact ($4.2M/quarter)</span>.
                    </div>
                </div>
                <div class="metric-chart">
                    <canvas id="overviewChart"></canvas>
                </div>
            </div>
            
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Data-to-Value Pipeline</span>
                        <span class="metric-status status-green">OPTIMIZED</span>
                    </div>
                    <div class="metric-value">3.2x ROI</div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Intelligence Finding</div>
                        <div class="causal-insight-text">
                            DoWhy structural analysis reveals <span class="causal-effect">optimal configuration at 3 sources</span> - 4th source adds only 3% marginal value. 
                            Cross-source matching is the hidden multiplier: <span class="causal-effect">1% improvement ‚Üí 1.8x cascade effect</span> through journey completeness mediation.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Model-to-Impact Bridge</span>
                        <span class="metric-status status-yellow">OPPORTUNITY</span>
                    </div>
                    <div class="metric-value">58% ‚Üí 75%</div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Intelligence Finding</div>
                        <div class="causal-insight-text">
                            Causal Forests identify <span class="causal-effect">explanation quality as primary lever</span>. SHAP visualization alone drives +25% acceptance. 
                            Combined with contextual patient history: <span class="causal-effect">multiplicative effect yields +35% total lift</span>.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Fairness & Trust Nexus</span>
                        <span class="metric-status status-green">MONITORED</span>
                    </div>
                    <div class="metric-value">4.2pp gap</div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Intelligence Finding</div>
                        <div class="causal-insight-text">
                            DiD analysis: <span class="causal-effect">South region gap causes 70% of fairness degradation</span> ‚Üí 15% trust decline ‚Üí 6pp acceptance drop. 
                            Targeted acquisition yields <span class="causal-effect">3x ROI through trust restoration pathway</span>.
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="visualization-container">
                <div class="viz-title">Primary Causal Value Chains - Live Tracking</div>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">Chain 1: Data Quality Impact</span>
                            <span class="metric-status status-green">ACTIVE</span>
                        </div>
                        <div class="causal-chain">
                            <div class="chain-node">Data Lag -5d</div>
                            <div class="chain-arrow">‚Üí</div>
                            <div class="chain-node">+0.04 AUC</div>
                            <div class="chain-arrow">‚Üí</div>
                            <div class="chain-node">+6pp Precision</div>
                            <div class="chain-arrow">‚Üí</div>
                            <div class="chain-node">+$2.1M/quarter</div>
                        </div>
                        <div class="causal-insight">
                            <div class="causal-insight-text">
                                <span class="causal-effect">Confidence: 95%</span> | Method: Instrumental Variables | Time to Impact: 30 days
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">Chain 2: User Experience</span>
                            <span class="metric-status status-green">HIGH ROI</span>
                        </div>
                        <div class="causal-chain">
                            <div class="chain-node">SHAP UI</div>
                            <div class="chain-arrow">‚Üí</div>
                            <div class="chain-node">+25% Accept</div>
                            <div class="chain-arrow">‚Üí</div>
                            <div class="chain-node">+14.5pp Action</div>
                            <div class="chain-arrow">‚Üí</div>
                            <div class="chain-node">+$10.5M/year</div>
                        </div>
                        <div class="causal-insight">
                            <div class="causal-insight-text">
                                <span class="causal-effect">Confidence: 88%</span> | Method: A/B Testing + DML | Time to Impact: 14 days
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">Chain 3: Coverage Equity</span>
                            <span class="metric-status status-yellow">IN PROGRESS</span>
                        </div>
                        <div class="causal-chain">
                            <div class="chain-node">South +18pp</div>
                            <div class="chain-arrow">‚Üí</div>
                            <div class="chain-node">-8pp Fairness</div>
                            <div class="chain-arrow">‚Üí</div>
                            <div class="chain-node">+15% Trust</div>
                            <div class="chain-arrow">‚Üí</div>
                            <div class="chain-node">+$8M captured</div>
                        </div>
                        <div class="causal-insight">
                            <div class="causal-insight-text">
                                <span class="causal-effect">Confidence: 92%</span> | Method: Causal Forests | Time to Impact: 45 days
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Initialize Overview Chart
        const ctx = document.getElementById('overviewChart');
        if (ctx) {
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                    datasets: [{
                        label: 'Data Quality ‚Üí Model Performance',
                        data: [0.75, 0.78, 0.81, 0.82],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        borderWidth: 3
                    }, {
                        label: 'Model ‚Üí Trigger Precision',
                        data: [35, 38, 40, 42],
                        borderColor: '#764ba2',
                        backgroundColor: 'rgba(118, 75, 162, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y1',
                        borderWidth: 3
                    }, {
                        label: 'Triggers ‚Üí Business Impact',
                        data: [18, 22, 26, 31],
                        borderColor: '#f093fb',
                        backgroundColor: 'rgba(240, 147, 251, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y2',
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Model Performance (AUC)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Precision (%)'
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        },
                        y2: {
                            type: 'linear',
                            display: false
                        }
                    }
                }
            });
        }
    </script>
        
        <!-- WS1 Data Quality Tab -->
        <div id="ws1-data" class="workstream-content">
            <div class="visualization-container">
                <div class="viz-title">Data Coverage & Quality Metrics</div>
                <div id="dataQualityHeatmap"></div>
            </div>
            
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Source Coverage - Patients</span>
                        <span class="metric-status status-green">82%</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="patientCoverageChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            DoWhy regression discontinuity: <span class="causal-effect">70% coverage threshold causes step-change</span> in model performance (+0.05 AUC). Currently above threshold.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Geographic Consistency</span>
                        <span class="metric-status status-yellow">18pp gap</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="geographicChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            Causal Forests reveal <span class="causal-effect">South region gap causes 8pp fairness degradation</span>. Targeted data acquisition would yield 3x ROI.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Data Lag (Median)</span>
                        <span class="metric-status status-green">12 days</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="dataLagChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            IV analysis: <span class="causal-effect">Lag >30 days causes 25% reduction</span> in acute condition detection. Current lag optimal for mixed use cases.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Cross-source Match Rate</span>
                        <span class="metric-status status-green">88%</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="matchRateChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            Mediation analysis: <span class="causal-effect">10% match improvement causes 18% better journey tracking</span> via completeness pathway.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Completeness Pass Rate</span>
                        <span class="metric-status status-green">98.5%</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="completenessChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            DML analysis: <span class="causal-effect">Each 1% improvement reduces false negatives by 2%</span>. Diminishing returns above 99%.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Stacking Lift - Patients</span>
                        <span class="metric-status status-green">+24%</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="stackingLiftChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            G-computation: <span class="causal-effect">3rd source adds 15% causal lift, 4th only 3%</span>. Recommend optimizing existing sources over adding new.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- WS1 ML & Model Tab -->
        <div id="ws1-ml" class="workstream-content">
            <div class="visualization-container">
                <div class="viz-title">Model Performance & Drift Analysis</div>
                <div id="modelPerformanceChart"></div>
            </div>
            
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">ROC-AUC</span>
                        <span class="metric-status status-green">0.82</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="rocChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            Metalearners: <span class="causal-effect">Balanced sampling causes +0.08 AUC</span>, ensemble adds +0.04. Interaction effect minimal (+0.02).
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Feature Drift (PSI)</span>
                        <span class="metric-status status-yellow">0.18</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="driftChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            Causal Forest: <span class="causal-effect">Seasonal patterns cause 0.15 PSI baseline</span>, data changes add 0.10. Monthly retraining optimal.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Label Quality (IAA)</span>
                        <span class="metric-status status-green">Œ∫=0.72</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="iaaChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            Causal analysis: <span class="causal-effect">Guidelines cause Œ∫+0.3, training adds +0.15</span>. Combined effect less than sum (Œ∫+0.35).
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Recall@Top-5%</span>
                        <span class="metric-status status-green">38%</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="recallTopKChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            PolicyTree: <span class="causal-effect">K=5% causes optimal resource use</span>. K>10% causes fatigue, reducing effectiveness by 30%.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">SHAP Coverage</span>
                        <span class="metric-status status-green">85%</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="shapChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            Survey experiment: <span class="causal-effect">Top-5 SHAP >80% causes 35% trust increase</span>. No additional benefit beyond 90%.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Fairness Gap (ŒîRecall)</span>
                        <span class="metric-status status-green">4.2pp</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="fairnessChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            FairLearner: <span class="causal-effect">Historical bias causes 15pp gap</span>. Reweighting reduces to 5pp with -0.01 AUC trade-off.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- WS2 Triggers Tab -->
        <div id="ws2" class="workstream-content">
            <div class="visualization-container">
                <div class="viz-title">Trigger Performance & Governance</div>
                <div id="triggerFlowChart"></div>
            </div>
            
            <div class="metrics-grid">
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Precision (Trigger)</span>
                        <span class="metric-status status-green">42%</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="precisionChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            Causal Forests: <span class="causal-effect">Recent interaction causes +20pp precision</span>, specialty match adds +15pp. Combined effect multiplicative.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Lead Time</span>
                        <span class="metric-status status-green">16 days</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="leadTimeChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            DML analysis: <span class="causal-effect">14-21 day window causes 35% better outcomes</span>. Urgency modulates effect by ¬±7 days.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Acceptance Rate</span>
                        <span class="metric-status status-yellow">58%</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="acceptanceChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            A/B analysis: <span class="causal-effect">Explanations cause +25% acceptance</span>, confidence scores add +10%. UI redesign potential +15%.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Action Rate Uplift</span>
                        <span class="metric-status status-green">+12pp</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="upliftChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            RCT analysis: <span class="causal-effect">True causal effect +12pp after bias control</span>. NBA triggers +9pp, pure alerts +3pp.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">False Alert Rate</span>
                        <span class="metric-status status-yellow">58%</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="falseAlertChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            Context analysis: <span class="causal-effect">Patient history reduces false alerts by 30%</span>, HCP preferences by 15%. Stack for 40% reduction.
                        </div>
                    </div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">Time-to-Release</span>
                        <span class="metric-status status-green">8 days</span>
                    </div>
                    <div class="metric-chart">
                        <canvas id="ttrChart"></canvas>
                    </div>
                    <div class="causal-insight">
                        <div class="causal-insight-title">Causal Finding</div>
                        <div class="causal-insight-text">
                            Process mining: <span class="causal-effect">Automated testing causes -5 days TTR</span>, parallel review adds -3 days. Bottleneck: approval.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- WS3 Impact Tab -->
        <div id="ws3" class="workstream-content">
            <div class="visualization-container">
                <div class="viz-title">Business Impact & Adoption Metrics</div>
                <div id="impactSankeyChart"></div>
            </div>
            
            <!-- General KPIs Section -->
            <div class="visualization-container">
                <div class="viz-title">üìä General Platform KPIs</div>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">Active Users (MAU)</span>
                            <span class="metric-status status-green">2,341</span>
                        </div>
                        <div class="metric-chart">
                            <canvas id="mauChart"></canvas>
                        </div>
                        <div class="causal-insight">
                            <div class="causal-insight-title">Causal Finding</div>
                            <div class="causal-insight-text">
                                Retention analysis: <span class="causal-effect">Personalized onboarding causes +40% MAU</span>, gamification adds +15%. Synergy effect +8%.
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">HCP Coverage</span>
                            <span class="metric-status status-green">78%</span>
                        </div>
                        <div class="metric-chart">
                            <canvas id="hcpCoverageChart"></canvas>
                        </div>
                        <div class="causal-insight">
                            <div class="causal-insight-title">Causal Finding</div>
                            <div class="causal-insight-text">
                                Network effects: <span class="causal-effect">Territory optimization causes +25% coverage</span>, peer influence adds +10% via social proof.
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">Patient Touch Rate</span>
                            <span class="metric-status status-yellow">48%</span>
                        </div>
                        <div class="metric-chart">
                            <canvas id="patientTouchChart"></canvas>
                        </div>
                        <div class="causal-insight">
                            <div class="causal-insight-title">Causal Finding</div>
                            <div class="causal-insight-text">
                                DML: <span class="causal-effect">EMR integration causes 55% reach improvement</span>. Alerts alone achieve only 15%. Integration critical.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Remibrutinib Brand KPIs -->
            <div class="visualization-container">
                <div class="viz-title" style="background: linear-gradient(90deg, #9F7AEA 0%, #667eea 100%); color: white; padding: 10px; border-radius: 8px;">üíä Remibrutinib - Brand Specific KPIs</div>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">AH Uncontrolled Patients Identified</span>
                            <span class="metric-status status-green">62%</span>
                        </div>
                        <div class="metric-chart">
                            <canvas id="remiChart"></canvas>
                        </div>
                        <div class="causal-insight">
                            <div class="causal-insight-title">Causal Finding</div>
                            <div class="causal-insight-text">
                                Synthetic control: <span class="causal-effect">Lab integration causes +28% identification</span>, ML adds +15% incremental. Total effect +38%.
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">Intent-to-Prescribe (Œî vs baseline)</span>
                            <span class="metric-status status-green">+10pp</span>
                        </div>
                        <div class="metric-chart">
                            <canvas id="remiItpChart"></canvas>
                        </div>
                        <div class="causal-insight">
                            <div class="causal-insight-title">Causal Finding</div>
                            <div class="causal-insight-text">
                                ATU survey analysis: <span class="causal-effect">Targeted education causes +6pp ITP lift</span>, patient success stories add +4pp. Combined effect multiplicative.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Fabhalta Brand KPIs -->
            <div class="visualization-container">
                <div class="viz-title" style="background: linear-gradient(90deg, #48BB78 0%, #38A169 100%); color: white; padding: 10px; border-radius: 8px;">üß¨ Fabhalta - Brand Specific KPIs</div>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">Suspected PNH Patients Tested</span>
                            <span class="metric-status status-green">68%</span>
                        </div>
                        <div class="metric-chart">
                            <canvas id="fabhaltaTestChart"></canvas>
                        </div>
                        <div class="causal-insight">
                            <div class="causal-insight-title">Causal Finding</div>
                            <div class="causal-insight-text">
                                DiD analysis: <span class="causal-effect">Flow cytometry alerts cause +35pp testing rate</span>, physician education adds +15pp. Total uplift +50pp vs baseline.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Kisqali Brand KPIs -->
            <div class="visualization-container">
                <div class="viz-title" style="background: linear-gradient(90deg, #ED8936 0%, #DD6B20 100%); color: white; padding: 10px; border-radius: 8px;">üéØ Kisqali - Brand Specific KPIs</div>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">Priority Oncologists Reached</span>
                            <span class="metric-status status-green">82%</span>
                        </div>
                        <div class="metric-chart">
                            <canvas id="kisqaliReachChart"></canvas>
                        </div>
                        <div class="causal-insight">
                            <div class="causal-insight-title">Causal Finding</div>
                            <div class="causal-insight-text">
                                Territory analysis: <span class="causal-effect">AI-optimized routing causes +22% reach</span>, peer referral network adds +10%. Combined coverage optimization.
                            </div>
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-title">Oncotype Dx-Guided Adoption</span>
                            <span class="metric-status status-green">+15pp</span>
                        </div>
                        <div class="metric-chart">
                            <canvas id="kisqaliChart"></canvas>
                        </div>
                        <div class="causal-insight">
                            <div class="causal-insight-title">Causal Finding</div>
                            <div class="causal-insight-text">
                                Heterogeneous effects: <span class="causal-effect">Oncotype Dx causes +15pp for suitable patients</span>, +3pp for others. Targeting key.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Causal Analysis Tab -->
        <div id="causal" class="workstream-content">
            <div class="visualization-container">
                <div class="viz-title">Causal DAG - E2I Impact Pathways</div>
                <div id="causalDAG" class="causal-dag"></div>
            </div>
            
            <div class="visualization-container">
                <div class="viz-title">Heterogeneous Treatment Effects by Segment</div>
                <div id="heterogeneousEffects"></div>
            </div>
            
            <div class="visualization-container">
                <div class="viz-title">Causal Attribution Analysis</div>
                <div id="causalAttribution"></div>
            </div>
        </div>
        
        <!-- KPI Dictionary Tab -->
        <div id="kpi-dictionary" class="workstream-content">
            <div class="kpi-section">
                <div class="kpi-section-title">üìä WS1 - Data Coverage & Quality KPIs</div>
                
                <table class="kpi-table">
                    <thead>
                        <tr>
                            <th width="25%">KPI</th>
                            <th width="35%">Definition</th>
                            <th width="40%">Formula</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Source Coverage - Patients</strong></td>
                            <td>% of eligible patients present in source vs reference universe</td>
                            <td class="formula-text">coverage = covered_patients / reference_patients</td>
                        </tr>
                        <tr>
                            <td><strong>Source Coverage - HCPs</strong></td>
                            <td>% of priority HCPs present in source vs universe</td>
                            <td class="formula-text">coverage = covered_hcps / reference_hcps</td>
                        </tr>
                        <tr>
                            <td><strong>Geographic Consistency</strong></td>
                            <td>Max absolute gap between source share and universe share across regions</td>
                            <td class="formula-text">max_region |share_source - share_universe|</td>
                        </tr>
                        <tr>
                            <td><strong>Data Lag (Median)</strong></td>
                            <td>Median days from service date to availability in warehouse</td>
                            <td class="formula-text">median(datediff(ingested_ts, svc_date))</td>
                        </tr>
                        <tr>
                            <td><strong>Cross-source Match Rate</strong></td>
                            <td>% entities linkable across sources A & B</td>
                            <td class="formula-text">match_rate = |A‚à©B| / |A‚à™B|</td>
                        </tr>
                        <tr>
                            <td><strong>Stacking Lift</strong></td>
                            <td>Incremental value from combining multiple data sources</td>
                            <td class="formula-text">lift = (stacked - baseline) / baseline</td>
                        </tr>
                        <tr>
                            <td><strong>Completeness Pass Rate</strong></td>
                            <td>1 ‚àí null rate across brand-critical fields</td>
                            <td class="formula-text">pass = 1 ‚àí (null_critical / total)</td>
                        </tr>
                        <tr>
                            <td><strong>Feature Drift (PSI)</strong></td>
                            <td>Population Stability Index measuring shift in feature distributions</td>
                            <td class="formula-text">PSI = Œ£_b (q_b - p_b) * ln(q_b / p_b)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="kpi-section">
                <div class="kpi-section-title">ü§ñ WS1 - Model Performance KPIs</div>
                
                <table class="kpi-table">
                    <thead>
                        <tr>
                            <th width="25%">KPI</th>
                            <th width="35%">Definition</th>
                            <th width="40%">Formula</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>ROC-AUC</strong></td>
                            <td>Area Under the ROC Curve - probability that a positive is ranked above a negative</td>
                            <td class="formula-text">AUC = ‚à´TPR d(FPR)</td>
                        </tr>
                        <tr>
                            <td><strong>PR-AUC</strong></td>
                            <td>Area under the Precision‚ÄìRecall curve; preferable under class imbalance</td>
                            <td class="formula-text">‚à´Precision d(Recall)</td>
                        </tr>
                        <tr>
                            <td><strong>F1 Score</strong></td>
                            <td>Harmonic mean of precision and recall at chosen threshold</td>
                            <td class="formula-text">F1 = 2 * (Precision * Recall) / (Precision + Recall)</td>
                        </tr>
                        <tr>
                            <td><strong>Recall@Top-K</strong></td>
                            <td>Fraction of all positives captured within the top K highest-scored cases</td>
                            <td class="formula-text">TP_in_topK / Total_Positives</td>
                        </tr>
                        <tr>
                            <td><strong>Brier Score</strong></td>
                            <td>Mean squared error of probabilistic predictions; lower is better</td>
                            <td class="formula-text">Brier = (1/N) * Œ£(p_i - y_i)¬≤</td>
                        </tr>
                        <tr>
                            <td><strong>Calibration Slope</strong></td>
                            <td>Slope from regressing outcomes on logit of predicted probabilities; 1.0 is ideal</td>
                            <td class="formula-text">logit(Pr(y=1)) = Œ± + Œ≤*logit(pÃÇ)</td>
                        </tr>
                        <tr>
                            <td><strong>SHAP Coverage</strong></td>
                            <td>% of predictions where Top-N features explain ‚â•œÑ% of total attribution</td>
                            <td class="formula-text">count(top_n_shap ‚â• œÑ) / total_predictions</td>
                        </tr>
                        <tr>
                            <td><strong>Label Quality (IAA)</strong></td>
                            <td>Inter-Annotator Agreement measuring label consistency</td>
                            <td class="formula-text">Cohen's Œ∫ or Krippendorff's Œ±</td>
                        </tr>
                        <tr>
                            <td><strong>Fairness Gap (ŒîRecall)</strong></td>
                            <td>Worst-case recall gap across protected or relevant subgroups</td>
                            <td class="formula-text">max_g(Recall_g) - min_g(Recall_g)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="kpi-section">
                <div class="kpi-section-title">üéØ WS2 - Trigger Performance KPIs</div>
                
                <table class="kpi-table">
                    <thead>
                        <tr>
                            <th width="25%">KPI</th>
                            <th width="35%">Definition</th>
                            <th width="40%">Formula</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Precision (Trigger)</strong></td>
                            <td>Of all triggers fired, % that led to intended outcome within look-ahead window</td>
                            <td class="formula-text">Precision = TP / (TP + FP)</td>
                        </tr>
                        <tr>
                            <td><strong>Recall (Trigger)</strong></td>
                            <td>Of all outcomes that occurred, % preceded by a trigger within look-back window</td>
                            <td class="formula-text">Recall = TP / (TP + FN)</td>
                        </tr>
                        <tr>
                            <td><strong>Lead Time</strong></td>
                            <td>Median days from trigger to outcome for true positives</td>
                            <td class="formula-text">median(outcome_ts - trigger_ts)</td>
                        </tr>
                        <tr>
                            <td><strong>Action Rate Uplift</strong></td>
                            <td>Increase in desired actions among exposed vs matched control HCPs</td>
                            <td class="formula-text">Uplift = Pr(action|exposed) - Pr(action|control)</td>
                        </tr>
                        <tr>
                            <td><strong>Acceptance Rate</strong></td>
                            <td>% of presented recommendations accepted (not snoozed/overridden)</td>
                            <td class="formula-text">Acceptance = #accepted / #presented</td>
                        </tr>
                        <tr>
                            <td><strong>Time-to-Release (TTR)</strong></td>
                            <td>Calendar days from change approval to production availability</td>
                            <td class="formula-text">TTR = date_prod - date_approve</td>
                        </tr>
                        <tr>
                            <td><strong>Change-Fail Rate (CFR)</strong></td>
                            <td>% of releases requiring rollback or hotfix within 7 days</td>
                            <td class="formula-text">CFR = #rollbacks(7d) / #releases</td>
                        </tr>
                        <tr>
                            <td><strong>False Alert Rate</strong></td>
                            <td>% of fired alerts without intended outcome within T days</td>
                            <td class="formula-text">FalseAlert = #NoOutcomeInT / #Triggers</td>
                        </tr>
                        <tr>
                            <td><strong>Override Rate</strong></td>
                            <td>% of alerts manually overridden or marked "not relevant"</td>
                            <td class="formula-text">Override = #overridden / #presented</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="kpi-section">
                <div class="kpi-section-title">üìà WS3 - Business Impact KPIs</div>
                
                <table class="kpi-table">
                    <thead>
                        <tr>
                            <th width="25%">KPI</th>
                            <th width="35%">Definition</th>
                            <th width="40%">Formula</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="3" style="background: #f7fafc; font-weight: bold;">General Platform KPIs</td>
                        </tr>
                        <tr>
                            <td><strong>Active Users (MAU/WAU)</strong></td>
                            <td>Monthly/Weekly Active Users performing ‚â•1 relevant action</td>
                            <td class="formula-text">MAU = #{unique users with ‚â•1 action in month}</td>
                        </tr>
                        <tr>
                            <td><strong>HCP Coverage</strong></td>
                            <td>% of priority HCP list with ‚â•1 brand-aligned touch linked to triggers</td>
                            <td class="formula-text">%HCPs touched = touched_HCPs / target_HCPs</td>
                        </tr>
                        <tr>
                            <td><strong>Patient Touch Rate</strong></td>
                            <td>% of target patient list reviewed/flagged/acted upon in care settings</td>
                            <td class="formula-text">%Patients touched = target_patients_w_‚â•1_action / target_patients</td>
                        </tr>
                        <tr>
                            <td colspan="3" style="background: #f7fafc; font-weight: bold;">Brand-Specific KPIs</td>
                        </tr>
                        <tr>
                            <td><strong>Remi - AH Uncontrolled %</strong></td>
                            <td>% of antihistamine-uncontrolled CSU patients identified by model</td>
                            <td class="formula-text">%Identified = #AH_uncontrolled_flagged / #AH_uncontrolled_total</td>
                        </tr>
                        <tr>
                            <td><strong>Remi - Intent-to-Prescribe Œî</strong></td>
                            <td>Change in HCPs reporting "likely to prescribe" vs baseline</td>
                            <td class="formula-text">ITP_Œî = ITP_current - ITP_baseline</td>
                        </tr>
                        <tr>
                            <td><strong>Fabhalta - % PNH Tested</strong></td>
                            <td>% of suspected PNH patients who received flow cytometry testing</td>
                            <td class="formula-text">%tested = #suspected_with_test / #suspected_total</td>
                        </tr>
                        <tr>
                            <td><strong>Kisqali - Oncologist Reach</strong></td>
                            <td>% of priority oncologists with ‚â•1 brand-aligned engagement</td>
                            <td class="formula-text">%reached = #priority_HCPs_touched / #priority_HCPs</td>
                        </tr>
                        <tr>
                            <td><strong>Kisqali - Dx Adoption</strong></td>
                            <td>% priority oncologists with Oncotype Dx-guided prescriptions</td>
                            <td class="formula-text">Uplift = Pr(adoption|test_aligned) - Pr(adoption|BAU)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="kpi-section">
                <div class="kpi-section-title">üìê Statistical & Causal Methods</div>
                
                <table class="kpi-table">
                    <thead>
                        <tr>
                            <th width="25%">Method</th>
                            <th width="35%">Description</th>
                            <th width="40%">Application in Dashboard</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Difference-in-Differences (DiD)</strong></td>
                            <td>Compares changes over time between treatment and control groups to isolate causal effect</td>
                            <td>Used for action rate uplift, ITP changes, testing rate improvements</td>
                        </tr>
                        <tr>
                            <td><strong>Causal Forests</strong></td>
                            <td>Non-parametric method for heterogeneous treatment effects using random forests</td>
                            <td>Identifies which HCP/patient subgroups benefit most from interventions</td>
                        </tr>
                        <tr>
                            <td><strong>Double ML (DML)</strong></td>
                            <td>Uses ML for nuisance parameters while maintaining valid causal inference</td>
                            <td>Estimates treatment effects with high-dimensional confounders in EMR data</td>
                        </tr>
                        <tr>
                            <td><strong>Instrumental Variables (IV)</strong></td>
                            <td>Uses external variation to identify causal effects when unmeasured confounding exists</td>
                            <td>Data lag analysis using system delays as instruments</td>
                        </tr>
                        <tr>
                            <td><strong>Synthetic Control</strong></td>
                            <td>Creates weighted combination of control units to match treated unit pre-intervention</td>
                            <td>Brand-specific impact assessment (Remi patient identification)</td>
                        </tr>
                        <tr>
                            <td><strong>Regression Discontinuity</strong></td>
                            <td>Exploits discontinuous treatment assignment at threshold for causal identification</td>
                            <td>Coverage threshold effects (70% threshold for model performance)</td>
                        </tr>
                        <tr>
                            <td><strong>Mediation Analysis</strong></td>
                            <td>Decomposes total effect into direct and indirect pathways</td>
                            <td>ITP improvement pathway: targeting‚Üírelevance‚Üíengagement</td>
                        </tr>
                        <tr>
                            <td><strong>Meta-learners (S/T/X)</strong></td>
                            <td>ML methods that estimate CATE by combining base learners differently</td>
                            <td>Heterogeneous treatment effect estimation across HCP segments</td>
                        </tr>
                        <tr>
                            <td><strong>G-computation</strong></td>
                            <td>Standardization method for estimating causal effects under sequential treatments</td>
                            <td>Multi-source data stacking lift analysis</td>
                        </tr>
                        <tr>
                            <td><strong>Propensity Score Matching</strong></td>
                            <td>Matches treated and control units on probability of treatment</td>
                            <td>Creating balanced comparison groups for trigger effectiveness</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="kpi-section">
                <div class="kpi-section-title">üìñ Complete Terminology & Abbreviations</div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div>
                        <h4 style="color: #667eea; margin-bottom: 15px;">Framework & Organization</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 8px;"><strong>E2I:</strong> Evidence ‚Üí Decision ‚Üí Impact framework</li>
                            <li style="margin-bottom: 8px;"><strong>WS:</strong> Workstream (WS1=Data/ML, WS2=Triggers, WS3=Impact)</li>
                            <li style="margin-bottom: 8px;"><strong>IDS:</strong> Integrated Data Science</li>
                            <li style="margin-bottom: 8px;"><strong>DORA:</strong> DevOps Research & Assessment metrics</li>
                            <li style="margin-bottom: 8px;"><strong>SLA:</strong> Service Level Agreement</li>
                            <li style="margin-bottom: 8px;"><strong>MLOps:</strong> Machine Learning Operations</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="color: #667eea; margin-bottom: 15px;">Medical & Clinical</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 8px;"><strong>HCP:</strong> Healthcare Professional</li>
                            <li style="margin-bottom: 8px;"><strong>AH:</strong> Antihistamine</li>
                            <li style="margin-bottom: 8px;"><strong>CSU:</strong> Chronic Spontaneous Urticaria</li>
                            <li style="margin-bottom: 8px;"><strong>PNH:</strong> Paroxysmal Nocturnal Hemoglobinuria</li>
                            <li style="margin-bottom: 8px;"><strong>Dx:</strong> Diagnosis</li>
                            <li style="margin-bottom: 8px;"><strong>Tx:</strong> Treatment</li>
                            <li style="margin-bottom: 8px;"><strong>Rx:</strong> Prescription</li>
                            <li style="margin-bottom: 8px;"><strong>ICD:</strong> International Classification of Diseases</li>
                            <li style="margin-bottom: 8px;"><strong>NDC:</strong> National Drug Code</li>
                            <li style="margin-bottom: 8px;"><strong>LOINC:</strong> Logical Observation Identifiers Names and Codes</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="color: #667eea; margin-bottom: 15px;">Statistical Measures</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 8px;"><strong>pp:</strong> Percentage points (absolute difference)</li>
                            <li style="margin-bottom: 8px;"><strong>Œ∫ (kappa):</strong> Cohen's kappa coefficient (agreement)</li>
                            <li style="margin-bottom: 8px;"><strong>Œ± (alpha):</strong> Krippendorff's alpha (reliability)</li>
                            <li style="margin-bottom: 8px;"><strong>IAA:</strong> Inter-Annotator Agreement</li>
                            <li style="margin-bottom: 8px;"><strong>PSI:</strong> Population Stability Index</li>
                            <li style="margin-bottom: 8px;"><strong>SHAP:</strong> SHapley Additive exPlanations</li>
                            <li style="margin-bottom: 8px;"><strong>CATE:</strong> Conditional Average Treatment Effect</li>
                            <li style="margin-bottom: 8px;"><strong>ATE:</strong> Average Treatment Effect</li>
                            <li style="margin-bottom: 8px;"><strong>JS:</strong> Jensen-Shannon divergence</li>
                            <li style="margin-bottom: 8px;"><strong>KS:</strong> Kolmogorov-Smirnov test</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="color: #667eea; margin-bottom: 15px;">Data Sources & Systems</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 8px;"><strong>IQVIA APLD:</strong> All-Payer Longitudinal Data</li>
                            <li style="margin-bottom: 8px;"><strong>IQVIA LAAD:</strong> Longitudinal Access & Adjudication Data</li>
                            <li style="margin-bottom: 8px;"><strong>HealthVerity:</strong> Lab and EMR data provider</li>
                            <li style="margin-bottom: 8px;"><strong>Komodo:</strong> Healthcare data platform</li>
                            <li style="margin-bottom: 8px;"><strong>Veeva:</strong> CRM platform for life sciences</li>
                            <li style="margin-bottom: 8px;"><strong>OCE:</strong> Orchestrated Customer Engagement (Veeva)</li>
                            <li style="margin-bottom: 8px;"><strong>EMR/EHR:</strong> Electronic Medical/Health Record</li>
                            <li style="margin-bottom: 8px;"><strong>CRM:</strong> Customer Relationship Management</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="color: #667eea; margin-bottom: 15px;">Performance Metrics</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 8px;"><strong>TP/FP/TN/FN:</strong> True/False Positive/Negative</li>
                            <li style="margin-bottom: 8px;"><strong>MAU/WAU:</strong> Monthly/Weekly Active Users</li>
                            <li style="margin-bottom: 8px;"><strong>ITP:</strong> Intent-to-Prescribe</li>
                            <li style="margin-bottom: 8px;"><strong>ATU:</strong> Awareness, Trial, Usage (survey)</li>
                            <li style="margin-bottom: 8px;"><strong>BAU:</strong> Business-As-Usual (control)</li>
                            <li style="margin-bottom: 8px;"><strong>TTR:</strong> Time-to-Release</li>
                            <li style="margin-bottom: 8px;"><strong>CFR:</strong> Change-Fail Rate</li>
                            <li style="margin-bottom: 8px;"><strong>NBA:</strong> Next Best Action</li>
                            <li style="margin-bottom: 8px;"><strong>ROI:</strong> Return on Investment</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="color: #667eea; margin-bottom: 15px;">Time & Change Metrics</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 8px;"><strong>MoM:</strong> Month-over-Month change</li>
                            <li style="margin-bottom: 8px;"><strong>WoW:</strong> Week-over-Week change</li>
                            <li style="margin-bottom: 8px;"><strong>YoY:</strong> Year-over-Year change</li>
                            <li style="margin-bottom: 8px;"><strong>p50/p95/p99:</strong> 50th/95th/99th percentile</li>
                            <li style="margin-bottom: 8px;"><strong>EoM:</strong> End of Month</li>
                            <li style="margin-bottom: 8px;"><strong>T:</strong> Time window/threshold parameter</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="color: #667eea; margin-bottom: 15px;">Causal Inference Terms</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 8px;"><strong>SUTVA:</strong> Stable Unit Treatment Value Assumption</li>
                            <li style="margin-bottom: 8px;"><strong>Ignorability:</strong> No unmeasured confounders assumption</li>
                            <li style="margin-bottom: 8px;"><strong>Positivity:</strong> Overlap in covariate distributions</li>
                            <li style="margin-bottom: 8px;"><strong>Confounder:</strong> Variable affecting both treatment and outcome</li>
                            <li style="margin-bottom: 8px;"><strong>Mediator:</strong> Variable on causal pathway between treatment and outcome</li>
                            <li style="margin-bottom: 8px;"><strong>Collider:</strong> Variable caused by both treatment and outcome</li>
                            <li style="margin-bottom: 8px;"><strong>RCT:</strong> Randomized Controlled Trial</li>
                            <li style="margin-bottom: 8px;"><strong>DAG:</strong> Directed Acyclic Graph</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="color: #667eea; margin-bottom: 15px;">Technical Terms</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 8px;"><strong>API:</strong> Application Programming Interface</li>
                            <li style="margin-bottom: 8px;"><strong>CI/CD:</strong> Continuous Integration/Deployment</li>
                            <li style="margin-bottom: 8px;"><strong>DevOps:</strong> Development Operations</li>
                            <li style="margin-bottom: 8px;"><strong>FK:</strong> Foreign Key (database)</li>
                            <li style="margin-bottom: 8px;"><strong>SQL:</strong> Structured Query Language</li>
                            <li style="margin-bottom: 8px;"><strong>ETL:</strong> Extract, Transform, Load</li>
                            <li style="margin-bottom: 8px;"><strong>Regex:</strong> Regular Expression</li>
                            <li style="margin-bottom: 8px;"><strong>JSON:</strong> JavaScript Object Notation</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 style="color: #667eea; margin-bottom: 15px;">Brand Names & Products</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="margin-bottom: 8px;"><strong>Remibrutinib (Remi):</strong> Treatment for CSU</li>
                            <li style="margin-bottom: 8px;"><strong>Fabhalta:</strong> Treatment for PNH</li>
                            <li style="margin-bottom: 8px;"><strong>Kisqali:</strong> Treatment for HR+/HER2- breast cancer</li>
                            <li style="margin-bottom: 8px;"><strong>Oncotype Dx:</strong> Genomic test for breast cancer</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="kpi-section">
                <div class="kpi-section-title">üîç Key Concepts & Assumptions</div>
                
                <div style="padding: 20px; background: #f7fafc; border-radius: 10px;">
                    <h4 style="color: #2d3748; margin-bottom: 15px;">Causal Inference Assumptions</h4>
                    <ul style="color: #4a5568; line-height: 1.8; margin-left: 20px;">
                        <li><strong>SUTVA (Stable Unit Treatment Value Assumption):</strong> One unit's treatment doesn't affect another unit's outcome (no interference between units)</li>
                        <li><strong>Ignorability/Unconfoundedness:</strong> Treatment assignment is independent of potential outcomes given observed covariates</li>
                        <li><strong>Positivity/Common Support:</strong> Every unit has a non-zero probability of receiving each treatment level</li>
                        <li><strong>Consistency:</strong> The potential outcome under treatment equals the observed outcome when that treatment is received</li>
                        <li><strong>Parallel Trends (DiD):</strong> Treatment and control groups would have evolved similarly in absence of treatment</li>
                    </ul>
                    
                    <h4 style="color: #2d3748; margin-top: 20px; margin-bottom: 15px;">Data Quality Dimensions</h4>
                    <ul style="color: #4a5568; line-height: 1.8; margin-left: 20px;">
                        <li><strong>Completeness:</strong> Degree to which required data is present</li>
                        <li><strong>Validity:</strong> Data conforms to defined formats and business rules</li>
                        <li><strong>Uniqueness:</strong> No inappropriate duplicates exist</li>
                        <li><strong>Consistency:</strong> Data is uniform across systems and time</li>
                        <li><strong>Timeliness:</strong> Data is available when needed</li>
                        <li><strong>Accuracy:</strong> Data correctly represents real-world entities</li>
                    </ul>
                    
                    <h4 style="color: #2d3748; margin-top: 20px; margin-bottom: 15px;">Model Performance Considerations</h4>
                    <ul style="color: #4a5568; line-height: 1.8; margin-left: 20px;">
                        <li><strong>Class Imbalance:</strong> When positive cases are rare, PR-AUC is more informative than ROC-AUC</li>
                        <li><strong>Calibration:</strong> Well-calibrated models have predicted probabilities that match observed frequencies</li>
                        <li><strong>Drift:</strong> Feature distributions can shift over time (data drift) affecting model performance (concept drift)</li>
                        <li><strong>Fairness:</strong> Models should perform equitably across relevant subgroups</li>
                        <li><strong>Interpretability:</strong> SHAP values help explain individual predictions for trust and debugging</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- Status Legend Tab -->
        <div id="legend" class="workstream-content">
            <div class="visualization-container">
                <div class="viz-title">üè∑Ô∏è Status Indicator Legend & Thresholds</div>
                
                <div class="legend-grid">
                    <div class="legend-section">
                        <div class="legend-title">üìä Performance Status Colors</div>
                        
                        <div class="legend-item">
                            <div class="legend-color" style="background: #c6f6d5;"></div>
                            <div class="legend-description">
                                <div class="legend-label">Green - Optimal/Good</div>
                                <div class="legend-criteria">Meeting or exceeding target performance</div>
                            </div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-color" style="background: #feebc8;"></div>
                            <div class="legend-description">
                                <div class="legend-label">Yellow - Monitor</div>
                                <div class="legend-criteria">Below target but within acceptable range</div>
                            </div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-color" style="background: #fed7d7;"></div>
                            <div class="legend-description">
                                <div class="legend-label">Red - Critical</div>
                                <div class="legend-criteria">Below acceptable threshold, requires action</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="legend-section">
                        <div class="legend-title">üéØ Data Quality Thresholds</div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">Source Coverage</div>
                                <div class="legend-criteria">Green: ‚â•80% | Yellow: 60-79% | Red: <60%</div>
                            </div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">Data Lag</div>
                                <div class="legend-criteria">Green: ‚â§14 days | Yellow: 15-30 days | Red: >30 days</div>
                            </div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">Match Rate</div>
                                <div class="legend-criteria">Green: ‚â•85% | Yellow: 70-84% | Red: <70%</div>
                            </div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">Completeness</div>
                                <div class="legend-criteria">Green: ‚â•95% | Yellow: 90-94% | Red: <90%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="legend-section">
                        <div class="legend-title">ü§ñ Model Performance Thresholds</div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">ROC-AUC</div>
                                <div class="legend-criteria">Green: ‚â•0.80 | Yellow: 0.70-0.79 | Red: <0.70</div>
                            </div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">Feature Drift (PSI)</div>
                                <div class="legend-criteria">Green: <0.10 | Yellow: 0.10-0.25 | Red: >0.25</div>
                            </div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">Label Quality (IAA)</div>
                                <div class="legend-criteria">Green: Œ∫‚â•0.70 | Yellow: Œ∫=0.50-0.69 | Red: Œ∫<0.50</div>
                            </div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">Fairness Gap</div>
                                <div class="legend-criteria">Green: ‚â§5pp | Yellow: 6-10pp | Red: >10pp</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="legend-section">
                        <div class="legend-title">üéØ Trigger Performance Thresholds</div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">Precision</div>
                                <div class="legend-criteria">Green: ‚â•40% | Yellow: 25-39% | Red: <25%</div>
                            </div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">Acceptance Rate</div>
                                <div class="legend-criteria">Green: ‚â•65% | Yellow: 45-64% | Red: <45%</div>
                            </div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">Lead Time</div>
                                <div class="legend-criteria">Green: 14-21 days | Yellow: 7-13 or 22-30 days | Red: <7 or >30 days</div>
                            </div>
                        </div>
                        
                        <div class="legend-item">
                            <div class="legend-description">
                                <div class="legend-label">False Alert Rate</div>
                                <div class="legend-criteria">Green: ‚â§40% | Yellow: 41-60% | Red: >60%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

        <!-- Methodology Tab -->
        <div id="methodology" class="workstream-content">
            <!-- Agentic Workflow Overview -->
            <div class="visualization-container">
                <div class="viz-title">ü§ñ Causal Analytics Agentic Workflow</div>
                
                <div style="background: linear-gradient(135deg, #f6f9fc 0%, #e9f3ff 100%); padding: 25px; border-radius: 15px; margin-bottom: 25px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">System Architecture Overview</h3>
                    <p style="color: #4a5568; line-height: 1.8;">
                        The E2I Causal Analytics system employs <strong>8 specialized AI agents</strong> that work in concert to transform dashboard metrics into actionable intelligence. Each agent has distinct responsibilities but collaborates through a central orchestrator to provide comprehensive insights.
                    </p>
                    
                    <div id="agentOrchestrationFlow" style="margin-top: 20px; height: 400px; background: white; border-radius: 10px; padding: 20px;"></div>
                </div>
            </div>
            
            <!-- Agent Descriptions -->
            <div class="visualization-container">
                <div class="viz-title">üìã Agent Specifications & Capabilities</div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px;">
                    <!-- Causal Impact Agent -->
                    <div style="background: linear-gradient(135deg, #fff 0%, #f6f9fc 100%); padding: 20px; border-radius: 12px; border-left: 4px solid #667eea;">
                        <h4 style="color: #667eea; margin-bottom: 12px;">‚ö° Causal Impact Propagation Agent</h4>
                        <p style="color: #4a5568; font-size: 0.9em; margin-bottom: 10px;">
                            <strong>Purpose:</strong> Traces causal chains across workstreams to quantify end-to-end impact
                        </p>
                        <div style="background: #f7fafc; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <strong style="color: #2d3748;">Key Functions:</strong>
                            <ul style="margin: 5px 0 0 20px; color: #4a5568; font-size: 0.9em;">
                                <li>Forward propagation: Predicts downstream effects</li>
                                <li>Backward attribution: Identifies root causes</li>
                                <li>Multiplier detection: Finds leverage points</li>
                                <li>Value quantification: Calculates financial impact</li>
                            </ul>
                        </div>
                        <p style="color: #718096; font-size: 0.85em;">
                            <strong>Algorithms:</strong> Structural Causal Models, Path Analysis, G-computation
                        </p>
                    </div>
                    
                    <!-- Gap Analyzer Agent -->
                    <div style="background: linear-gradient(135deg, #fff 0%, #f0fff4 100%); padding: 20px; border-radius: 12px; border-left: 4px solid #48bb78;">
                        <h4 style="color: #48bb78; margin-bottom: 12px;">üìä Performance Gap Analyzer Agent</h4>
                        <p style="color: #4a5568; font-size: 0.9em; margin-bottom: 10px;">
                            <strong>Purpose:</strong> Identifies and prioritizes improvement opportunities by ROI
                        </p>
                        <div style="background: #f7fafc; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <strong style="color: #2d3748;">Analysis Dimensions:</strong>
                            <ul style="margin: 5px 0 0 20px; color: #4a5568; font-size: 0.9em;">
                                <li>Current vs. target gap identification</li>
                                <li>Impact assessment of closing gaps</li>
                                <li>Effort estimation for improvements</li>
                                <li>ROI calculation and ranking</li>
                            </ul>
                        </div>
                        <p style="color: #718096; font-size: 0.85em;">
                            <strong>Methods:</strong> Counterfactual Analysis, Cost-Benefit Modeling
                        </p>
                    </div>
                    
                    <!-- Drift Monitor Agent -->
                    <div style="background: linear-gradient(135deg, #fff 0%, #fffdf7 100%); padding: 20px; border-radius: 12px; border-left: 4px solid #f6ad55;">
                        <h4 style="color: #f6ad55; margin-bottom: 12px;">üîç Drift & Degradation Monitor Agent</h4>
                        <p style="color: #4a5568; font-size: 0.9em; margin-bottom: 10px;">
                            <strong>Purpose:</strong> Predictive monitoring with causal attribution of changes
                        </p>
                        <div style="background: #f7fafc; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <strong style="color: #2d3748;">Monitoring Targets:</strong>
                            <ul style="margin: 5px 0 0 20px; color: #4a5568; font-size: 0.9em;">
                                <li>Feature distribution shifts (PSI)</li>
                                <li>Model performance degradation</li>
                                <li>Label quality changes (IAA)</li>
                                <li>Data freshness variations</li>
                            </ul>
                        </div>
                        <p style="color: #718096; font-size: 0.85em;">
                            <strong>Techniques:</strong> Time Series Forecasting, Anomaly Detection, Change Point Analysis
                        </p>
                    </div>
                    
                    <!-- Heterogeneous Optimizer -->
                    <div style="background: linear-gradient(135deg, #fff 0%, #faf5ff 100%); padding: 20px; border-radius: 12px; border-left: 4px solid #9F7AEA;">
                        <h4 style="color: #9F7AEA; margin-bottom: 12px;">üé® Heterogeneous Effect Optimizer</h4>
                        <p style="color: #4a5568; font-size: 0.9em; margin-bottom: 10px;">
                            <strong>Purpose:</strong> Personalizes interventions based on segment-specific responses
                        </p>
                        <div style="background: #f7fafc; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <strong style="color: #2d3748;">Optimization Areas:</strong>
                            <ul style="margin: 5px 0 0 20px; color: #4a5568; font-size: 0.9em;">
                                <li>HCP segment treatment effects</li>
                                <li>Brand-specific optimizations</li>
                                <li>Regional performance variations</li>
                                <li>Temporal effect modulations</li>
                            </ul>
                        </div>
                        <p style="color: #718096; font-size: 0.85em;">
                            <strong>Methods:</strong> Causal Forests, Meta-learners (S/T/X), Double ML
                        </p>
                    </div>
                    
                    <!-- Experiment Designer -->
                    <div style="background: linear-gradient(135deg, #fff 0%, #e6fffc 100%); padding: 20px; border-radius: 12px; border-left: 4px solid #4ecdc4;">
                        <h4 style="color: #4ecdc4; margin-bottom: 12px;">üß™ Experiment Designer Agent</h4>
                        <p style="color: #4a5568; font-size: 0.9em; margin-bottom: 10px;">
                            <strong>Purpose:</strong> Designs and analyzes A/B tests with causal rigor
                        </p>
                        <div style="background: #f7fafc; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <strong style="color: #2d3748;">Design Elements:</strong>
                            <ul style="margin: 5px 0 0 20px; color: #4a5568; font-size: 0.9em;">
                                <li>Power analysis and sample sizing</li>
                                <li>Randomization strategy</li>
                                <li>Spillover effect mitigation</li>
                                <li>Sequential testing optimization</li>
                            </ul>
                        </div>
                        <p style="color: #718096; font-size: 0.85em;">
                            <strong>Framework:</strong> Adaptive Experimentation, Bayesian Optimization
                        </p>
                    </div>
                    
                    <!-- Health Score Agent -->
                    <div style="background: linear-gradient(135deg, #fff 0%, #f0f9ff 100%); padding: 20px; border-radius: 12px; border-left: 4px solid #3182ce;">
                        <h4 style="color: #3182ce; margin-bottom: 12px;">üíØ System Health Score Agent</h4>
                        <p style="color: #4a5568; font-size: 0.9em; margin-bottom: 10px;">
                            <strong>Purpose:</strong> Computes composite health metrics across all dimensions
                        </p>
                        <div style="background: #f7fafc; padding: 10px; border-radius: 8px; margin-bottom: 10px;">
                            <strong style="color: #2d3748;">Score Components:</strong>
                            <ul style="margin: 5px 0 0 20px; color: #4a5568; font-size: 0.9em;">
                                <li>Data quality (88/100)</li>
                                <li>Model performance (82/100)</li>
                                <li>Trigger effectiveness (78/100)</li>
                                <li>Business impact (86/100)</li>
                            </ul>
                        </div>
                        <p style="color: #718096; font-size: 0.85em;">
                            <strong>Method:</strong> Weighted Composite Scoring, Pareto Optimization
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Workflow Process -->
            <div class="visualization-container">
                <div class="viz-title">‚öôÔ∏è Agentic Workflow Process</div>
                
                <div style="background: white; padding: 25px; border-radius: 12px;">
                    <h3 style="color: #2d3748; margin-bottom: 20px;">Daily Analysis Pipeline</h3>
                    
                    <!-- Step 1 -->
                    <div style="display: flex; align-items: flex-start; margin-bottom: 20px;">
                        <div style="min-width: 50px; height: 50px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2em;">1</div>
                        <div style="flex: 1; margin-left: 20px;">
                            <h4 style="color: #667eea; margin-bottom: 8px;">Data Ingestion & Validation</h4>
                            <p style="color: #4a5568; line-height: 1.6;">
                                <strong>09:00 AM:</strong> Agents pull latest metrics from dashboard (1.2M patients, 2,341 active users, 0.82 AUC model). 
                                Validation checks ensure data quality: completeness (98.5% pass), freshness (12-day lag), and consistency across sources.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Step 2 -->
                    <div style="display: flex; align-items: flex-start; margin-bottom: 20px;">
                        <div style="min-width: 50px; height: 50px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2em;">2</div>
                        <div style="flex: 1; margin-left: 20px;">
                            <h4 style="color: #667eea; margin-bottom: 8px;">Causal Graph Update</h4>
                            <p style="color: #4a5568; line-height: 1.6;">
                                <strong>09:05 AM:</strong> Causal Impact Agent updates DAG based on new data. Discovers: acceptance rate (58%) ‚Üí action rate (+12pp) relationship strengthened.
                                New edge detected: South coverage gap (18pp) ‚Üí fairness degradation (8pp) ‚Üí trust decline.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Step 3 -->
                    <div style="display: flex; align-items: flex-start; margin-bottom: 20px;">
                        <div style="min-width: 50px; height: 50px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2em;">3</div>
                        <div style="flex: 1; margin-left: 20px;">
                            <h4 style="color: #667eea; margin-bottom: 8px;">Parallel Agent Analysis</h4>
                            <p style="color: #4a5568; line-height: 1.6;">
                                <strong>09:10 AM:</strong> All 8 agents run simultaneously:
                            </p>
                            <ul style="margin: 10px 0 0 20px; color: #4a5568; font-size: 0.95em; line-height: 1.6;">
                                <li><strong>Gap Analyzer:</strong> Identifies acceptance rate gap (58% vs 75% target) = $4.2M opportunity</li>
                                <li><strong>Drift Monitor:</strong> Predicts PSI will exceed 0.25 threshold in 9 days</li>
                                <li><strong>Heterogeneous Optimizer:</strong> Specialists segment showing +22pp uplift variance</li>
                                <li><strong>Experiment Designer:</strong> Proposes SHAP explanation A/B test (n=500)</li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- Step 4 -->
                    <div style="display: flex; align-items: flex-start; margin-bottom: 20px;">
                        <div style="min-width: 50px; height: 50px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2em;">4</div>
                        <div style="flex: 1; margin-left: 20px;">
                            <h4 style="color: #667eea; margin-bottom: 8px;">Insight Synthesis</h4>
                            <p style="color: #4a5568; line-height: 1.6;">
                                <strong>09:15 AM:</strong> Orchestrator combines findings:
                            </p>
                            <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-top: 10px;">
                                <strong>Top 3 Priorities:</strong>
                                <ol style="margin: 10px 0 0 20px; color: #2d3748;">
                                    <li>Deploy SHAP explanations (ROI: 8.2x, Value: $10.5M)</li>
                                    <li>South region data acquisition (ROI: 6.4x, Value: $8M)</li>
                                    <li>Monthly model retraining (ROI: 4.1x, Value: $5M)</li>
                                </ol>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Step 5 -->
                    <div style="display: flex; align-items: flex-start; margin-bottom: 20px;">
                        <div style="min-width: 50px; height: 50px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2em;">5</div>
                        <div style="flex: 1; margin-left: 20px;">
                            <h4 style="color: #667eea; margin-bottom: 8px;">Action Execution</h4>
                            <p style="color: #4a5568; line-height: 1.6;">
                                <strong>09:20 AM:</strong> Automated actions triggered:
                            </p>
                            <ul style="margin: 10px 0 0 20px; color: #4a5568; font-size: 0.95em; line-height: 1.6;">
                                <li>‚úÖ Model retrain scheduled for Oct 17 (PSI prevention)</li>
                                <li>‚úÖ Alert sent to Regional Director about South gap</li>
                                <li>‚úÖ A/B test initiated for proactive alerts (n=500 HCPs)</li>
                                <li>‚úÖ Threshold adjusted for High Volume segment (0.65‚Üí0.60)</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Causal Methods -->
            <div class="visualization-container">
                <div class="viz-title">üî¨ Causal Inference Methods Applied</div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                    <!-- DoWhy Framework -->
                    <div style="background: linear-gradient(135deg, #f6f9fc 0%, #e9f3ff 100%); padding: 20px; border-radius: 12px;">
                        <h3 style="color: #667eea; margin-bottom: 15px;">üîç DoWhy Framework</h3>
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <strong style="color: #2d3748;">Application Example:</strong>
                            <p style="color: #4a5568; font-size: 0.9em; margin-top: 8px;">
                                <strong>Question:</strong> Does data lag affect model performance?<br>
                                <strong>Method:</strong> Instrumental Variable (system delays as instrument)<br>
                                <strong>Finding:</strong> 7-day lag reduction ‚Üí +0.04 AUC improvement<br>
                                <strong>Confidence:</strong> 95% CI [0.03, 0.05]
                            </p>
                        </div>
                        <ul style="color: #4a5568; margin-left: 20px; font-size: 0.9em; line-height: 1.8;">
                            <li>Backdoor adjustment controls for confounders</li>
                            <li>Regression discontinuity at 70% coverage threshold</li>
                            <li>DiD for action rate uplift measurement</li>
                        </ul>
                    </div>
                    
                    <!-- EconML -->
                    <div style="background: linear-gradient(135deg, #f6f9fc 0%, #fff5f5 100%); padding: 20px; border-radius: 12px;">
                        <h3 style="color: #764ba2; margin-bottom: 15px;">üìà EconML Library</h3>
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <strong style="color: #2d3748;">Application Example:</strong>
                            <p style="color: #4a5568; font-size: 0.9em; margin-top: 8px;">
                                <strong>Question:</strong> How do effects vary by HCP segment?<br>
                                <strong>Method:</strong> Double Machine Learning<br>
                                <strong>Finding:</strong> Specialists +22pp, PCPs +7pp, High Volume +28pp<br>
                                <strong>Action:</strong> Reallocate 30% resources to High Volume
                            </p>
                        </div>
                        <ul style="color: #4a5568; margin-left: 20px; font-size: 0.9em; line-height: 1.8;">
                            <li>Orthogonal Random Forest for heterogeneity</li>
                            <li>Meta-learners compare segment responses</li>
                            <li>Deep IV handles complex confounders</li>
                        </ul>
                    </div>
                    
                    <!-- Causal Forests -->
                    <div style="background: linear-gradient(135deg, #f6f9fc 0%, #f0f9ff 100%); padding: 20px; border-radius: 12px;">
                        <h3 style="color: #48bb78; margin-bottom: 15px;">üå≤ Causal Forests</h3>
                        <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <strong style="color: #2d3748;">Application Example:</strong>
                            <p style="color: #4a5568; font-size: 0.9em; margin-top: 8px;">
                                <strong>Question:</strong> What drives geographic disparities?<br>
                                <strong>Method:</strong> Honest causal forests<br>
                                <strong>Finding:</strong> South gap causes 8pp fairness degradation<br>
                                <strong>ROI:</strong> 3x return on targeted acquisition
                            </p>
                        </div>
                        <ul style="color: #4a5568; margin-left: 20px; font-size: 0.9em; line-height: 1.8;">
                            <li>Non-parametric effect estimation</li>
                            <li>Variable importance ranking</li>
                            <li>Local treatment effects by region</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Implementation Code -->
            <div class="visualization-container">
                <div class="viz-title">üíª Implementation Architecture</div>
                
                <div style="background: #2d3748; color: #e2e8f0; padding: 20px; border-radius: 10px; font-family: 'Courier New', monospace; font-size: 0.9em; overflow-x: auto;">
                    <pre style="margin: 0; white-space: pre-wrap;">
<span style="color: #48bb78;"># Causal Analytics Orchestrator</span>
<span style="color: #667eea;">class</span> <span style="color: #f6ad55;">CausalAnalyticsOrchestrator</span>:
    <span style="color: #667eea;">def</span> <span style="color: #f6ad55;">__init__</span>(<span style="color: #fc8181;">self</span>):
        <span style="color: #fc8181;">self</span>.agents = {
            <span style="color: #a0d468;">'impact'</span>: CausalImpactAgent(),
            <span style="color: #a0d468;">'gaps'</span>: GapAnalyzerAgent(),
            <span style="color: #a0d468;">'drift'</span>: DriftMonitorAgent(),
            <span style="color: #a0d468;">'heterogeneous'</span>: HeterogeneousOptimizer(),
            <span style="color: #a0d468;">'experiments'</span>: ExperimentDesigner(),
            <span style="color: #a0d468;">'resource'</span>: ResourceOptimizer(),
            <span style="color: #a0d468;">'health'</span>: HealthScoreAgent(),
            <span style="color: #a0d468;">'narrative'</span>: NarrativeGenerator()
        }
        
    <span style="color: #667eea;">async def</span> <span style="color: #f6ad55;">daily_analysis</span>(<span style="color: #fc8181;">self</span>, metrics: Dict) -> InsightReport:
        <span style="color: #48bb78;"># Step 1: Update causal graph</span>
        causal_graph = <span style="color: #fc8181;">self</span>.update_causal_dag(metrics)
        
        <span style="color: #48bb78;"># Step 2: Parallel agent analysis</span>
        tasks = []
        <span style="color: #667eea;">for</span> agent <span style="color: #667eea;">in</span> <span style="color: #fc8181;">self</span>.agents.values():
            tasks.append(agent.analyze(metrics, causal_graph))
        
        results = <span style="color: #667eea;">await</span> asyncio.gather(*tasks)
        
        <span style="color: #48bb78;"># Step 3: Synthesize insights</span>
        priorities = <span style="color: #fc8181;">self</span>.prioritize_by_roi(results)
        
        <span style="color: #48bb78;"># Step 4: Execute actions</span>
        actions = <span style="color: #fc8181;">self</span>.execute_automated_actions(priorities)
        
        <span style="color: #667eea;">return</span> InsightReport(
            health_score=<span style="color: #fc8181;">self</span>.calculate_health_score(metrics),
            top_priorities=priorities[:3],
            executed_actions=actions,
            narrative=<span style="color: #fc8181;">self</span>.agents[<span style="color: #a0d468;">'narrative'</span>].generate(results)
        )

<span style="color: #48bb78;"># Example: Causal Chain Tracing</span>
<span style="color: #667eea;">class</span> <span style="color: #f6ad55;">CausalImpactAgent</span>:
    <span style="color: #667eea;">def</span> <span style="color: #f6ad55;">trace_impact_chain</span>(<span style="color: #fc8181;">self</span>, start_metric: str, end_metric: str):
        <span style="color: #48bb78;"># Find all causal paths</span>
        paths = nx.all_simple_paths(<span style="color: #fc8181;">self</span>.graph, start_metric, end_metric)
        
        <span style="color: #48bb78;"># Calculate cumulative effect along each path</span>
        path_effects = []
        <span style="color: #667eea;">for</span> path <span style="color: #667eea;">in</span> paths:
            effect = 1.0
            <span style="color: #667eea;">for</span> i <span style="color: #667eea;">in</span> range(len(path) - 1):
                edge_effect = <span style="color: #fc8181;">self</span>.get_edge_effect(path[i], path[i+1])
                effect *= edge_effect
            path_effects.append((path, effect))
        
        <span style="color: #48bb78;"># Return strongest causal path</span>
        <span style="color: #667eea;">return</span> max(path_effects, key=<span style="color: #667eea;">lambda</span> x: x[1])

<span style="color: #48bb78;"># Real Example from Dashboard Data:</span>
<span style="color: #48bb78;"># Acceptance Rate (58%) ‚Üí Action Rate (+12pp) ‚Üí Value ($4.2M)</span>
result = agent.trace_impact_chain(<span style="color: #a0d468;">'acceptance_rate'</span>, <span style="color: #a0d468;">'business_value'</span>)
<span style="color: #48bb78;"># Output: 10pp improvement in acceptance ‚Üí 5.8pp action rate ‚Üí $4.2M quarterly</span>
                    </pre>
                </div>
            </div>
            
            <!-- ROI Calculation -->
            <div class="visualization-container">
                <div class="viz-title">üí∞ ROI-Driven Decision Making</div>
                
                <div style="background: white; padding: 25px; border-radius: 12px;">
                    <h3 style="color: #2d3748; margin-bottom: 20px;">How Agents Calculate ROI</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4 style="color: #667eea; margin-bottom: 10px;">Value Estimation Formula</h4>
                            <div style="background: #f7fafc; padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace;">
                                <strong>Value = Œî Metric √ó Causal Effect √ó Business Multiplier</strong><br><br>
                                Example: SHAP Explanations<br>
                                Œî Acceptance = +25% (58% ‚Üí 73%)<br>
                                Causal Effect = 0.58 (acceptance ‚Üí action)<br>
                                Business Multiplier = $725K per pp<br>
                                <strong>Total Value = 0.25 √ó 0.58 √ó 14.5 √ó $725K = $10.5M</strong>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="color: #667eea; margin-bottom: 10px;">Cost Estimation Components</h4>
                            <div style="background: #f7fafc; padding: 15px; border-radius: 8px;">
                                <ul style="margin: 0; padding-left: 20px; color: #4a5568;">
                                    <li><strong>Development:</strong> Engineering hours √ó rate</li>
                                    <li><strong>Infrastructure:</strong> Compute + storage costs</li>
                                    <li><strong>Opportunity:</strong> Resources diverted from other projects</li>
                                    <li><strong>Risk:</strong> Probability of failure √ó impact</li>
                                </ul>
                                <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #e2e8f0;">
                                    <strong>SHAP UI Cost:</strong> $1.28M<br>
                                    <strong>ROI = $10.5M / $1.28M = 8.2x</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Key Innovations -->
            <div class="visualization-container">
                <div class="viz-title">üöÄ Key Innovations in Our Approach</div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                    <div style="background: linear-gradient(135deg, #fff5f5 0%, #fff 100%); padding: 20px; border-radius: 12px; border-top: 3px solid #fc8181;">
                        <h4 style="color: #fc8181; margin-bottom: 10px;">1. Multiplier Effect Discovery</h4>
                        <p style="color: #4a5568; font-size: 0.95em; line-height: 1.6;">
                            Agents identify hidden leverage points where small improvements cascade. Example: 1% match rate improvement ‚Üí 1.8% journey tracking ‚Üí 0.9% trigger precision ‚Üí $6M value.
                        </p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #f0fff4 0%, #fff 100%); padding: 20px; border-radius: 12px; border-top: 3px solid #48bb78;">
                        <h4 style="color: #48bb78; margin-bottom: 10px;">2. Automated Action Execution</h4>
                        <p style="color: #4a5568; font-size: 0.95em; line-height: 1.6;">
                            System doesn't just recommend‚Äîit acts. Automatically triggers retraining at PSI thresholds, adjusts segment thresholds, and initiates A/B tests without human intervention.
                        </p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #e9f3ff 0%, #fff 100%); padding: 20px; border-radius: 12px; border-top: 3px solid #667eea;">
                        <h4 style="color: #667eea; margin-bottom: 10px;">3. Predictive Degradation Prevention</h4>
                        <p style="color: #4a5568; font-size: 0.95em; line-height: 1.6;">
                            Drift Monitor Agent forecasts issues 7-14 days ahead with 92% confidence. Prevents problems before they impact performance, saving ~$5M annually in avoided degradation.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        </div>
        
        <!-- Methodology Tab -->
        <div id="methodology" class="workstream-content">
            <!-- Agentic Workflow Overview -->
            <div class="visualization-container">
                <div class="viz-title">ü§ñ Causal Analysis Agentic Workflow Architecture</div>
                
                <div style="padding: 20px; background: linear-gradient(135deg, #f6f9fc 0%, #e9f3ff 100%); border-radius: 15px; margin-bottom: 30px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">System Overview</h3>
                    <p style="color: #4a5568; line-height: 1.8; font-size: 1.1em;">
                        The E2I Causal Analytics Intelligence System employs a multi-agent architecture that transforms static dashboard metrics into dynamic, actionable intelligence. Eight specialized agents work in concert, each applying causal inference techniques to identify opportunities, predict issues, and optimize pharmaceutical engagement strategies across the entire value chain.
                    </p>
                </div>
                
                <!-- Agent Architecture Diagram -->
                <div id="agentArchitectureDiagram" style="height: 400px; background: #f7fafc; border-radius: 15px; padding: 20px; margin-bottom: 30px;"></div>
            </div>
            
            <!-- Core Agents Section -->
            <div class="visualization-container">
                <div class="viz-title">üéØ Core Agent Capabilities</div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px;">
                    <!-- Causal Impact Propagation Agent -->
                    <div style="background: linear-gradient(135deg, #fff 0%, #f6f9fc 100%); border: 2px solid #667eea; padding: 20px; border-radius: 12px;">
                        <h4 style="color: #667eea; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            <span style="background: #667eea; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">1</span>
                            Causal Impact Propagation Agent
                        </h4>
                        <p style="color: #718096; margin-bottom: 15px;"><strong>Purpose:</strong> Traces causal chains to quantify end-to-end impact</p>
                        
                        <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <strong style="color: #2d3748;">Key Algorithms:</strong>
                            <ul style="margin: 10px 0 0 20px; color: #4a5568; line-height: 1.6;">
                                <li>Structural Causal Models (SCM)</li>
                                <li>Path Analysis & Mediation</li>
                                <li>G-computation for sequential effects</li>
                                <li>Pearl's do-calculus</li>
                            </ul>
                        </div>
                        
                        <div style="background: #fff5f5; padding: 12px; border-radius: 8px;">
                            <strong style="color: #667eea;">Example Output:</strong>
                            <p style="color: #4a5568; font-size: 0.9em; margin-top: 8px;">
                                "Data lag reduction 12d‚Üí7d causes: Model AUC +0.04 ‚Üí Trigger Precision +6pp ‚Üí Action Rate +3.5pp ‚Üí Revenue +$4.2M/quarter"
                            </p>
                        </div>
                    </div>
                    
                    <!-- Performance Gap Analyzer Agent -->
                    <div style="background: linear-gradient(135deg, #fff 0%, #f0fff4 100%); border: 2px solid #48bb78; padding: 20px; border-radius: 12px;">
                        <h4 style="color: #48bb78; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            <span style="background: #48bb78; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">2</span>
                            Performance Gap Analyzer Agent
                        </h4>
                        <p style="color: #718096; margin-bottom: 15px;"><strong>Purpose:</strong> Identifies and prioritizes improvement opportunities</p>
                        
                        <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <strong style="color: #2d3748;">Analysis Framework:</strong>
                            <ul style="margin: 10px 0 0 20px; color: #4a5568; line-height: 1.6;">
                                <li>Current vs Target gap analysis</li>
                                <li>Causal impact quantification</li>
                                <li>Effort-ROI matrix construction</li>
                                <li>Pareto optimization</li>
                            </ul>
                        </div>
                        
                        <div style="background: #f0fff4; padding: 12px; border-radius: 8px;">
                            <strong style="color: #48bb78;">Example Output:</strong>
                            <p style="color: #4a5568; font-size: 0.9em; margin-top: 8px;">
                                "Top opportunity: Acceptance Rate 58%‚Üí75% yields 8.2x ROI, implementation effort: 2 weeks, expected value: $10.5M annually"
                            </p>
                        </div>
                    </div>
                    
                    <!-- Drift & Degradation Monitor Agent -->
                    <div style="background: linear-gradient(135deg, #fff 0%, #fffdf7 100%); border: 2px solid #f6ad55; padding: 20px; border-radius: 12px;">
                        <h4 style="color: #f6ad55; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            <span style="background: #f6ad55; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">3</span>
                            Drift & Degradation Monitor Agent
                        </h4>
                        <p style="color: #718096; margin-bottom: 15px;"><strong>Purpose:</strong> Predictive monitoring with causal attribution</p>
                        
                        <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <strong style="color: #2d3748;">Detection Methods:</strong>
                            <ul style="margin: 10px 0 0 20px; color: #4a5568; line-height: 1.6;">
                                <li>Population Stability Index (PSI)</li>
                                <li>Concept drift detection</li>
                                <li>Causal invariance testing</li>
                                <li>Time-series forecasting</li>
                            </ul>
                        </div>
                        
                        <div style="background: #fffdf7; padding: 12px; border-radius: 8px;">
                            <strong style="color: #f6ad55;">Example Output:</strong>
                            <p style="color: #4a5568; font-size: 0.9em; margin-top: 8px;">
                                "PSI will exceed threshold in 9 days (92% confidence). Root cause: seasonal pattern (60%) + data format change (40%)"
                            </p>
                        </div>
                    </div>
                    
                    <!-- Heterogeneous Effect Optimizer Agent -->
                    <div style="background: linear-gradient(135deg, #fff 0%, #f6f9fc 100%); border: 2px solid #9F7AEA; padding: 20px; border-radius: 12px;">
                        <h4 style="color: #9F7AEA; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                            <span style="background: #9F7AEA; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center;">4</span>
                            Heterogeneous Effect Optimizer Agent
                        </h4>
                        <p style="color: #718096; margin-bottom: 15px;"><strong>Purpose:</strong> Personalizes interventions by segment</p>
                        
                        <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <strong style="color: #2d3748;">ML Techniques:</strong>
                            <ul style="margin: 10px 0 0 20px; color: #4a5568; line-height: 1.6;">
                                <li>Causal Forests (GRF)</li>
                                <li>Meta-learners (S, T, X)</li>
                                <li>Double ML (DML)</li>
                                <li>CATE estimation</li>
                            </ul>
                        </div>
                        
                        <div style="background: #f6f9fc; padding: 12px; border-radius: 8px;">
                            <strong style="color: #9F7AEA;">Example Output:</strong>
                            <p style="color: #4a5568; font-size: 0.9em; margin-top: 8px;">
                                "Specialists: +22pp uplift (high variance), PCPs: +7pp (consistent), High Volume: +28pp (best ROI segment)"
                            </p>
                        </div>
                    </div>
   
    <script>
        // Global chart configuration
        Chart.defaults.font.family = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif';
        
        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all content
            const contents = document.querySelectorAll('.workstream-content');
            contents.forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active from all buttons
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected content
            document.getElementById(tabName).classList.add('active');
            
            // Mark button as active
            event.target.classList.add('active');
            
            // Initialize charts for the active tab
            setTimeout(() => {
                if (tabName === 'agent-insights') initAgentCharts();
                if (tabName === 'overview') initOverviewCharts();
                if (tabName === 'ws1-data') initDataQualityCharts();
                if (tabName === 'ws1-ml') initModelCharts();
                if (tabName === 'ws2') initTriggerCharts();
                if (tabName === 'ws3') initImpactCharts();
                if (tabName === 'causal') initCausalCharts();
                if (tabName === 'kpi-dictionary') console.log('KPI Dictionary loaded');
                if (tabName === 'legend') console.log('Legend tab loaded');
                if (tabName === 'methodology') initMethodologyCharts();
                if (tabName === 'methodology') console.log('Methodology loaded');
            }, 100);
        }
       
        // Initialize Overview Charts with fixed overlapping lines
        function initOverviewCharts() {
            const ctx = document.getElementById('overviewChart');
            if (!ctx) return;
            
            // Destroy existing chart if it exists
            const existingChart = Chart.getChart(ctx);
            if (existingChart) {
                existingChart.destroy();
            }
            
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                    datasets: [{
                        label: 'Data Quality ‚Üí Model Performance',
                        data: [0.75, 0.78, 0.81, 0.82],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        borderWidth: 3
                    }, {
                        label: 'Model ‚Üí Trigger Precision',
                        data: [35, 38, 40, 42],
                        borderColor: '#764ba2',
                        backgroundColor: 'rgba(118, 75, 162, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y1',
                        borderWidth: 3
                    }, {
                        label: 'Triggers ‚Üí Business Impact',
                        data: [18, 22, 26, 31],  // Changed values to separate from the purple line
                        borderColor: '#f093fb',
                        backgroundColor: 'rgba(240, 147, 251, 0.1)',
                        tension: 0.4,
                        yAxisID: 'y2',
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Time Period'
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Model Performance (AUC)'
                            },
                            min: 0.7,
                            max: 0.85
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Precision (%)'
                            },
                            min: 30,
                            max: 45,
                            grid: {
                                drawOnChartArea: false
                            }
                        },
                        y2: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Business Impact (pp)'
                            },
                            min: 15,
                            max: 35,
                            grid: {
                                drawOnChartArea: false
                            },
                            ticks: {
                                padding: 20
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'bottom'
                        },
                        tooltip: {
                            callbacks: {
                                afterLabel: function(context) {
                                    if (context.datasetIndex === 0) {
                                        return 'Causal Effect: +0.08 AUC per 10% data quality improvement';
                                    } else if (context.datasetIndex === 1) {
                                        return 'Causal Effect: 1.5x precision lift per 0.1 AUC';
                                    } else {
                                        return 'Causal Effect: +3pp impact per 10% precision gain';
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Initialize Data Quality Charts
        function initDataQualityCharts() {
            // Patient Coverage Chart
            const patientCtx = document.getElementById('patientCoverageChart');
            if (patientCtx) {
                new Chart(patientCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Covered', 'Gap'],
                        datasets: [{
                            data: [82, 18],
                            backgroundColor: ['#667eea', '#e2e8f0']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }
            
            // Geographic Chart
            const geoCtx = document.getElementById('geographicChart');
            if (geoCtx) {
                new Chart(geoCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Northeast', 'South', 'Midwest', 'West'],
                        datasets: [{
                            label: 'Coverage %',
                            data: [88, 70, 85, 82],
                            backgroundColor: ['#667eea', '#fc8181', '#667eea', '#667eea']
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { 
                                beginAtZero: true, 
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'Coverage (%)'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Region'
                                }
                            }
                        },
                        plugins: {
                            legend: { display: false }
                        }
                    }
                });
            }
            
            // Data Quality Heatmap
            const heatmapData = {
                z: [
                    [98.5, 97.2, 88.0, 82.0],
                    [99.1, 98.5, 85.5, 87.0],
                    [97.8, 96.3, 78.0, 85.0],
                    [99.5, 99.0, 92.0, 88.0]
                ],
                x: ['Completeness', 'Validity', 'Match Rate', 'Coverage'],
                y: ['IQVIA', 'HealthVerity', 'Veeva', 'Komodo'],
                type: 'heatmap',
                colorscale: [
                    [0, '#fc8181'],
                    [0.7, '#feebc8'],
                    [0.85, '#c6f6d5'],
                    [1, '#667eea']
                ],
                text: [
                    ['98.5%', '97.2%', '88.0%', '82.0%'],
                    ['99.1%', '98.5%', '85.5%', '87.0%'],
                    ['97.8%', '96.3%', '78.0%', '85.0%'],
                    ['99.5%', '99.0%', '92.0%', '88.0%']
                ],
                texttemplate: '%{text}',
                textfont: { size: 12 }
            };
            
            const layout = {
                title: '',
                height: 300,
                margin: { t: 30, b: 40 }
            };
            
            Plotly.newPlot('dataQualityHeatmap', [heatmapData], layout);
        }
        
        // Initialize Model Charts
        function initModelCharts() {
            // ROC Chart
            const rocCtx = document.getElementById('rocChart');
            if (rocCtx) {
                new Chart(rocCtx, {
                    type: 'line',
                    data: {
                        labels: ['0.0', '0.2', '0.4', '0.6', '0.8', '1.0'],
                        datasets: [{
                            label: 'ROC Curve',
                            data: [0, 0.45, 0.72, 0.88, 0.95, 1.0],
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            fill: 'start'
                        }, {
                            label: 'Random',
                            data: [0, 0.2, 0.4, 0.6, 0.8, 1.0],
                            borderColor: '#cbd5e0',
                            borderDash: [5, 5]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: { title: { display: true, text: 'False Positive Rate' }},
                            y: { title: { display: true, text: 'True Positive Rate' }}
                        },
                        plugins: {
                            legend: { position: 'bottom' }
                        }
                    }
                });
            }
            
            // Drift Chart
            const driftCtx = document.getElementById('driftChart');
            if (driftCtx) {
                new Chart(driftCtx, {
                    type: 'line',
                    data: {
                        labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                        datasets: [{
                            label: 'Feature Drift (PSI)',
                            data: [0.08, 0.12, 0.15, 0.18],
                            borderColor: '#f6ad55',
                            backgroundColor: 'rgba(246, 173, 85, 0.1)',
                            tension: 0.4
                        }, {
                            label: 'Threshold',
                            data: [0.25, 0.25, 0.25, 0.25],
                            borderColor: '#fc8181',
                            borderDash: [5, 5]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: { 
                                title: { display: true, text: 'PSI Value' }
                            },
                            x: {
                                title: { display: true, text: 'Week' }
                            }
                        },
                        plugins: {
                            legend: { display: true }
                        }
                    }
                });
            }
            
            // Model Performance Over Time
            const perfData = {
                x: ['2025-09-01', '2025-09-08', '2025-09-15', '2025-09-22', '2025-09-28'],
                y: [0.80, 0.81, 0.82, 0.81, 0.82],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'AUC',
                line: { color: '#667eea', width: 3 },
                marker: { size: 8 }
            };
            
            const praucData = {
                x: ['2025-09-01', '2025-09-08', '2025-09-15', '2025-09-22', '2025-09-28'],
                y: [0.12, 0.13, 0.14, 0.13, 0.14],
                type: 'scatter',
                mode: 'lines+markers',
                name: 'PR-AUC',
                yaxis: 'y2',
                line: { color: '#764ba2', width: 3 },
                marker: { size: 8 }
            };
            
            const annotations = [
                {
                    x: '2025-09-15',
                    y: 0.82,
                    text: 'Retraining Event',
                    showarrow: true,
                    arrowhead: 2,
                    ax: 0,
                    ay: -40
                }
            ];
            
            const layout = {
                title: '',
                height: 350,
                xaxis: { title: 'Date' },
                yaxis: { title: 'ROC-AUC', side: 'left' },
                yaxis2: {
                    title: 'PR-AUC',
                    overlaying: 'y',
                    side: 'right'
                },
                annotations: annotations,
                hovermode: 'x unified'
            };
            
            Plotly.newPlot('modelPerformanceChart', [perfData, praucData], layout);
        }
        
        // Initialize Trigger Charts
        function initTriggerCharts() {
            // Trigger Flow Sankey
            const data = [{
                type: "sankey",
                orientation: "h",
                node: {
                    pad: 15,
                    thickness: 30,
                    line: {
                        color: "black",
                        width: 0.5
                    },
                    label: ["Triggers Fired", "Accepted", "Rejected", "Action Taken", "No Action", "Positive Outcome", "No Impact"],
                    color: ["#667eea", "#48bb78", "#fc8181", "#48bb78", "#f6ad55", "#48bb78", "#cbd5e0"]
                },
                link: {
                    source: [0, 0, 1, 1, 3],
                    target: [1, 2, 3, 4, 5],
                    value: [58, 42, 42, 16, 25],
                    color: ["rgba(102, 126, 234, 0.3)", "rgba(252, 129, 129, 0.3)", 
                            "rgba(72, 187, 120, 0.3)", "rgba(246, 173, 85, 0.3)", 
                            "rgba(72, 187, 120, 0.3)"]
                }
            }];
            
            const layout = {
                title: "Trigger Conversion Funnel",
                font: { size: 12 },
                height: 400
            };
            
            Plotly.newPlot('triggerFlowChart', data, layout);
        }
        
        // Initialize Impact Charts
        function initImpactCharts() {
            // Impact Sankey showing causal pathways
            const data = [{
                type: "sankey",
                orientation: "h",
                node: {
                    pad: 15,
                    thickness: 30,
                    line: {
                        color: "black",
                        width: 0.5
                    },
                    label: [
                        "Data Quality",
                        "Model Performance", 
                        "Trigger Quality",
                        "User Adoption",
                        "HCP Engagement",
                        "Patient Identification",
                        "Business Impact"
                    ],
                    color: ["#667eea", "#764ba2", "#f093fb", "#4ecdc4", "#48bb78", "#f6ad55", "#fc8181"]
                },
                link: {
                    source: [0, 0, 1, 1, 2, 2, 3, 4, 5],
                    target: [1, 3, 2, 4, 4, 5, 4, 6, 6],
                    value: [30, 10, 25, 15, 20, 15, 25, 35, 25],
                    color: "rgba(102, 126, 234, 0.2)"
                }
            }];
            
            const layout = {
                title: "Causal Impact Pathways",
                font: { size: 12 },
                height: 400
            };
            
            Plotly.newPlot('impactSankeyChart', data, layout);
        }
        
        // Initialize Causal Analysis Charts
        function initCausalCharts() {
            // Causal DAG visualization
            const dagSvg = d3.select('#causalDAG')
                .append('svg')
                .attr('width', '100%')
                .attr('height', '100%')
                .attr('viewBox', '0 0 800 400');
            
            // Define nodes for the DAG
            const nodes = [
                {id: 'data', x: 100, y: 200, label: 'Data Quality'},
                {id: 'model', x: 300, y: 100, label: 'Model Performance'},
                {id: 'drift', x: 300, y: 300, label: 'Feature Drift'},
                {id: 'triggers', x: 500, y: 200, label: 'Trigger Precision'},
                {id: 'impact', x: 700, y: 200, label: 'Business Impact'}
            ];
            
            // Define edges
            const edges = [
                {source: 'data', target: 'model', effect: '+0.08 AUC'},
                {source: 'data', target: 'drift', effect: '-0.15 PSI'},
                {source: 'model', target: 'triggers', effect: '+20pp'},
                {source: 'drift', target: 'triggers', effect: '-10pp'},
                {source: 'triggers', target: 'impact', effect: '+12pp'}
            ];
            
            // Draw edges
            const edgeGroup = dagSvg.append('g');
            edges.forEach(edge => {
                const source = nodes.find(n => n.id === edge.source);
                const target = nodes.find(n => n.id === edge.target);
                
                edgeGroup.append('line')
                    .attr('x1', source.x)
                    .attr('y1', source.y)
                    .attr('x2', target.x)
                    .attr('y2', target.y)
                    .attr('stroke', '#667eea')
                    .attr('stroke-width', 2)
                    .attr('marker-end', 'url(#arrowhead)');
                
                // Add effect label
                const midX = (source.x + target.x) / 2;
                const midY = (source.y + target.y) / 2;
                edgeGroup.append('text')
                    .attr('x', midX)
                    .attr('y', midY - 5)
                    .attr('text-anchor', 'middle')
                    .attr('fill', '#764ba2')
                    .attr('font-size', '12px')
                    .attr('font-weight', 'bold')
                    .text(edge.effect);
            });
            
            // Draw nodes
            const nodeGroup = dagSvg.append('g');
            nodes.forEach(node => {
                nodeGroup.append('circle')
                    .attr('cx', node.x)
                    .attr('cy', node.y)
                    .attr('r', 40)
                    .attr('fill', '#667eea')
                    .attr('fill-opacity', 0.8);
                
                nodeGroup.append('text')
                    .attr('x', node.x)
                    .attr('y', node.y + 5)
                    .attr('text-anchor', 'middle')
                    .attr('fill', 'white')
                    .attr('font-size', '12px')
                    .attr('font-weight', 'bold')
                    .text(node.label);
            });
            
            // Define arrow marker
            dagSvg.append('defs').append('marker')
                .attr('id', 'arrowhead')
                .attr('viewBox', '-0 -5 10 10')
                .attr('refX', 50)
                .attr('refY', 0)
                .attr('orient', 'auto')
                .attr('markerWidth', 8)
                .attr('markerHeight', 8)
                .append('svg:path')
                .attr('d', 'M 0,-5 L 10,0 L 0,5')
                .attr('fill', '#667eea');
            
            // Heterogeneous Effects Chart
            const heteroData = {
                type: 'box',
                y: [12, 15, 18, 8, 22, 14, 25, 10, 28, 16],
                name: 'Specialists',
                marker: { color: '#667eea' }
            };
            
            const heteroData2 = {
                type: 'box',
                y: [5, 8, 6, 4, 9, 7, 12, 3, 10, 6],
                name: 'PCPs',
                marker: { color: '#764ba2' }
            };
            
            const heteroData3 = {
                type: 'box',
                y: [18, 22, 25, 15, 28, 20, 32, 18, 35, 24],
                name: 'High Volume',
                marker: { color: '#f093fb' }
            };
            
            const heteroLayout = {
                title: 'Treatment Effect Distribution by HCP Segment',
                yaxis: { title: 'Action Rate Uplift (pp)' },
                height: 350,
                showlegend: true
            };
            
            Plotly.newPlot('heterogeneousEffects', [heteroData, heteroData2, heteroData3], heteroLayout);
            
            // Fixed Causal Attribution Waterfall with visible values
            const waterfallData = [{
                name: 'Causal Attribution',
                type: 'waterfall',
                orientation: 'v',
                measure: ['relative', 'relative', 'relative', 'relative', 'relative', 'total'],
                x: ['Baseline', 'Data Quality', 'Model Improvement', 'Trigger Optimization', 'User Training', 'Total Impact'],
                textposition: 'outside',
                text: ['+5%', '+8%', '+6%', '+4%', '+3%', '+26%'],
                y: [5, 8, 6, 4, 3, 26],
                textfont: {
                    size: 12,
                    color: '#2d3748',
                    family: 'Arial'
                },
                connector: {
                    line: { color: 'rgb(63, 63, 63)' }
                },
                increasing: { marker: { color: '#48bb78' }},
                decreasing: { marker: { color: '#fc8181' }},
                totals: { marker: { color: '#667eea' }}
            }];
            
            const waterfallLayout = {
                title: 'Causal Attribution of Business Impact',
                height: 400,
                yaxis: { 
                    title: 'Cumulative Impact (%)',
                    range: [0, 30]
                },
                xaxis: {
                    tickangle: -45
                },
                showlegend: false,
                margin: {
                    t: 60,
                    b: 100
                }
            };
            
            Plotly.newPlot('causalAttribution', waterfallData, waterfallLayout);
        }
        
        // Initialize remaining small charts with visible axes
        function initSmallCharts() {
            // Chart IDs that need initialization
            const canvasIds = [
                'dataLagChart', 'matchRateChart', 'completenessChart', 'stackingLiftChart',
                'iaaChart', 'recallTopKChart', 'shapChart', 'fairnessChart',
                'precisionChart', 'leadTimeChart', 'acceptanceChart', 'upliftChart',
                'falseAlertChart', 'ttrChart', 'mauChart', 'hcpCoverageChart',
                'patientTouchChart', 'remiChart', 'remiItpChart', 'fabhaltaTestChart', 
                'kisqaliReachChart', 'kisqaliChart'
            ];
            
            canvasIds.forEach(id => {
                const ctx = document.getElementById(id);
                if (ctx && !Chart.getChart(ctx)) {
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: ['W1', 'W2', 'W3', 'W4'],
                            datasets: [{
                                data: [
                                    Math.random() * 20 + 70,
                                    Math.random() * 20 + 75,
                                    Math.random() * 20 + 80,
                                    Math.random() * 20 + 85
                                ],
                                borderColor: '#667eea',
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false }
                            },
                            scales: {
                                y: { 
                                    display: true,
                                    grid: {
                                        display: true,
                                        color: 'rgba(0,0,0,0.05)'
                                    },
                                    title: {
                                        display: true,
                                        text: 'Value',
                                        font: {
                                            size: 10
                                        }
                                    },
                                    ticks: {
                                        font: {
                                            size: 10
                                        }
                                    }
                                },
                                x: { 
                                    display: true,
                                    grid: {
                                        display: false
                                    },
                                    title: {
                                        display: true,
                                        text: 'Week',
                                        font: {
                                            size: 10
                                        }
                                    },
                                    ticks: {
                                        font: {
                                            size: 10
                                        }
                                    }
                                }
                            }
                        }
                    });
                }
            });
        }

        // Initialize Agent Insights Charts
        function initAgentCharts() {
            // Heterogeneous Effects Heatmap
            const heteroData = {
                z: [
                    [22, 18, 25, 15, 28],
                    [7, 6, 8, 5, 9],
                    [28, 24, 32, 20, 35],
                    [3, 2, 4, 1, 5]
                ],
                x: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Current'],
                y: ['Specialists', 'PCPs', 'High Volume', 'Rural'],
                type: 'heatmap',
                colorscale: [
                    [0, '#fc8181'],
                    [0.2, '#feebc8'],
                    [0.5, '#c6f6d5'],
                    [1, '#667eea']
                ],
                text: [
                    ['22pp', '18pp', '25pp', '15pp', '28pp'],
                    ['7pp', '6pp', '8pp', '5pp', '9pp'],
                    ['28pp', '24pp', '32pp', '20pp', '35pp'],
                    ['3pp', '2pp', '4pp', '1pp', '5pp']
                ],
                texttemplate: '%{text}',
                textfont: { size: 12, color: 'white' }
            };
            
            const heteroLayout = {
                title: 'Treatment Effect by Segment Over Time',
                height: 300,
                xaxis: { title: 'Time Period' },
                yaxis: { title: 'HCP Segment' }
            };
            
            Plotly.newPlot('heterogeneousHeatmap', [heteroData], heteroLayout);
            
            // Resource Allocation Sankey
            const sankeyData = [{
                type: "sankey",
                orientation: "h",
                node: {
                    pad: 15,
                    thickness: 30,
                    line: {
                        color: "black",
                        width: 0.5
                    },
                    label: [
                        "Current Budget",
                        "Data Sources", 
                        "Model Development",
                        "UI/UX",
                        "Field Operations",
                        "Optimal Budget",
                        "Enhanced UI",
                        "Data Quality",
                        "Field Focus",
                        "Model Maintain"
                    ],
                    color: ["#667eea", "#fc8181", "#f6ad55", "#fc8181", "#48bb78", 
                            "#667eea", "#48bb78", "#48bb78", "#48bb78", "#f6ad55"]
                },
                link: {
                    source: [0, 0, 0, 0, 5, 5, 5, 5],
                    target: [1, 2, 3, 4, 6, 7, 8, 9],
                    value: [25, 30, 10, 35, 35, 20, 35, 10],
                    color: "rgba(102, 126, 234, 0.2)"
                }
            }];
            
            const sankeyLayout = {
                title: "Budget Reallocation for Optimal ROI",
                font: { size: 12 },
                height: 350
            };
            
            Plotly.newPlot('resourceAllocationSankey', sankeyData, sankeyLayout);
            
            // Health Radar Chart
            const radarData = {
                type: 'scatterpolar',
                r: [88, 82, 78, 86, 85, 72, 90, 84],
                theta: [
                    'Data Coverage', 
                    'Model AUC', 
                    'Trigger Accept', 
                    'Business Impact',
                    'Data Freshness',
                    'Fairness',
                    'System Uptime',
                    'User Adoption'
                ],
                fill: 'toself',
                fillcolor: 'rgba(102, 126, 234, 0.2)',
                line: { color: '#667eea' },
                name: 'Current'
            };
            
            const targetData = {
                type: 'scatterpolar',
                r: [95, 85, 90, 90, 90, 85, 95, 90],
                theta: [
                    'Data Coverage', 
                    'Model AUC', 
                    'Trigger Accept', 
                    'Business Impact',
                    'Data Freshness',
                    'Fairness',
                    'System Uptime',
                    'User Adoption'
                ],
                fill: 'toself',
                fillcolor: 'rgba(72, 187, 120, 0.1)',
                line: { color: '#48bb78', dash: 'dash' },
                name: 'Target'
            };
            
            const radarLayout = {
                polar: {
                    radialaxis: {
                        visible: true,
                        range: [0, 100]
                    }
                },
                height: 350,
                showlegend: true
            };
            
            Plotly.newPlot('healthRadarChart', [radarData, targetData], radarLayout);
        }
        
        // Initialize Methodology Charts  
        function initMethodologyCharts() {
            // Agent Orchestration Flow Diagram
            const agentFlowDiv = document.getElementById('agentOrchestrationFlow');
            if (!agentFlowDiv) return;
            
            // Create a Sankey diagram showing agent collaboration
            const flowData = [{
                type: "sankey",
                orientation: "h",
                node: {
                    pad: 15,
                    thickness: 30,
                    line: {
                        color: "black",
                        width: 0.5
                    },
                    label: [
                        "Dashboard Metrics",
                        "Data Validation",
                        "Causal Graph",
                        "Impact Agent",
                        "Gap Agent", 
                        "Drift Agent",
                        "Heterogeneous Agent",
                        "Experiment Agent",
                        "Health Agent",
                        "Orchestrator",
                        "Insights",
                        "Actions"
                    ],
                    color: [
                        "#667eea", "#764ba2", "#9F7AEA",
                        "#667eea", "#48bb78", "#f6ad55", "#9F7AEA", "#4ecdc4", "#3182ce",
                        "#667eea", "#48bb78", "#fc8181"
                    ]
                },
                link: {
                    source: [0, 1, 2, 2, 2, 2, 2, 2, 3, 4, 5, 6, 7, 8, 9, 9],
                    target: [1, 2, 3, 4, 5, 6, 7, 8, 9, 9, 9, 9, 9, 9, 10, 11],
                    value: [100, 100, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 80, 20],
                    color: "rgba(102, 126, 234, 0.2)"
                }
            }];
            
            const flowLayout = {
                title: "Agent Collaboration & Data Flow",
                font: { 
                    size: 12,
                    family: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif'
                },
                height: 350,
                paper_bgcolor: 'transparent',
                plot_bgcolor: 'transparent'
            };
            
            Plotly.newPlot('agentOrchestrationFlow', flowData, flowLayout);
        }
                     
        // Refresh dashboard function
        function refreshDashboard() {
            // Simulate refresh
            const alertBanner = document.getElementById('alertBanner');
            alertBanner.classList.add('show');
            setTimeout(() => {
                alertBanner.classList.remove('show');
            }, 5000);
            
            // Re-initialize current tab charts
            const activeTab = document.querySelector('.workstream-content.active').id;
            if (activeTab === 'agent-insights') initAgentCharts();
            if (activeTab === 'overview') initOverviewCharts();
            if (activeTab === 'ws1-data') initDataQualityCharts();
            if (activeTab === 'ws1-ml') initModelCharts();
            if (activeTab === 'ws2') initTriggerCharts();
            if (activeTab === 'ws3') initImpactCharts();
            if (activeTab === 'causal') initCausalCharts();
            if (activeTab === 'methodology') initMethodologyCharts();
        }
        
        // Call initSmallCharts when tabs are switched
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                setTimeout(initSmallCharts, 100);
            });
        });
        
        // Initialize on page load
        window.addEventListener('DOMContentLoaded', () => {
            initOverviewCharts();
            setTimeout(initSmallCharts, 200);
        });
    </script>
</body>
</html>